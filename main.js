/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __esm = (fn, res) => function __init() {
  return fn && (res = (0, fn[__getOwnPropNames(fn)[0]])(fn = 0)), res;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/constants/styles.ts
var MODAL_STYLES, INPUT_STYLES;
var init_styles = __esm({
  "src/constants/styles.ts"() {
    MODAL_STYLES = {
      zIndex: "10000",
      display: "flex",
      header: {
        marginBottom: "15px",
        color: "var(--text-accent)"
      },
      message: {
        marginBottom: "20px",
        lineHeight: "1.5"
      },
      buttonContainer: {
        marginTop: "20px",
        display: "flex",
        gap: "10px",
        justifyContent: "flex-end"
      },
      button: {
        padding: "8px 16px",
        minWidth: "100px"
      }
    };
    INPUT_STYLES = {
      width: "100%",
      marginTop: "8px",
      padding: "8px",
      border: "1px solid var(--background-modifier-border)",
      borderRadius: "4px"
    };
  }
});

// src/utils/dom.ts
var DOMUtils;
var init_dom = __esm({
  "src/utils/dom.ts"() {
    init_styles();
    DOMUtils = class {
      /**
       * Apply styles to an HTML element
       */
      static applyStyles(element, styles) {
        Object.assign(element.style, styles);
      }
      /**
       * Create a standardized button container
       */
      static createButtonContainer(parent) {
        const container = parent.createDiv();
        this.applyStyles(container, MODAL_STYLES.buttonContainer);
        return container;
      }
      /**
       * Create a styled button with consistent appearance
       */
      static createStyledButton(container, text, isPrimary = false, onClick) {
        const button = container.createEl("button", { text });
        if (isPrimary) {
          button.classList.add("mod-cta");
        }
        this.applyStyles(button, MODAL_STYLES.button);
        if (onClick) {
          button.addEventListener("click", onClick);
        }
        return button;
      }
      /**
       * Create a styled input field
       */
      static createStyledInput(container, type, placeholder, value = "") {
        const input = container.createEl("input", {
          type,
          placeholder,
          value
        });
        this.applyStyles(input, INPUT_STYLES);
        return input;
      }
      /**
       * Set up modal base styling for consistency
       */
      static setupModalStyling(modalEl) {
        this.applyStyles(modalEl, {
          zIndex: MODAL_STYLES.zIndex,
          display: MODAL_STYLES.display
        });
      }
      /**
       * Create a header element with consistent styling
       */
      static createModalHeader(parent, text) {
        const header = parent.createEl("h2", { text });
        this.applyStyles(header, MODAL_STYLES.header);
        return header;
      }
      /**
       * Create a message paragraph with consistent styling
       */
      static createModalMessage(parent, text) {
        const message = parent.createEl("p");
        message.setText(text);
        this.applyStyles(message, MODAL_STYLES.message);
        return message;
      }
      /**
       * Set up keyboard event handlers for modals
       */
      static setupModalKeyHandlers(element, onEnter, onEscape) {
        element.addEventListener("keydown", (e) => {
          if (e.key === "Enter") {
            e.preventDefault();
            e.stopPropagation();
            onEnter();
          }
          if (e.key === "Escape" && onEscape) {
            e.preventDefault();
            e.stopPropagation();
            onEscape();
          }
        });
      }
      // Instance methods implementing interface
      applyStyles(element, styles) {
        DOMUtils.applyStyles(element, styles);
      }
      createButtonContainer(parent) {
        return DOMUtils.createButtonContainer(parent);
      }
      createStyledButton(container, text, isPrimary = false, onClick) {
        return DOMUtils.createStyledButton(container, text, isPrimary, onClick);
      }
    };
  }
});

// src/constants/api.ts
var API_ENDPOINTS, AI_MODELS, PROVIDER_MODEL_OPTIONS, PROVIDER_MODEL_LIST_URLS, PROVIDER_MODEL_REGEX, API_LIMITS, TIMEOUTS;
var init_api = __esm({
  "src/constants/api.ts"() {
    API_ENDPOINTS = {
      GEMINI: "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent",
      GROQ: "https://api.groq.com/openai/v1/chat/completions",
      YOUTUBE_OEMBED: "https://www.youtube.com/oembed",
      CORS_PROXY: "https://api.allorigins.win/raw"
    };
    AI_MODELS = {
      GEMINI: "gemini-2.5-pro",
      // Set Gemini model to gemini-2.5-pro
      GROQ: "llama-3.3-70b-versatile"
    };
    PROVIDER_MODEL_OPTIONS = {
      "Google Gemini": [
        // Gemini 2.5 series (latest, all support multimodal video analysis)
        { name: "gemini-2.5-pro", supportsAudioVideo: true },
        { name: "gemini-2.5-pro-tts", supportsAudioVideo: true },
        { name: "gemini-2.5-flash", supportsAudioVideo: true },
        { name: "gemini-2.5-flash-lite", supportsAudioVideo: true },
        // Gemini 2.0 series (video support via native API, but no explicit multimodal flag)
        { name: "gemini-2.0-pro", supportsAudioVideo: true },
        { name: "gemini-2.0-flash" },
        { name: "gemini-2.0-flash-lite" },
        // Gemini 1.5 series (available, supports video via File API)
        { name: "gemini-1.5-pro" },
        { name: "gemini-1.5-flash" }
      ],
      "Groq": [
        // Latest models (Nov 2024 - Nov 2025)
        // Note: Groq models prioritize speed/text; for multimodal video, Gemini is recommended
        { name: "llama-4-maverick-17b-128e-instruct" },
        { name: "llama-4-scout-17b-16e-instruct" },
        // Llama 3.x series
        { name: "llama-3.3-70b-versatile" },
        { name: "llama-3.1-8b-instant" }
      ]
    };
    PROVIDER_MODEL_LIST_URLS = {
      "Google Gemini": "https://developers.generativeai.google/models",
      "Groq": "https://groq.com"
    };
    PROVIDER_MODEL_REGEX = {
      "Google Gemini": /gemini[-_\.]?\d+(?:\.\d+)?(?:-[a-z0-9\-]+)?/gi,
      "Groq": /llama[-_\.]?\d+(?:\.\d+)?(?:-[a-z0-9\-]+)?/gi
    };
    API_LIMITS = {
      MAX_TOKENS: 2e3,
      TEMPERATURE: 0.7,
      DESCRIPTION_MAX_LENGTH: 1e3,
      TITLE_MAX_LENGTH: 100
    };
    TIMEOUTS = {
      FILE_CREATION_WAIT: 300,
      MODAL_DELAY: 100,
      FALLBACK_MODAL_CHECK: 500,
      FOCUS_DELAY: 150,
      REPAINT_DELAY: 50
    };
  }
});

// src/components/modals/confirmation-modal.ts
var confirmation_modal_exports = {};
__export(confirmation_modal_exports, {
  ConfirmationModal: () => ConfirmationModal
});
var ConfirmationModal;
var init_confirmation_modal = __esm({
  "src/components/modals/confirmation-modal.ts"() {
    init_base_modal();
    ConfirmationModal = class extends BaseModal {
      constructor(app, options) {
        super(app);
        this.options = options;
        this.result = false;
      }
      onOpen() {
        this.createModalContent();
        this.setupEventHandlers();
        this.focusConfirmButton();
      }
      /**
       * Create modal content with accessible structure
       */
      createModalContent() {
        const header = this.createHeader(this.options.title);
        header.setAttribute("id", "confirmation-modal-title");
        const messageContainer = this.contentEl.createDiv("confirmation-message");
        messageContainer.setAttribute("id", "confirmation-modal-description");
        messageContainer.textContent = this.options.message;
        const buttonContainer = this.createButtonContainer();
        buttonContainer.style.marginTop = "20px";
        const confirmText = this.options.confirmText || "Confirm";
        const cancelText = this.options.cancelText || "Cancel";
        const isDangerous = this.options.isDangerous || false;
        if (isDangerous) {
          this.cancelButton = this.createButton(
            buttonContainer,
            cancelText,
            false,
            () => this.handleCancel()
          );
          this.cancelButton.setAttribute("aria-label", `Cancel: ${cancelText}`);
          this.confirmButton = this.createButton(
            buttonContainer,
            confirmText,
            true,
            () => this.handleConfirm()
          );
          this.confirmButton.setAttribute("aria-label", `Confirm: ${confirmText}`);
        } else {
          this.confirmButton = this.createButton(
            buttonContainer,
            confirmText,
            true,
            () => this.handleConfirm()
          );
          this.confirmButton.setAttribute("aria-label", `Confirm: ${confirmText}`);
          this.cancelButton = this.createButton(
            buttonContainer,
            cancelText,
            false,
            () => this.handleCancel()
          );
          this.cancelButton.setAttribute("aria-label", `Cancel: ${cancelText}`);
        }
        this.contentEl.setAttribute("aria-labelledby", "confirmation-modal-title");
        this.contentEl.setAttribute("aria-describedby", "confirmation-modal-description");
        this.contentEl.setAttribute("role", "alertdialog");
      }
      /**
       * Set up keyboard event handlers (Enter to confirm, Escape to cancel)
       */
      setupEventHandlers() {
        this.scope.register([], "Enter", () => {
          this.handleConfirm();
          return false;
        });
        this.scope.register([], "Escape", () => {
          this.handleCancel();
          return false;
        });
      }
      /**
       * Focus the confirm button by default
       */
      focusConfirmButton() {
        if (this.confirmButton) {
          setTimeout(() => {
            this.confirmButton.focus();
          }, 50);
        }
      }
      /**
       * Handle confirmation (Confirm button or Enter key)
       */
      handleConfirm() {
        this.result = true;
        if (this.resolver) {
          this.resolver(true);
        }
        this.close();
      }
      /**
       * Handle cancellation (Cancel button or Escape key)
       */
      handleCancel() {
        this.result = false;
        if (this.resolver) {
          this.resolver(false);
        }
        this.close();
      }
      /**
       * Open modal and wait for user response
       * Returns promise that resolves to true if confirmed, false if cancelled
       */
      openAndWait() {
        return new Promise((resolve) => {
          this.resolver = resolve;
          this.open();
        });
      }
      /**
       * Get the result (synchronous if already closed)
       */
      getResult() {
        return this.result;
      }
    };
  }
});

// src/components/modals/base-modal.ts
var import_obsidian3, MODAL_CSS_CLASSES, BaseModal;
var init_base_modal = __esm({
  "src/components/modals/base-modal.ts"() {
    import_obsidian3 = require("obsidian");
    init_dom();
    init_styles();
    init_api();
    MODAL_CSS_CLASSES = {
      modal: "ytc-modal",
      header: "ytc-modal-header",
      content: "ytc-modal-content",
      button: "ytc-modal-button",
      input: "ytc-modal-input"
    };
    BaseModal = class extends import_obsidian3.Modal {
      constructor(app) {
        super(app);
        this.events = {};
        this.isDisposed = false;
        this.setupModalStyling();
        this.setupConflictPrevention();
      }
      /**
       * Set up base modal styling for consistency
       */
      setupModalStyling() {
        DOMUtils.setupModalStyling(this.modalEl);
        this.modalEl.addClass(MODAL_CSS_CLASSES.modal);
        this.contentEl.addClass(MODAL_CSS_CLASSES.content);
      }
      /**
       * Set up conflict prevention measures
       */
      setupConflictPrevention() {
        this.modalEl.setAttribute("data-plugin", "youtube-clipper");
        this.modalEl.style.zIndex = "9999";
      }
      /**
       * Create standardized modal header with conflict prevention
       */
      createHeader(text) {
        const header = DOMUtils.createModalHeader(this.contentEl, text);
        header.addClass(MODAL_CSS_CLASSES.header);
        return header;
      }
      /**
       * Create standardized modal message
       */
      createMessage(text) {
        return DOMUtils.createModalMessage(this.contentEl, text);
      }
      /**
       * Create standardized button container
       */
      createButtonContainer() {
        return DOMUtils.createButtonContainer(this.contentEl);
      }
      /**
      * Create standardized button with conflict prevention and accessibility
      */
      createButton(container, text, isPrimary = false, onClick) {
        const button = DOMUtils.createStyledButton(container, text, isPrimary, onClick);
        button.addClass(MODAL_CSS_CLASSES.button);
        button.setAttribute("data-plugin", "youtube-clipper");
        button.setAttribute("role", "button");
        if (!button.getAttribute("aria-label")) {
          button.setAttribute("aria-label", text);
        }
        return button;
      }
      /**
       * Create standardized input with conflict prevention and accessibility
       */
      createInput(container, type, placeholder) {
        const input = container.createEl("input", {
          type,
          placeholder
        });
        DOMUtils.applyStyles(input, INPUT_STYLES);
        input.addClass(MODAL_CSS_CLASSES.input);
        input.setAttribute("data-plugin", "youtube-clipper");
        if (placeholder) {
          input.setAttribute("aria-label", placeholder);
        }
        return input;
      }
      /**
       * Set up keyboard event handlers
       */
      setupKeyHandlers(onEnter, onEscape) {
        const wrappedOnEnter = async () => {
          try {
            await onEnter();
          } catch (error) {
            console.error("Enter key handler error:", error);
          }
        };
        const wrappedOnEscape = onEscape ? async () => {
          try {
            await onEscape();
          } catch (error) {
            console.error("Escape key handler error:", error);
          }
        } : void 0;
        DOMUtils.setupModalKeyHandlers(this.contentEl, wrappedOnEnter, wrappedOnEscape);
      }
      /**
       * Focus element with delay for better UX
       */
      focusElement(element, delay = TIMEOUTS.FOCUS_DELAY) {
        setTimeout(() => {
          element.focus();
        }, delay);
      }
      /**
       * Set up event handlers
       */
      setEvents(events) {
        this.events = events;
      }
      /**
       * Show custom styled confirmation dialog before closing
       * This uses our custom ConfirmationModal instead of the native browser confirm()
       * for better accessibility and UX.
       * 
       * Note: This is now synchronous for backwards compatibility with existing callers,
       * but returns a boolean immediately. For async confirmation with proper modal,
       * use showConfirmationModal() instead.
       */
      confirmClose(message) {
        return confirm(message);
      }
      /**
       * Show a custom accessible confirmation modal and wait for user response.
       * Preferred method for confirmation dialogs (async, fully accessible).
       */
      async showConfirmationModal(title, message, confirmText = "Confirm", cancelText = "Cancel", isDangerous = false) {
        const { ConfirmationModal: ConfirmationModal2 } = await Promise.resolve().then(() => (init_confirmation_modal(), confirmation_modal_exports));
        const modal = new ConfirmationModal2(this.app, {
          title,
          message,
          confirmText,
          cancelText,
          isDangerous
        });
        return modal.openAndWait();
      }
      /**
       * Force modal visibility (for stubborn modals)
       */
      forceVisible() {
        setTimeout(() => {
          DOMUtils.setupModalStyling(this.modalEl);
        }, TIMEOUTS.REPAINT_DELAY);
      }
      /**
       * Clean up on close with proper disposal
       */
      onClose() {
        if (this.isDisposed) {
          return;
        }
        console.log("[youtube-clipper] Cleaning up modal");
        this.isDisposed = true;
        const { contentEl } = this;
        contentEl.empty();
        this.modalEl.removeClass(MODAL_CSS_CLASSES.modal);
        this.modalEl.removeAttribute("data-plugin");
        console.log("[youtube-clipper] Modal cleanup complete");
      }
    };
  }
});

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => YoutubeClipperPlugin
});
module.exports = __toCommonJS(main_exports);

// src/main.ts
var import_obsidian7 = require("obsidian");

// src/utils/conflict-prevention.ts
var ConflictPrevention = class {
  /**
   * Check if another plugin might be conflicting
   */
  static checkForPotentialConflicts() {
    const warnings = [];
    const suspiciousElements = [
      'div[data-plugin="web-clipper"]',
      ".web-clipper-modal",
      ".clipper-button",
      '[id*="clipper"]',
      '[class*="clip"]'
    ];
    suspiciousElements.forEach((selector) => {
      const elements = document.querySelectorAll(selector);
      if (elements.length > 0) {
        warnings.push(`Detected potential plugin conflict: ${selector}`);
      }
    });
    return warnings;
  }
  /**
   * Add conflict prevention attributes to an element
   */
  static markElement(element, type) {
    element.setAttribute("data-plugin", this.PLUGIN_ID);
    element.setAttribute("data-ytc-type", type);
    element.addClass(`${this.CSS_PREFIX}-${type}`);
  }
  /**
   * Remove conflict prevention attributes
   */
  static unmarkElement(element) {
    element.removeAttribute("data-plugin");
    element.removeAttribute("data-ytc-type");
    const classes = Array.from(element.classList);
    classes.forEach((className) => {
      if (className.startsWith(this.CSS_PREFIX)) {
        element.removeClass(className);
      }
    });
  }
  /**
   * Create a namespaced ID to prevent conflicts
   */
  static createUniqueId(base) {
    return `${this.CSS_PREFIX}-${base}-${Date.now()}`;
  }
  /**
   * Clean up all plugin elements from DOM
   */
  static cleanupAllElements() {
    const elements = document.querySelectorAll(`[data-plugin="${this.PLUGIN_ID}"]`);
    elements.forEach((element) => {
      if (element instanceof HTMLElement) {
        this.unmarkElement(element);
      }
    });
  }
  /**
   * Get safe storage key with namespace
   */
  static getStorageKey(key) {
    return `${this.PLUGIN_ID}-${key}`;
  }
  /**
   * Log plugin activity with namespace
   */
  static log(message, level = "info") {
    const timestamp = new Date().toISOString();
    const logMessage = `[${this.PLUGIN_ID}] ${timestamp} - ${message}`;
    switch (level) {
      case "warn":
        console.warn(logMessage);
        break;
      case "error":
        console.error(logMessage);
        break;
      default:
        console.log(logMessage);
    }
  }
  /**
   * Check if plugin is safe to operate
   */
  static isSafeToOperate() {
    const conflicts = this.checkForPotentialConflicts();
    if (conflicts.length > 0) {
      this.log(`Potential conflicts detected: ${conflicts.join(", ")}`, "warn");
      return false;
    }
    return true;
  }
  /**
   * Wrap async operations with conflict checking
   */
  static async safeOperation(operation, operationName) {
    if (!this.isSafeToOperate()) {
      this.log(`Skipping ${operationName} due to potential conflicts`, "warn");
      return null;
    }
    try {
      this.log(`Starting ${operationName}`);
      const result = await operation();
      this.log(`Completed ${operationName}`);
      return result;
    } catch (error) {
      this.log(`Error in ${operationName}: ${error}`, "error");
      throw error;
    }
  }
};
ConflictPrevention.PLUGIN_ID = "youtube-clipper";
ConflictPrevention.CSS_PREFIX = "ytc";

// src/constants/messages.ts
var MESSAGES = {
  PROCESSING: "Processing YouTube video...",
  SUCCESS: (title) => `Successfully processed: ${title}`,
  OPENED_FILE: (filename) => `Opened: ${filename}`,
  ERRORS: {
    INVALID_URL: "Invalid YouTube URL. Please provide a valid YouTube video URL (e.g., https://www.youtube.com/watch?v=VIDEO_ID)",
    MISSING_API_KEYS: "No valid Gemini or Groq API key configured. Please set one in plugin settings.",
    GEMINI_INVALID_KEY: "Gemini API key is invalid or missing. Please check your key.",
    GROQ_MODEL_NOT_FOUND: "Groq API error: Model not found or you do not have access. Please check your API key and model name.",
    FETCH_VIDEO_DATA: (status) => `Failed to fetch video metadata: ${status}`,
    SAVE_FILE: (message) => `Failed to save file: ${message}`,
    AI_PROCESSING: (message) => `AI processing failed: ${message}`,
    FILE_NOT_EXISTS: "File no longer exists",
    COULD_NOT_OPEN: (message) => `Could not open file: ${message}`,
    ENTER_URL: "Please enter a YouTube URL",
    VIDEO_ID_EXTRACTION: "Could not extract video ID from URL. Please check the URL format.",
    NETWORK_ERROR: "Network error occurred. Please check your internet connection and try again."
  },
  WARNINGS: {
    CORS_RESTRICTIONS: "Description not available due to CORS restrictions",
    EXTRACTION_FAILED: "Description extraction failed",
    AUTO_EXTRACTION: "Video description could not be extracted automatically."
  },
  MODALS: {
    YOUTUBE_PROCESSED: "YouTube Video Processed",
    CONFIRM_OPEN: (filename) => `Successfully processed YouTube video and saved as "${filename}". Would you like to open the note now?`,
    CLOSE_CONFIRMATION: "Close without opening the note?",
    PROCESS_VIDEO: "Process YouTube Video",
    YES_OPEN: "Yes, open note",
    NO_THANKS: "No, thanks",
    CANCEL: "Cancel",
    PROCESS: "Process"
  },
  PLACEHOLDERS: {
    YOUTUBE_URL: "https://www.youtube.com/watch?v=...",
    GEMINI_KEY: "AIza...",
    GROQ_KEY: "gsk_...",
    OUTPUT_PATH: "YouTube/Processed Videos"
  }
};

// src/utils/validation.ts
var ValidationUtils = class {
  /**
   * Clean and normalize YouTube URL
   */
  static cleanYouTubeUrl(url) {
    if (!url || typeof url !== "string") {
      return "";
    }
    let cleanUrl = url.trim();
    cleanUrl = cleanUrl.replace(/[\u200B-\u200D\uFEFF]/g, "");
    if (!cleanUrl.startsWith("http://") && !cleanUrl.startsWith("https://")) {
      cleanUrl = "https://" + cleanUrl;
    }
    if (cleanUrl.startsWith("http://youtube.com") || cleanUrl.startsWith("http://www.youtube.com")) {
      cleanUrl = cleanUrl.replace("http://", "https://");
    }
    return cleanUrl;
  }
  /**
   * Extract YouTube video ID from URL (memoized for performance)
   * Enhanced extraction with better error handling
   */
  static extractVideoId(url) {
    if (!url || typeof url !== "string")
      return null;
    if (this.URL_CACHE.has(url)) {
      return this.URL_CACHE.get(url);
    }
    const cleanUrl = this.cleanYouTubeUrl(url);
    let result = null;
    let match = cleanUrl.match(this.URL_PATTERNS[0]);
    if ((match == null ? void 0 : match[1]) && this.VIDEO_ID_REGEX.test(match[1])) {
      result = match[1];
    } else {
      for (let i = 1; i < this.URL_PATTERNS.length && !result; i++) {
        match = cleanUrl.match(this.URL_PATTERNS[i]);
        if ((match == null ? void 0 : match[1]) && this.VIDEO_ID_REGEX.test(match[1])) {
          result = match[1];
        }
      }
    }
    if (this.URL_CACHE.size > 100) {
      this.URL_CACHE.clear();
    }
    this.URL_CACHE.set(url, result);
    if (!result) {
      console.warn("Failed to extract video ID from URL:", url);
    }
    return result;
  }
  /**
   * Validate YouTube URL format
   */
  static isValidYouTubeUrl(url) {
    return this.extractVideoId(url) !== null;
  }
  /**
   * Sanitize filename for file system compatibility
   */
  static sanitizeFilename(filename, maxLength = 100) {
    return filename.replace(/[<>:"/\\|?*]/g, "").replace(/\s+/g, " ").trim().substring(0, maxLength);
  }
  /**
   * Validate API key format
   */
  static isValidAPIKey(key, provider) {
    if (!key || typeof key !== "string") {
      return false;
    }
    switch (provider) {
      case "gemini":
        return key.startsWith("AIza") && key.length > 10;
      case "groq":
        return key.startsWith("gsk_") && key.length > 10;
      default:
        return false;
    }
  }
  /**
   * Validate settings configuration
   */
  static validateSettings(settings) {
    const errors = [];
    const usingEnv = Boolean(settings.useEnvironmentVariables);
    const hasDirectKey = this.isNonEmptyString(settings.geminiApiKey) || this.isNonEmptyString(settings.groqApiKey);
    if (!hasDirectKey && !usingEnv) {
      errors.push(MESSAGES.ERRORS.MISSING_API_KEYS);
    }
    if (this.isNonEmptyString(settings.geminiApiKey) && !this.isValidAPIKey(settings.geminiApiKey, "gemini")) {
      errors.push("Invalid Gemini API key format");
    }
    if (this.isNonEmptyString(settings.groqApiKey) && !this.isValidAPIKey(settings.groqApiKey, "groq")) {
      errors.push("Invalid Groq API key format");
    }
    if (usingEnv && !this.isNonEmptyString(settings.environmentPrefix)) {
      errors.push("Environment variable prefix is required when using environment variables");
    }
    if (!settings.outputPath || typeof settings.outputPath !== "string") {
      errors.push("Output path is required");
    }
    return {
      isValid: errors.length === 0,
      errors
    };
  }
  /**
   * Validate file path
   */
  static isValidPath(path) {
    return typeof path === "string" && path.trim().length > 0;
  }
  /**
   * Validate that a string is not empty
   */
  static isNonEmptyString(value) {
    return typeof value === "string" && value.trim().length > 0;
  }
  /**
   * Truncate text to specified length with ellipsis
   */
  static truncateText(text, maxLength) {
    if (text.length <= maxLength) {
      return text;
    }
    return text.substring(0, maxLength - 3) + "...";
  }
  /**
   * Clean HTML entities and escape sequences from text
   */
  static cleanText(text) {
    return text.replace(/\\n/g, "\n").replace(/\\"/g, '"').replace(/\\'/g, "'").replace(
      /\\u([0-9a-fA-F]{4})/g,
      (match, code) => String.fromCharCode(parseInt(code, 16))
    );
  }
};
/**
 * YouTube URL patterns for validation (ordered by frequency for performance)
 * Enhanced patterns to handle various YouTube URL formats
 */
ValidationUtils.URL_PATTERNS = [
  // Standard youtube.com/watch?v= format (most common)
  /(?:https?:\/\/)?(?:www\.)?youtube\.com\/watch\?v=([a-zA-Z0-9_-]{11})(?:&.*)?$/,
  // youtu.be short format (second most common)
  /(?:https?:\/\/)?(?:www\.)?youtu\.be\/([a-zA-Z0-9_-]{11})(?:\?.*)?$/,
  // youtube.com/embed format
  /(?:https?:\/\/)?(?:www\.)?youtube\.com\/embed\/([a-zA-Z0-9_-]{11})(?:\?.*)?$/,
  // youtube.com/v format
  /(?:https?:\/\/)?(?:www\.)?youtube\.com\/v\/([a-zA-Z0-9_-]{11})(?:\?.*)?$/,
  // Mobile youtube.com format
  /(?:https?:\/\/)?(?:m\.)?youtube\.com\/watch\?v=([a-zA-Z0-9_-]{11})(?:&.*)?$/
];
// Memoized regex for video ID validation (hot path optimization)
ValidationUtils.VIDEO_ID_REGEX = /^[a-zA-Z0-9_-]{11}$/;
ValidationUtils.URL_CACHE = /* @__PURE__ */ new Map();

// src/utils/error-handler.ts
var import_obsidian = require("obsidian");
var ErrorHandler = class {
  /**
   * Handle errors with consistent logging and user feedback
   */
  static handle(error, context, showNotice = true) {
    const errorMessage = `${context}: ${error.message}`;
    console.error(errorMessage, error);
    if (showNotice) {
      new import_obsidian.Notice(`Error: ${error.message}`);
    }
  }
  /**
   * Execute an operation with automatic error handling
   */
  static async withErrorHandling(operation, context, showNotice = true) {
    try {
      return await operation();
    } catch (error) {
      this.handle(error, context, showNotice);
      return null;
    }
  }
  /**
   * Execute a synchronous operation with error handling
   */
  static withSyncErrorHandling(operation, context, showNotice = true) {
    try {
      return operation();
    } catch (error) {
      this.handle(error, context, showNotice);
      return null;
    }
  }
  /**
   * Create a standardized error for API responses
   */
  static createAPIError(provider, status, statusText, details) {
    const message = `${provider} API error: ${status} ${statusText}${details ? `. ${details}` : ""}`;
    return new Error(message);
  }
  /**
   * Handle API response errors with consistent format
   */
  static async handleAPIError(response, provider, fallbackMessage) {
    var _a;
    let errorDetails = fallbackMessage || "";
    try {
      const errorData = await response.json();
      errorDetails = ((_a = errorData.error) == null ? void 0 : _a.message) || errorData.message || fallbackMessage || "";
    } catch (e) {
    }
    throw this.createAPIError(provider, response.status, response.statusText, errorDetails);
  }
  /**
   * Validate required configuration and throw descriptive errors
   */
  static validateConfiguration(config, requiredFields) {
    const missing = requiredFields.filter((field) => !config[field]);
    if (missing.length > 0) {
      throw new Error(`Missing required configuration: ${missing.join(", ")}`);
    }
  }
  /**
   * Create a user-friendly error message for common scenarios
   */
  static createUserFriendlyError(error, operation) {
    const message = `Failed to ${operation}: ${error.message}`;
    return new Error(message);
  }
  // Instance methods implementing interface
  handle(error, context, showNotice = true) {
    ErrorHandler.handle(error, context, showNotice);
  }
  async withErrorHandling(operation, context) {
    return ErrorHandler.withErrorHandling(operation, context);
  }
};

// src/components/modals/save-confirmation-modal.ts
var import_obsidian2 = require("obsidian");
var SaveConfirmationModal = class extends import_obsidian2.Modal {
  constructor(app, file, onConfirm) {
    super(app);
    this.file = file;
    this.onConfirm = onConfirm;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    try {
      contentEl.createEl("h2", { text: "Note created successfully. Open now?" });
      const buttonContainer = contentEl.createDiv("save-confirmation-buttons");
      new import_obsidian2.Setting(buttonContainer).addButton((btn) => btn.setButtonText("Open Note").setCta().onClick(() => {
        this.close();
        this.onConfirm(true);
      })).addButton((btn) => btn.setButtonText("Dismiss").onClick(() => {
        this.close();
        this.onConfirm(false);
      }));
      setTimeout(() => {
        const openButton = buttonContainer.querySelector("button");
        if (openButton) {
          openButton.focus();
        }
      }, 100);
    } catch (error) {
      console.error("[SaveConfirmationModal] Error in onOpen:", error);
      contentEl.createEl("h2", { text: "File Saved" });
      contentEl.createEl("p", { text: `File "${this.file.name}" has been saved successfully.` });
      contentEl.createEl("button", { text: "OK" }).onclick = () => this.close();
    }
  }
  /**
   * Get human-readable file size
   */
  getFileSize() {
    try {
      const stat = this.app.vault.adapter.stat(this.file.path);
      if (stat && typeof stat === "object" && "size" in stat) {
        const bytes = stat.size;
        if (bytes < 1024)
          return `${bytes} bytes`;
        if (bytes < 1024 * 1024)
          return `${(bytes / 1024).toFixed(1)} KB`;
        return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;
      }
    } catch (error) {
    }
    return "";
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  /**
   * Add custom styles for the modal
   */
  addStyles() {
    var _a;
    const { contentEl } = this;
    contentEl.addClass("ytp-save-confirmation-modal");
    const style = document.createElement("style");
    style.textContent = `
            .ytp-save-confirmation-modal {
                min-width: 450px;
                max-width: 650px;
            }
            
            .save-confirmation-message {
                margin: 20px 0 30px 0;
                text-align: left;
                line-height: 1.6;
            }
            
            .save-confirmation-filename {
                font-weight: bold;
                font-size: 1.1em;
                margin-bottom: 15px;
                color: var(--text-accent);
                text-align: center;
            }
            
            .save-confirmation-location-container,
            .save-confirmation-size-container {
                margin-bottom: 10px;
                display: flex;
                align-items: center;
                gap: 8px;
            }
            
            .save-confirmation-location {
                font-family: var(--font-monospace);
                background: var(--background-secondary);
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 0.9em;
                word-break: break-all;
                color: var(--text-muted);
                flex: 1;
            }
            
            .save-confirmation-size {
                font-family: var(--font-monospace);
                background: var(--background-modifier-success);
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 0.9em;
                color: var(--text-on-accent);
            }
            
            .save-confirmation-buttons {
                text-align: center;
                margin-top: 20px;
                display: flex;
                justify-content: center;
                gap: 15px;
            }
            
            .save-confirmation-buttons .setting-item {
                border: none;
                padding: 0;
                margin: 0;
                display: flex;
                gap: 10px;
            }
            
            .save-confirmation-buttons button {
                min-width: 100px;
                padding: 8px 20px;
                font-size: 1em;
            }
            
            .save-confirmation-buttons button:first-child {
                /* Open File button - primary action */
                background-color: var(--interactive-accent);
                color: var(--text-on-accent);
            }
            
            .save-confirmation-buttons button:last-child {
                /* OK button - secondary action */
                background-color: var(--background-modifier-border);
                color: var(--text-normal);
            }
        `;
    document.head.appendChild(style);
    (_a = this.modalEl) == null ? void 0 : _a.setAttribute("data-style-id", "ytp-save-confirmation-style");
  }
};

// src/components/modals/youtube-url-modal.ts
var import_obsidian4 = require("obsidian");
init_base_modal();
init_api();
var YouTubeUrlModal = class extends BaseModal {
  constructor(app, options) {
    super(app);
    this.options = options;
    this.url = "";
    this.format = "executive-summary";
    this.fetchInProgress = false;
    this.progressSteps = [];
    this.currentStepIndex = 0;
    this.isProcessing = false;
    this.url = options.initialUrl || "";
  }
  onOpen() {
    this.createModalContent();
    this.setupEventHandlers();
    if (this.options.initialUrl) {
      this.updateProcessButtonState();
      const isValid = ValidationUtils.isValidYouTubeUrl((this.options.initialUrl || "").trim());
      if (isValid && this.processButton) {
        this.processButton.focus();
        return;
      }
    }
    this.focusUrlInput();
  }
  /**
   * Create modal content
   */
  createModalContent() {
    this.headerEl = this.createHeader(MESSAGES.MODALS.PROCESS_VIDEO);
    this.createUrlInputSection();
    this.createFormatSelectionSection();
    this.createProviderSelectionSection();
    this.createProgressSection();
    this.createActionButtons();
  }
  createProviderSelectionSection() {
    const container = this.contentEl.createDiv();
    container.style.marginTop = "10px";
    const label = container.createEl("label", { text: "AI Provider & Model:" });
    label.setAttribute("for", "ytc-provider-select");
    const row = container.createDiv();
    row.style.display = "flex";
    row.style.gap = "8px";
    row.style.alignItems = "center";
    this.providerSelect = document.createElement("select");
    this.providerSelect.id = "ytc-provider-select";
    this.providerSelect.setAttribute("aria-label", "AI Provider");
    this.providerSelect.style.flex = "1";
    this.providerSelect.style.padding = "6px";
    this.providerSelect.style.borderRadius = "6px";
    this.providerSelect.style.border = "1px solid var(--background-modifier-border)";
    row.appendChild(this.providerSelect);
    this.modelSelect = document.createElement("select");
    this.modelSelect.id = "ytc-model-select";
    this.modelSelect.setAttribute("aria-label", "AI Model");
    this.modelSelect.style.width = "220px";
    this.modelSelect.style.padding = "6px";
    this.modelSelect.style.borderRadius = "6px";
    this.modelSelect.style.border = "1px solid var(--background-modifier-border)";
    row.appendChild(this.modelSelect);
    const providers = this.options.providers || [];
    const modelOptions = this.options.modelOptions || {};
    const autoOpt = document.createElement("option");
    autoOpt.value = "";
    autoOpt.text = "Auto (fallback)";
    this.providerSelect.appendChild(autoOpt);
    providers.forEach((p) => {
      const opt = document.createElement("option");
      opt.value = p;
      opt.text = p;
      this.providerSelect.appendChild(opt);
    });
    const refreshBtn = this.createInlineButton(row, "Refresh models", () => {
      void this.handleRefreshModels();
    });
    this.refreshSpinner = document.createElement("span");
    this.refreshSpinner.style.display = "none";
    this.refreshSpinner.style.marginLeft = "8px";
    this.refreshSpinner.style.width = "16px";
    this.refreshSpinner.style.height = "16px";
    this.refreshSpinner.style.border = "2px solid var(--background-modifier-border)";
    this.refreshSpinner.style.borderTop = "2px solid var(--interactive-accent)";
    this.refreshSpinner.style.borderRadius = "50%";
    this.refreshSpinner.style.animation = "ytp-spin 1s linear infinite";
    row.appendChild(this.refreshSpinner);
    this.providerSelect.addEventListener("change", () => {
      this.selectedProvider = this.providerSelect.value || void 0;
      this.populateModelsForProvider(this.selectedProvider || "", modelOptions, this.options.defaultModel);
    });
    if (this.options.defaultProvider) {
      this.providerSelect.value = this.options.defaultProvider;
      this.selectedProvider = this.options.defaultProvider;
    }
    this.populateModelsForProvider(this.selectedProvider || "", modelOptions, this.options.defaultModel);
  }
  async handleRefreshModels() {
    if (!this.options.fetchModels) {
      this.setValidationMessage("Model refresh not available.", "error");
      return;
    }
    this.setValidationMessage("Refreshing model lists\u2026", "info");
    if (this.refreshSpinner)
      this.refreshSpinner.style.display = "inline-block";
    try {
      const map = await this.options.fetchModels();
      const providers = Object.keys(map);
      if (this.providerSelect) {
        const current = this.providerSelect.value;
        this.providerSelect.innerHTML = "";
        const autoOpt = document.createElement("option");
        autoOpt.value = "";
        autoOpt.text = "Auto (fallback)";
        this.providerSelect.appendChild(autoOpt);
        providers.forEach((p) => {
          const opt = document.createElement("option");
          opt.value = p;
          opt.text = p;
          this.providerSelect.appendChild(opt);
        });
        if (current && Array.from(this.providerSelect.options).some((o) => o.value === current)) {
          this.providerSelect.value = current;
          this.selectedProvider = current;
        }
      }
      const modelOptions = map;
      this.populateModelsForProvider(this.selectedProvider || "", modelOptions, this.options.defaultModel);
      this.setValidationMessage("Model lists refreshed.", "success");
    } catch (error) {
      this.setValidationMessage("Failed to refresh models. Using cached options.", "error");
    } finally {
      if (this.refreshSpinner)
        this.refreshSpinner.style.display = "none";
    }
  }
  populateModelsForProvider(providerName, modelOptions, defaultModel) {
    if (!this.modelSelect)
      return;
    this.modelSelect.innerHTML = "";
    const models = modelOptions[providerName] || [];
    if (models.length === 0) {
      const opt = document.createElement("option");
      opt.value = "";
      opt.text = "Default model";
      this.modelSelect.appendChild(opt);
      this.selectedModel = "";
      return;
    }
    models.forEach((m) => {
      const opt = document.createElement("option");
      opt.value = m;
      let label = m;
      try {
        const providerModels = PROVIDER_MODEL_OPTIONS[providerName] || [];
        const match = providerModels.find((pm) => {
          const name = typeof pm === "string" ? pm : pm && pm.name ? pm.name : "";
          return String(name).toLowerCase() === String(m).toLowerCase();
        });
        if (match && match.supportsAudioVideo) {
          label = `${m}  \u{1F3A5}`;
          opt.title = "Supports multimodal audio/video tokens";
        }
      } catch (err) {
      }
      opt.text = label;
      this.modelSelect.appendChild(opt);
    });
    if (defaultModel && models.includes(defaultModel)) {
      this.modelSelect.value = defaultModel;
      this.selectedModel = defaultModel;
    } else {
      this.modelSelect.selectedIndex = 0;
      this.selectedModel = this.modelSelect.value;
    }
    this.modelSelect.addEventListener("change", () => {
      this.selectedModel = this.modelSelect.value;
    });
  }
  /**
   * Create URL input section
   */
  createUrlInputSection() {
    const container = this.contentEl.createDiv();
    const label = container.createEl("label", { text: "YouTube URL:" });
    label.setAttribute("for", "ytc-url-input");
    const inputRow = container.createDiv();
    inputRow.style.display = "flex";
    inputRow.style.gap = "8px";
    inputRow.style.alignItems = "center";
    this.urlInput = this.createInput(
      inputRow,
      "url",
      MESSAGES.PLACEHOLDERS.YOUTUBE_URL + " (Press Enter to process)"
    );
    this.urlInput.id = "ytc-url-input";
    this.urlInput.setAttribute("aria-label", "YouTube URL");
    this.urlInput.setAttribute("aria-describedby", "ytc-url-hint");
    this.urlInput.style.flex = "1";
    this.urlInput.style.transition = "border-color 0.2s ease, box-shadow 0.2s ease";
    this.pasteButton = this.createInlineButton(inputRow, "Paste", () => {
      void this.handlePasteFromClipboard();
    });
    this.pasteButton.setAttribute("aria-label", "Paste YouTube URL from clipboard");
    this.clearButton = this.createInlineButton(inputRow, "Clear", () => {
      this.handleClearUrl();
    });
    this.clearButton.setAttribute("aria-label", "Clear YouTube URL input");
    if (this.options.initialUrl) {
      this.urlInput.value = this.options.initialUrl;
      this.url = this.options.initialUrl;
    }
    this.urlInput.addEventListener("input", (e) => {
      this.url = e.target.value;
      this.updateProcessButtonState();
      this.updateQuickActionsState();
    });
    this.validationMessage = container.createDiv();
    this.validationMessage.id = "ytc-url-hint";
    this.validationMessage.style.marginTop = "6px";
    this.validationMessage.style.fontSize = "0.85rem";
    this.validationMessage.style.color = "var(--text-muted)";
    this.validationMessage.setAttribute("role", "status");
    this.setValidationMessage("Paste a YouTube link to begin processing.", "info");
    const preview = container.createDiv();
    preview.style.display = "flex";
    preview.style.gap = "10px";
    preview.style.alignItems = "center";
    preview.style.marginTop = "8px";
    this.thumbnailEl = preview.createEl("img");
    this.thumbnailEl.setAttribute("aria-label", "Video thumbnail");
    this.thumbnailEl.style.width = "120px";
    this.thumbnailEl.style.height = "68px";
    this.thumbnailEl.style.objectFit = "cover";
    this.thumbnailEl.style.borderRadius = "4px";
    this.thumbnailEl.style.display = "none";
    this.metadataContainer = preview.createDiv();
    this.metadataContainer.setAttribute("aria-label", "Video metadata");
    this.metadataContainer.style.display = "none";
    this.metadataContainer.style.fontSize = "0.9rem";
    this.metadataContainer.style.color = "var(--text-normal)";
    this.metadataContainer.createDiv({ cls: "yt-preview-title" });
    this.metadataContainer.createDiv({ cls: "yt-preview-channel" });
    this.setUrlInputState("idle");
    this.updateQuickActionsState();
  }
  /**
   * Create format selection section with radio buttons
   */
  createFormatSelectionSection() {
    const container = this.contentEl.createDiv();
    const label = container.createEl("label", { text: "Output Format:" });
    label.id = "format-group-label";
    const radioContainer = container.createDiv();
    radioContainer.setAttribute("role", "group");
    radioContainer.setAttribute("aria-labelledby", "format-group-label");
    radioContainer.style.marginTop = "8px";
    radioContainer.style.display = "flex";
    radioContainer.style.gap = "20px";
    radioContainer.style.flexWrap = "wrap";
    const executiveContainer = radioContainer.createDiv();
    executiveContainer.style.display = "flex";
    executiveContainer.style.alignItems = "center";
    executiveContainer.style.gap = "8px";
    const executiveRadio = executiveContainer.createEl("input");
    executiveRadio.type = "radio";
    executiveRadio.name = "outputFormat";
    executiveRadio.value = "executive-summary";
    executiveRadio.id = "executive-radio";
    executiveRadio.checked = this.format === "executive-summary";
    executiveRadio.setAttribute("aria-label", "Executive Summary format");
    const executiveLabel = executiveContainer.createEl("label");
    executiveLabel.setAttribute("for", "executive-radio");
    executiveLabel.textContent = "Executive";
    executiveLabel.style.cursor = "pointer";
    const tutorialContainer = radioContainer.createDiv();
    tutorialContainer.style.display = "flex";
    tutorialContainer.style.alignItems = "center";
    tutorialContainer.style.gap = "8px";
    const tutorialRadio = tutorialContainer.createEl("input");
    tutorialRadio.type = "radio";
    tutorialRadio.name = "outputFormat";
    tutorialRadio.value = "detailed-guide";
    tutorialRadio.id = "tutorial-radio";
    tutorialRadio.checked = this.format === "detailed-guide";
    tutorialRadio.setAttribute("aria-label", "Detailed Guide format");
    const tutorialLabel = tutorialContainer.createEl("label");
    tutorialLabel.setAttribute("for", "tutorial-radio");
    tutorialLabel.textContent = "Tutorial";
    tutorialLabel.style.cursor = "pointer";
    executiveRadio.addEventListener("change", (e) => {
      if (e.target.checked) {
        this.format = "executive-summary";
        if (this.customPromptContainer) {
          this.customPromptContainer.style.display = "none";
        }
      }
    });
    tutorialRadio.addEventListener("change", (e) => {
      if (e.target.checked) {
        this.format = "detailed-guide";
        if (this.customPromptContainer) {
          this.customPromptContainer.style.display = "none";
        }
      }
    });
    const briefContainer = radioContainer.createDiv();
    briefContainer.style.display = "flex";
    briefContainer.style.alignItems = "center";
    briefContainer.style.gap = "8px";
    const briefRadio = briefContainer.createEl("input");
    briefRadio.type = "radio";
    briefRadio.name = "outputFormat";
    briefRadio.value = "brief";
    briefRadio.id = "brief-radio";
    briefRadio.checked = this.format === "brief";
    briefRadio.setAttribute("aria-label", "Brief format");
    const briefLabel = briefContainer.createEl("label");
    briefLabel.setAttribute("for", "brief-radio");
    briefLabel.textContent = "Brief";
    briefLabel.style.cursor = "pointer";
    briefRadio.addEventListener("change", (e) => {
      if (e.target.checked) {
        this.format = "brief";
        if (this.customPromptContainer) {
          this.customPromptContainer.style.display = "none";
        }
      }
    });
    const customContainer = radioContainer.createDiv();
    customContainer.style.display = "flex";
    customContainer.style.alignItems = "center";
    customContainer.style.gap = "8px";
    const customRadio = customContainer.createEl("input");
    customRadio.type = "radio";
    customRadio.name = "outputFormat";
    customRadio.value = "custom";
    customRadio.id = "custom-radio";
    customRadio.checked = this.format === "custom";
    customRadio.setAttribute("aria-label", "Custom prompt format");
    const customLabel = customContainer.createEl("label");
    customLabel.setAttribute("for", "custom-radio");
    customLabel.textContent = "Custom";
    customLabel.style.cursor = "pointer";
    customRadio.addEventListener("change", (e) => {
      var _a;
      if (e.target.checked) {
        this.format = "custom";
        if (this.customPromptContainer) {
          this.customPromptContainer.style.display = "block";
          (_a = this.customPromptInput) == null ? void 0 : _a.focus();
        }
      }
    });
    this.customPromptContainer = container.createDiv();
    this.customPromptContainer.style.marginTop = "12px";
    this.customPromptContainer.style.padding = "12px";
    this.customPromptContainer.style.backgroundColor = "var(--background-modifier-hover)";
    this.customPromptContainer.style.borderRadius = "4px";
    this.customPromptContainer.style.display = "none";
    const customPromptLabel = this.customPromptContainer.createEl("label", {
      text: "Custom Prompt (this session only):"
    });
    customPromptLabel.setAttribute("for", "custom-prompt-input");
    customPromptLabel.style.display = "block";
    customPromptLabel.style.marginBottom = "6px";
    customPromptLabel.style.fontWeight = "600";
    customPromptLabel.style.fontSize = "0.95rem";
    this.customPromptInput = this.customPromptContainer.createEl("textarea");
    this.customPromptInput.id = "custom-prompt-input";
    this.customPromptInput.setAttribute("aria-label", "Custom AI prompt");
    this.customPromptInput.setAttribute("placeholder", "Enter your custom prompt here. Available placeholders: __VIDEO_TITLE__, __VIDEO_DESCRIPTION__, __VIDEO_URL__");
    this.customPromptInput.style.width = "100%";
    this.customPromptInput.style.height = "100px";
    this.customPromptInput.style.padding = "8px";
    this.customPromptInput.style.fontFamily = "monospace";
    this.customPromptInput.style.fontSize = "12px";
    this.customPromptInput.style.border = "1px solid var(--background-modifier-border)";
    this.customPromptInput.style.borderRadius = "4px";
    this.customPromptInput.style.resize = "vertical";
    this.customPromptInput.style.marginBottom = "6px";
    const helpText = this.customPromptContainer.createEl("small");
    helpText.textContent = "Placeholders: __VIDEO_TITLE__, __VIDEO_DESCRIPTION__, __VIDEO_URL__, __VIDEO_ID__, __EMBED_URL__, __DATE__, __TIMESTAMP__";
    helpText.style.display = "block";
    helpText.style.marginTop = "4px";
    helpText.style.color = "var(--text-muted)";
    helpText.style.fontSize = "11px";
  }
  /**
   * Create progress section
   */
  createProgressSection() {
    this.progressContainer = this.contentEl.createDiv();
    this.progressContainer.setAttribute("role", "region");
    this.progressContainer.setAttribute("aria-label", "Processing progress");
    this.progressContainer.setAttribute("aria-live", "polite");
    this.progressContainer.style.marginTop = "16px";
    this.progressContainer.style.display = "none";
    this.progressText = this.progressContainer.createDiv();
    this.progressText.id = "progress-text";
    this.progressText.style.marginBottom = "8px";
    this.progressText.style.fontWeight = "500";
    this.progressText.style.color = "var(--text-accent)";
    this.progressText.textContent = "Processing video...";
    const progressBarContainer = this.progressContainer.createDiv();
    progressBarContainer.setAttribute("role", "progressbar");
    progressBarContainer.setAttribute("aria-valuenow", "0");
    progressBarContainer.setAttribute("aria-valuemin", "0");
    progressBarContainer.setAttribute("aria-valuemax", "100");
    progressBarContainer.setAttribute("aria-labelledby", "progress-text");
    progressBarContainer.style.width = "100%";
    progressBarContainer.style.height = "6px";
    progressBarContainer.style.backgroundColor = "var(--background-modifier-border)";
    progressBarContainer.style.borderRadius = "3px";
    progressBarContainer.style.overflow = "hidden";
    this.progressBar = progressBarContainer.createDiv();
    this.progressBar.style.height = "100%";
    this.progressBar.style.backgroundColor = "var(--text-accent)";
    this.progressBar.style.borderRadius = "3px";
    this.progressBar.style.width = "0%";
    this.progressBar.style.transition = "width 0.3s ease";
    const stepList = this.progressContainer.createEl("ol");
    stepList.setAttribute("aria-label", "Processing steps");
    stepList.style.marginTop = "12px";
    stepList.style.paddingLeft = "20px";
    stepList.style.fontSize = "0.9rem";
    stepList.style.color = "var(--text-normal)";
    const labels = [
      "Validate URL",
      "Fetch video info",
      "Run AI analysis",
      "Save note"
    ];
    this.progressSteps = labels.map((label) => {
      const item = stepList.createEl("li");
      item.setAttribute("role", "status");
      item.style.marginBottom = "4px";
      item.textContent = `\u25CB ${label}`;
      return { label, element: item };
    });
  }
  /**
   * Create action buttons with accessibility
   */
  createActionButtons() {
    const container = this.createButtonContainer();
    const cancelBtn = this.createButton(
      container,
      MESSAGES.MODALS.CANCEL,
      false,
      () => this.close()
    );
    cancelBtn.setAttribute("aria-label", "Cancel video processing");
    this.processButton = this.createButton(
      container,
      MESSAGES.MODALS.PROCESS,
      true,
      () => this.handleProcess()
    );
    this.processButton.setAttribute("aria-label", "Process YouTube video");
    this.openButton = this.createButton(
      container,
      "Open Note",
      true,
      () => this.handleOpenFile()
    );
    this.openButton.setAttribute("aria-label", "Open the processed note");
    this.openButton.style.display = "none";
    this.updateProcessButtonState();
  }
  /**
   * Set up event handlers
   */
  setupEventHandlers() {
    this.setupKeyHandlers(
      () => this.handleProcess(),
      () => this.close()
    );
  }
  /**
   * Focus on URL input
   */
  focusUrlInput() {
    if (this.urlInput) {
      this.focusElement(this.urlInput);
    }
  }
  /**
   * Update process button enabled state (optimized with debouncing and memoization)
   */
  updateProcessButtonState() {
    if (!this.processButton)
      return;
    if (this.isProcessing) {
      return;
    }
    const trimmedUrl = this.url.trim();
    if (this.processButton && this.processButton.textContent !== MESSAGES.MODALS.PROCESS && trimmedUrl.length >= 0) {
      this.processButton.textContent = MESSAGES.MODALS.PROCESS;
    }
    if (trimmedUrl === this.lastValidUrl) {
      const isValid = this.lastValidResult;
      this.processButton.disabled = !isValid;
      this.processButton.style.opacity = isValid ? "1" : "0.5";
      if (trimmedUrl.length === 0) {
        this.setValidationMessage("Paste a YouTube link to begin processing.", "info");
        this.setUrlInputState("idle");
      } else {
        this.setValidationMessage(
          isValid ? "Ready to process this video." : "Enter a valid YouTube video URL.",
          isValid ? "success" : "error"
        );
        this.setUrlInputState(isValid ? "valid" : "invalid");
      }
      this.updateQuickActionsState();
      return;
    }
    if (this.validationTimer) {
      clearTimeout(this.validationTimer);
    }
    this.validationTimer = window.setTimeout(() => {
      const isValid = ValidationUtils.isValidYouTubeUrl(trimmedUrl);
      this.lastValidUrl = trimmedUrl;
      this.lastValidResult = isValid;
      this.processButton.disabled = !isValid;
      this.processButton.style.opacity = isValid ? "1" : "0.5";
      if (trimmedUrl.length === 0) {
        this.setValidationMessage("Paste a YouTube link to begin processing.", "info");
        this.setUrlInputState("idle");
      } else {
        this.setValidationMessage(
          isValid ? "Ready to process this video." : "Enter a valid YouTube video URL.",
          isValid ? "success" : "error"
        );
        this.setUrlInputState(isValid ? "valid" : "invalid");
      }
      this.updateQuickActionsState();
      if (isValid) {
        void this.maybeFetchPreview(trimmedUrl);
      } else {
        this.clearPreview();
      }
    }, 300);
  }
  /**
   * Validate URL input (simplified - used by debounced handler)
   */
  isUrlValid() {
    return ValidationUtils.isValidYouTubeUrl(this.url.trim());
  }
  /**
   * Handle process button click
   */
  async handleProcess() {
    var _a;
    const trimmedUrl = this.url.trim();
    if (!trimmedUrl) {
      new import_obsidian4.Notice(MESSAGES.ERRORS.ENTER_URL);
      this.focusUrlInput();
      return;
    }
    if (!this.isUrlValid()) {
      new import_obsidian4.Notice(MESSAGES.ERRORS.INVALID_URL);
      this.focusUrlInput();
      return;
    }
    try {
      if (this.selectedProvider === "Google Gemini" && this.selectedModel && this.isUrlValid()) {
        try {
          const models = PROVIDER_MODEL_OPTIONS["Google Gemini"] || [];
          const match = models.find((m) => {
            const name = typeof m === "string" ? m : m && m.name ? m.name : "";
            return String(name).toLowerCase() === String(this.selectedModel || "").toLowerCase();
          });
          const supportsAudioVideo = !!(match && match.supportsAudioVideo);
          if (!supportsAudioVideo) {
            const recommended = (models.find((m) => m && m.supportsAudioVideo) || { name: AI_MODELS.GEMINI }).name;
            const shouldSwitch = await this.showConfirmationModal(
              "Multimodal Model Recommended",
              `The selected model (${this.selectedModel}) may not support multimodal analysis.

Would you like to switch to a multimodal-capable model (${recommended}) for better video analysis?`,
              "Switch to Multimodal",
              "Keep Current Model",
              false
            );
            if (shouldSwitch) {
              if (this.modelSelect) {
                const exists = Array.from(this.modelSelect.options).some((o) => o.value === recommended);
                if (!exists) {
                  const opt = document.createElement("option");
                  opt.value = recommended;
                  opt.text = recommended;
                  this.modelSelect.appendChild(opt);
                }
                this.modelSelect.value = recommended;
                this.selectedModel = recommended;
              } else {
                this.selectedModel = recommended;
              }
            }
          }
        } catch (err) {
          console.warn("[YouTubeUrlModal] model recommendation failed", err);
        }
      }
      this.showProcessingState();
      this.setStepState(0, "active");
      this.updateProgress(20, "Validating YouTube URL...");
      await new Promise((resolve) => setTimeout(resolve, 500));
      this.setStepState(0, "complete");
      this.setStepState(1, "active");
      this.updateProgress(40, "Extracting video data...");
      await new Promise((resolve) => setTimeout(resolve, 500));
      this.setStepState(1, "complete");
      this.setStepState(2, "active");
      this.updateProgress(60, "Analyzing video content...");
      const customPrompt = this.format === "custom" ? (_a = this.customPromptInput) == null ? void 0 : _a.value : void 0;
      const filePath = await this.options.onProcess(
        trimmedUrl,
        this.format,
        this.selectedProvider,
        this.selectedModel,
        customPrompt
      );
      this.setStepState(2, "complete");
      this.setStepState(3, "active");
      this.updateProgress(80, "Generating note...");
      await new Promise((resolve) => setTimeout(resolve, 300));
      this.updateProgress(100, "Complete!");
      this.setStepState(3, "complete");
      this.processedFilePath = filePath;
      this.showCompletionState();
    } catch (error) {
      this.flagActiveStepAsError();
      this.showErrorState(error);
      ErrorHandler.handle(error, "YouTube URL processing");
    }
  }
  /**
   * Handle open file button click
   */
  async handleOpenFile() {
    if (this.processedFilePath && this.options.onOpenFile) {
      try {
        await this.options.onOpenFile(this.processedFilePath);
        this.close();
      } catch (error) {
        ErrorHandler.handle(error, "Opening file");
      }
    }
  }
  /**
   * Show processing state
   */
  showProcessingState() {
    this.isProcessing = true;
    this.setValidationMessage("Processing video. This may take a moment...", "info");
    this.resetProgressSteps();
    if (this.progressContainer) {
      this.progressContainer.style.display = "block";
    }
    if (this.urlInput) {
      this.urlInput.disabled = true;
    }
    if (this.processButton) {
      this.processButton.disabled = true;
      this.processButton.textContent = "Processing...";
    }
    if (this.openButton) {
      this.openButton.style.display = "none";
    }
    this.setUrlInputState("idle");
    this.updateQuickActionsState();
  }
  /**
   * Show completion state
   */
  showCompletionState() {
    this.isProcessing = false;
    if (this.progressContainer) {
      this.progressContainer.style.display = "none";
    }
    if (this.urlInput) {
      this.urlInput.disabled = false;
    }
    if (this.processButton) {
      this.processButton.disabled = false;
      this.processButton.textContent = "Process Another";
      this.processButton.style.display = "inline-block";
      this.processButton.style.opacity = "1";
    }
    if (this.openButton) {
      this.openButton.style.display = "inline-block";
    }
    if (this.headerEl) {
      this.headerEl.textContent = "\u2705 Video Processed Successfully!";
    }
    this.setValidationMessage("Note saved to today's folder. You can open it now or process another video.", "success");
    this.focusUrlInput();
    this.updateQuickActionsState();
    this.setUrlInputState(this.url.trim().length > 0 ? "valid" : "idle");
  }
  /**
   * Show error state
   */
  showErrorState(error) {
    this.isProcessing = false;
    if (this.progressContainer) {
      this.progressContainer.style.display = "none";
    }
    if (this.urlInput) {
      this.urlInput.disabled = false;
    }
    if (this.processButton) {
      this.processButton.disabled = false;
      this.processButton.textContent = MESSAGES.MODALS.PROCESS;
      this.processButton.style.display = "inline-block";
    }
    if (this.openButton) {
      this.openButton.style.display = "none";
    }
    if (this.headerEl) {
      this.headerEl.textContent = "\u274C Processing Failed";
    }
    this.setValidationMessage(error.message, "error");
    this.updateQuickActionsState();
    this.setUrlInputState(this.url.trim().length > 0 ? "invalid" : "idle");
  }
  /**
   * Update progress bar and text
   */
  updateProgress(percent, text) {
    if (this.progressBar) {
      this.progressBar.style.width = `${percent}%`;
    }
    if (this.progressText) {
      this.progressText.textContent = text;
    }
  }
  /**
   * Set initial URL value
   */
  setUrl(url) {
    this.url = url;
    if (this.urlInput) {
      this.urlInput.value = url;
      this.updateProcessButtonState();
      this.updateQuickActionsState();
      const trimmed = url.trim();
      if (trimmed.length === 0) {
        this.setUrlInputState("idle");
      } else {
        this.setUrlInputState(ValidationUtils.isValidYouTubeUrl(trimmed) ? "valid" : "invalid");
      }
    }
  }
  /**
   * Clean up resources when modal is closed
   */
  onClose() {
    if (this.validationTimer) {
      clearTimeout(this.validationTimer);
      this.validationTimer = void 0;
    }
    super.onClose();
  }
  /**
   * Get current URL value
   */
  getUrl() {
    return this.url;
  }
  resetProgressSteps() {
    this.currentStepIndex = 0;
    if (this.progressSteps.length === 0) {
      return;
    }
    this.progressSteps.forEach((step) => {
      step.element.textContent = `\u25CB ${step.label}`;
    });
  }
  setStepState(index, state) {
    const target = this.progressSteps[index];
    if (!target) {
      return;
    }
    const prefix = this.getStepPrefix(state);
    target.element.textContent = `${prefix} ${target.label}`;
    if (state === "active") {
      this.currentStepIndex = index;
    } else if (state === "complete" && this.currentStepIndex === index) {
      this.currentStepIndex = Math.min(index + 1, this.progressSteps.length - 1);
    }
  }
  flagActiveStepAsError() {
    if (this.progressSteps.length === 0) {
      return;
    }
    this.setStepState(this.currentStepIndex, "error");
  }
  getStepPrefix(state) {
    switch (state) {
      case "active":
        return "\u25CF";
      case "complete":
        return "\u2714";
      case "error":
        return "\u26A0";
      default:
        return "\u25CB";
    }
  }
  createInlineButton(container, label, onClick) {
    const button = container.createEl("button", { text: label });
    button.style.padding = "6px 12px";
    button.style.fontSize = "0.85rem";
    button.style.borderRadius = "6px";
    button.style.border = "1px solid var(--background-modifier-border)";
    button.style.backgroundColor = "var(--background-primary)";
    button.style.color = "var(--text-normal)";
    button.style.cursor = "pointer";
    button.style.transition = "background-color 0.2s ease";
    button.addEventListener("mouseenter", () => {
      button.style.backgroundColor = "var(--background-modifier-hover)";
    });
    button.addEventListener("mouseleave", () => {
      button.style.backgroundColor = "var(--background-primary)";
    });
    button.addEventListener("click", onClick);
    return button;
  }
  async handlePasteFromClipboard() {
    if (this.isProcessing) {
      return;
    }
    if (!navigator.clipboard || !navigator.clipboard.readText) {
      this.setValidationMessage("Clipboard access is not available in this environment.", "error");
      new import_obsidian4.Notice("Clipboard access is not available.");
      return;
    }
    try {
      const text = await navigator.clipboard.readText();
      if (!text) {
        this.setValidationMessage("Clipboard is empty. Copy a YouTube URL first.", "info");
        return;
      }
      const trimmed = text.trim();
      this.url = trimmed;
      if (this.urlInput) {
        this.urlInput.value = trimmed;
      }
      this.lastValidUrl = void 0;
      this.updateProcessButtonState();
      this.updateQuickActionsState();
      const isValid = ValidationUtils.isValidYouTubeUrl(trimmed);
      this.setValidationMessage(
        isValid ? "Ready to process this video." : "Enter a valid YouTube video URL.",
        isValid ? "success" : "error"
      );
      this.setUrlInputState(isValid ? "valid" : "invalid");
      if (this.processButton && !this.isProcessing && isValid) {
        this.processButton.focus();
      } else {
        this.focusUrlInput();
      }
    } catch (error) {
      ErrorHandler.handle(error, "Reading clipboard", false);
      this.setValidationMessage("Could not read from clipboard. Paste manually instead.", "error");
      new import_obsidian4.Notice("Could not read from clipboard.");
    }
  }
  handleClearUrl() {
    if (this.isProcessing) {
      return;
    }
    this.url = "";
    if (this.urlInput) {
      this.urlInput.value = "";
    }
    this.lastValidUrl = void 0;
    this.updateProcessButtonState();
    this.updateQuickActionsState();
    this.setValidationMessage("Paste a YouTube link to begin processing.", "info");
    this.setUrlInputState("idle");
    this.focusUrlInput();
  }
  updateQuickActionsState() {
    const hasUrl = this.url.trim().length > 0;
    if (this.clearButton) {
      this.clearButton.disabled = !hasUrl || this.isProcessing;
      this.clearButton.style.opacity = this.clearButton.disabled ? "0.5" : "1";
    }
    if (this.pasteButton) {
      this.pasteButton.disabled = this.isProcessing;
      this.pasteButton.style.opacity = this.pasteButton.disabled ? "0.5" : "1";
    }
  }
  setUrlInputState(state) {
    if (!this.urlInput) {
      return;
    }
    let borderColor = "var(--background-modifier-border)";
    let boxShadow = "none";
    if (state === "valid") {
      borderColor = "var(--text-accent)";
      boxShadow = "0 0 0 1px var(--text-accent)";
    } else if (state === "invalid") {
      borderColor = "var(--text-error)";
      boxShadow = "0 0 0 1px var(--text-error)";
    }
    this.urlInput.style.borderColor = borderColor;
    this.urlInput.style.boxShadow = boxShadow;
  }
  setValidationMessage(message, type) {
    if (!this.validationMessage) {
      return;
    }
    this.validationMessage.textContent = message;
    let color = "var(--text-muted)";
    if (type === "error") {
      color = "var(--text-error)";
    } else if (type === "success") {
      color = "var(--text-accent)";
    } else {
      color = "var(--text-muted)";
    }
    this.validationMessage.style.color = color;
  }
  /**
   * Try to fetch a lightweight preview for the provided YouTube URL using oEmbed.
   */
  async maybeFetchPreview(url) {
    if (this.fetchInProgress)
      return;
    if (!url)
      return;
    if (this.lastValidUrl === url && this.thumbnailEl && this.thumbnailEl.style.display === "block") {
      return;
    }
    this.setFetchingState(true);
    try {
      const meta = await this.fetchVideoPreview(url);
      if (meta) {
        this.showPreview(meta);
      } else {
        this.clearPreview();
      }
    } catch (error) {
      this.clearPreview();
    } finally {
      this.setFetchingState(false);
    }
  }
  setFetchingState(isFetching) {
    var _a;
    this.fetchInProgress = isFetching;
    if (this.processButton) {
      this.processButton.disabled = isFetching || !((_a = this.lastValidResult) != null ? _a : false);
      this.processButton.style.opacity = this.processButton.disabled ? "0.5" : "1";
    }
    if (this.validationMessage) {
      if (isFetching)
        this.setValidationMessage("Fetching preview...", "info");
      else if (this.lastValidResult)
        this.setValidationMessage("Ready to process this video.", "success");
      else
        this.setValidationMessage("Enter a valid YouTube video URL.", "error");
    }
  }
  async fetchVideoPreview(url) {
    try {
      const oembed = `https://www.youtube.com/oembed?url=${encodeURIComponent(url)}&format=json`;
      const res = await fetch(oembed);
      if (!res.ok)
        return null;
      const data = await res.json();
      return {
        title: data.title || "",
        author: data.author_name || "",
        thumbnail: data.thumbnail_url || ""
      };
    } catch (error) {
      return null;
    }
  }
  showPreview(meta) {
    if (!this.thumbnailEl || !this.metadataContainer)
      return;
    if (meta.thumbnail) {
      this.thumbnailEl.src = meta.thumbnail;
      this.thumbnailEl.style.display = "block";
    } else {
      this.thumbnailEl.style.display = "none";
    }
    const titleEl = this.metadataContainer.querySelector(".yt-preview-title");
    const channelEl = this.metadataContainer.querySelector(".yt-preview-channel");
    if (titleEl) {
      titleEl.textContent = meta.title;
      titleEl.style.fontWeight = "600";
      titleEl.style.marginBottom = "4px";
    }
    if (channelEl) {
      channelEl.textContent = meta.author;
      channelEl.style.color = "var(--text-muted)";
      channelEl.style.fontSize = "0.85rem";
    }
    this.metadataContainer.style.display = "block";
  }
  clearPreview() {
    if (this.thumbnailEl) {
      this.thumbnailEl.src = "";
      this.thumbnailEl.style.display = "none";
    }
    if (this.metadataContainer) {
      const titleEl = this.metadataContainer.querySelector(".yt-preview-title");
      const channelEl = this.metadataContainer.querySelector(".yt-preview-channel");
      if (titleEl)
        titleEl.textContent = "";
      if (channelEl)
        channelEl.textContent = "";
      this.metadataContainer.style.display = "none";
    }
  }
};

// src/components/settings/settings-tab.ts
var import_obsidian5 = require("obsidian");

// src/services/secure-config.ts
var SecureConfigService = class {
  constructor(settings) {
    this.settings = settings;
  }
  /**
   * Get API key with environment variable fallback
   */
  getApiKey(keyType) {
    if (this.settings.useEnvironmentVariables) {
      return this.getFromEnvironment(keyType);
    }
    return keyType === "gemini" ? this.settings.geminiApiKey : this.settings.groqApiKey;
  }
  /**
   * Get API key from environment variables
   */
  getFromEnvironment(keyType) {
    const prefix = this.settings.environmentPrefix || "YTC";
    const envVarName = `${prefix}_${keyType.toUpperCase()}_API_KEY`;
    return this.getSecureEnvVar(envVarName) || "";
  }
  /**
   * Secure environment variable access
   * Note: In Obsidian plugins, environment variables are limited
   * This method can be extended for server-side environments
   */
  getSecureEnvVar(varName) {
    if (typeof process !== "undefined" && process.env) {
      return process.env[varName];
    }
    return this.getFromSecureStorage(varName);
  }
  /**
   * Get from secure storage (implementation depends on environment)
   */
  getFromSecureStorage(varName) {
    return void 0;
  }
  /**
   * Validate configuration security
   */
  validateSecurityConfiguration() {
    const warnings = [];
    let isSecure = true;
    if (!this.settings.useEnvironmentVariables) {
      if (this.settings.geminiApiKey && this.settings.geminiApiKey.length > 0) {
        warnings.push("Gemini API key is stored directly in configuration. Consider using environment variables.");
        isSecure = false;
      }
      if (this.settings.groqApiKey && this.settings.groqApiKey.length > 0) {
        warnings.push("Groq API key is stored directly in configuration. Consider using environment variables.");
        isSecure = false;
      }
    }
    if (this.settings.geminiApiKey === "your-api-key-here" || this.settings.groqApiKey === "your-api-key-here") {
      warnings.push("Default placeholder API keys detected. Please set real API keys.");
      isSecure = false;
    }
    return { isSecure, warnings };
  }
  /**
   * Get configuration template for environment variables
   */
  getEnvironmentTemplate() {
    const prefix = this.settings.environmentPrefix || "YTC";
    return `# YouTubeClipper Environment Variables
# Set these in your environment for secure API key management

# Google Gemini API Key
${prefix}_GEMINI_API_KEY=your_gemini_api_key_here

# Groq API Key  
${prefix}_GROQ_API_KEY=your_groq_api_key_here

# Usage:
# 1. Set these variables in your shell profile (.bashrc, .zshrc, etc.)
# 2. Enable "Use Environment Variables" in plugin settings
# 3. Restart Obsidian to pick up the new environment variables
`;
  }
};

// src/constants/performance.ts
var PERFORMANCE_PRESETS = {
  fast: {
    name: "Fast",
    description: "Maximum speed with optimized models and parallel processing. Best for quick summaries.",
    timeouts: {
      geminiTimeout: 15e3,
      groqTimeout: 1e4,
      metadataTimeout: 5e3
    },
    enableParallel: true,
    preferMultimodal: false,
    modelStrategy: {
      briefFormat: "llama-3.1-8b-instant",
      executiveSummary: "llama-3.3-70b-versatile",
      detailedGuide: "gemini-2.0-flash-lite",
      fallbackModel: "llama-3.1-8b-instant"
    }
  },
  balanced: {
    name: "Balanced",
    description: "Balanced speed and quality with multimodal analysis for detailed content.",
    timeouts: {
      geminiTimeout: 3e4,
      groqTimeout: 2e4,
      metadataTimeout: 1e4
    },
    enableParallel: true,
    preferMultimodal: true,
    modelStrategy: {
      briefFormat: "llama-3.1-8b-instant",
      executiveSummary: "gemini-2.0-flash-lite",
      detailedGuide: "gemini-2.5-flash",
      fallbackModel: "llama-3.3-70b-versatile"
    }
  },
  quality: {
    name: "Quality",
    description: "Maximum quality with comprehensive multimodal analysis. Slower but most detailed.",
    timeouts: {
      geminiTimeout: 6e4,
      groqTimeout: 3e4,
      metadataTimeout: 15e3
    },
    enableParallel: false,
    preferMultimodal: true,
    modelStrategy: {
      briefFormat: "gemini-2.0-flash-lite",
      executiveSummary: "gemini-2.5-flash",
      detailedGuide: "gemini-2.5-pro",
      fallbackModel: "gemini-2.0-flash"
    }
  }
};
var MODEL_CHARACTERISTICS = {
  // Groq Models (Speed optimized)
  "llama-3.1-8b-instant": {
    speed: "fast",
    quality: "basic",
    multimodal: false,
    provider: "Groq",
    estimatedLatency: 2,
    maxTokens: 2e3
  },
  "llama-3.3-70b-versatile": {
    speed: "fast",
    quality: "good",
    multimodal: false,
    provider: "Groq",
    estimatedLatency: 5,
    maxTokens: 4e3
  },
  "llama-4-maverick-17b-128e-instruct": {
    speed: "fast",
    quality: "excellent",
    multimodal: false,
    provider: "Groq",
    estimatedLatency: 8,
    maxTokens: 4e3
  },
  "llama-4-scout-17b-16e-instruct": {
    speed: "fast",
    quality: "good",
    multimodal: false,
    provider: "Groq",
    estimatedLatency: 6,
    maxTokens: 4e3
  },
  // Gemini Flash Models (Balanced)
  "gemini-2.0-flash": {
    speed: "medium",
    quality: "good",
    multimodal: true,
    provider: "Google Gemini",
    estimatedLatency: 10,
    maxTokens: 4e3
  },
  "gemini-2.0-flash-lite": {
    speed: "fast",
    quality: "good",
    multimodal: true,
    provider: "Google Gemini",
    estimatedLatency: 6,
    maxTokens: 3e3
  },
  "gemini-2.5-flash": {
    speed: "medium",
    quality: "excellent",
    multimodal: true,
    provider: "Google Gemini",
    estimatedLatency: 12,
    maxTokens: 4e3
  },
  "gemini-2.5-flash-lite": {
    speed: "fast",
    quality: "good",
    multimodal: true,
    provider: "Google Gemini",
    estimatedLatency: 8,
    maxTokens: 3e3
  },
  // Gemini Pro Models (Quality optimized)
  "gemini-1.5-pro": {
    speed: "slow",
    quality: "excellent",
    multimodal: true,
    provider: "Google Gemini",
    estimatedLatency: 20,
    maxTokens: 4e3
  },
  "gemini-2.0-pro": {
    speed: "slow",
    quality: "excellent",
    multimodal: true,
    provider: "Google Gemini",
    estimatedLatency: 25,
    maxTokens: 4e3
  },
  "gemini-2.5-pro": {
    speed: "slow",
    quality: "excellent",
    multimodal: true,
    provider: "Google Gemini",
    estimatedLatency: 30,
    maxTokens: 4e3
  },
  "gemini-2.5-pro-tts": {
    speed: "slow",
    quality: "excellent",
    multimodal: true,
    provider: "Google Gemini",
    estimatedLatency: 35,
    maxTokens: 4e3
  }
};
var PerformanceOptimizer = class {
  static getOptimalModel(format, videoDuration, performanceMode = "balanced", availableModels = []) {
    const preset = PERFORMANCE_PRESETS[performanceMode] || PERFORMANCE_PRESETS.balanced;
    const strategy = preset.modelStrategy;
    let selectedModel = strategy.fallbackModel;
    switch (format) {
      case "brief":
        selectedModel = strategy.briefFormat;
        break;
      case "executive-summary":
        selectedModel = strategy.executiveSummary;
        break;
      case "detailed-guide":
        selectedModel = strategy.detailedGuide;
        break;
    }
    if (videoDuration && videoDuration < 300 && performanceMode === "fast") {
      return "llama-3.1-8b-instant";
    }
    if (availableModels.includes(selectedModel)) {
      return selectedModel;
    }
    const characteristics = MODEL_CHARACTERISTICS[selectedModel];
    if (characteristics) {
      const alternatives = availableModels.filter((model) => {
        const alt = MODEL_CHARACTERISTICS[model];
        return alt && alt.provider === characteristics.provider && alt.multimodal === characteristics.multimodal;
      });
      if (alternatives.length > 0) {
        return alternatives.sort(
          (a, b) => MODEL_CHARACTERISTICS[a].estimatedLatency - MODEL_CHARACTERISTICS[b].estimatedLatency
        )[0];
      }
    }
    return strategy.fallbackModel;
  }
  static estimateProcessingTime(model, videoDuration, format = "detailed-guide") {
    const characteristics = MODEL_CHARACTERISTICS[model];
    if (!characteristics) {
      return { min: 15, max: 60, description: "Unknown model" };
    }
    let baseTime = characteristics.estimatedLatency;
    if (videoDuration) {
      baseTime += Math.min(videoDuration / 60, 30);
    }
    const formatMultipliers = {
      "brief": 0.5,
      "executive-summary": 0.8,
      "detailed-guide": 1.2,
      "custom": 1
    };
    const adjustedTime = baseTime * (formatMultipliers[format] || 1);
    const min = Math.round(adjustedTime * 0.8);
    const max = Math.round(adjustedTime * 1.5);
    const speed = characteristics.speed;
    const description = speed === "fast" ? "Fast processing" : speed === "medium" ? "Standard processing" : "Comprehensive processing";
    return { min, max, description };
  }
  static getPerformanceRecommendations(currentMode, videoDuration, format = "detailed-guide") {
    if (!videoDuration || videoDuration < 180) {
      return {
        recommended: "fast",
        reason: "Short videos don't require extensive analysis",
        alternative: "balanced"
      };
    }
    if (format === "brief") {
      return {
        recommended: "fast",
        reason: "Brief format prioritizes speed over depth",
        alternative: "balanced"
      };
    }
    if (videoDuration > 1800) {
      return {
        recommended: "quality",
        reason: "Long videos benefit from comprehensive analysis",
        alternative: "balanced"
      };
    }
    return {
      recommended: "balanced",
      reason: "Good balance of speed and quality for most content",
      alternative: currentMode === "balanced" ? "fast" : "balanced"
    };
  }
};

// src/components/settings/settings-tab.ts
var SETTINGS_CSS_CLASSES = {
  container: "ytc-settings-container",
  section: "ytc-settings-section",
  header: "ytc-settings-header",
  validation: "ytc-settings-validation"
};
var YouTubeSettingsTab = class extends import_obsidian5.PluginSettingTab {
  constructor(app, options) {
    super(app, options.plugin);
    this.options = options;
    this.validationErrors = [];
    this.settings = { ...options.plugin.settings };
    this.secureConfig = new SecureConfigService(this.settings);
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.addClass(SETTINGS_CSS_CLASSES.container);
    containerEl.setAttribute("data-plugin", "youtube-clipper");
    this.createHeader();
    this.createAPISettings();
    this.createPerformanceSettings();
    this.createSecuritySettings();
    this.createFileSettings();
    this.createValidationStatus();
    this.createUsageInstructions();
  }
  /**
   * Create header with version information
   */
  createHeader() {
    const headerEl = this.containerEl.createDiv(SETTINGS_CSS_CLASSES.header);
    headerEl.createEl("h2", { text: "YouTubeClipper Settings" });
    const versionEl = headerEl.createDiv("ytc-version-info");
    versionEl.createEl("span", {
      text: "v1.2.0 - Production Ready",
      cls: "ytc-version-badge"
    });
    const statusEl = headerEl.createDiv("ytc-status-info");
    const hasValidConfig = this.validateConfiguration();
    statusEl.createEl("span", {
      text: hasValidConfig ? "\u2705 Ready to use" : "\u26A0\uFE0F Configuration needed",
      cls: hasValidConfig ? "ytc-status-good" : "ytc-status-warning"
    });
    const docsEl = headerEl.createDiv("ytc-docs-link");
    docsEl.createEl("a", {
      text: "\u{1F4D6} View Documentation",
      href: "#",
      cls: "ytc-docs-button"
    }).addEventListener("click", (e) => {
      e.preventDefault();
      this.showDocumentation();
    });
  }
  /**
   * Validate entire configuration
   */
  validateConfiguration() {
    var _a, _b;
    const hasApiKey = ((_a = this.settings.geminiApiKey) == null ? void 0 : _a.trim()) || ((_b = this.settings.groqApiKey) == null ? void 0 : _b.trim());
    const hasValidPath = ValidationUtils.isValidPath(this.settings.outputPath);
    return Boolean(hasApiKey && hasValidPath);
  }
  /**
   * Show inline documentation
   */
  showDocumentation() {
    window.open("https://github.com/youtube-clipper/obsidian-plugin#readme", "_blank");
  }
  /**
  * Create API configuration settings
  */
  createAPISettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "API Configuration" });
    const securityNotice = containerEl.createDiv("ytc-security-notice");
    securityNotice.style.padding = "12px";
    securityNotice.style.marginBottom = "16px";
    securityNotice.style.backgroundColor = "var(--background-modifier-hover)";
    securityNotice.style.borderLeft = "4px solid var(--text-accent)";
    securityNotice.style.borderRadius = "4px";
    const noticeTitle = securityNotice.createEl("strong");
    noticeTitle.textContent = "\u{1F512} Security Notice: ";
    const noticeText = securityNotice.createEl("span");
    noticeText.textContent = "API keys are encrypted and stored securely by Obsidian. Never share your keys or commit them to version control.";
    noticeText.style.display = "block";
    noticeText.style.marginTop = "4px";
    noticeText.style.fontSize = "0.9em";
    noticeText.style.color = "var(--text-muted)";
    const geminiSetting = new import_obsidian5.Setting(containerEl).setName("Gemini API Key").setDesc("Your Google Gemini API key for content processing (password field - secured)").addText((text) => {
      const inputEl = text.setPlaceholder("sk-... (your key is encrypted)").setValue(this.settings.geminiApiKey || "").onChange(async (value) => {
        await this.updateSetting("geminiApiKey", value);
      }).inputEl;
      inputEl.type = "password";
      inputEl.style.fontFamily = "monospace";
      inputEl.style.letterSpacing = "0.1em";
      return text;
    });
    this.addKeyToggle(geminiSetting, this.settings.geminiApiKey);
    this.addKeyClearButton(geminiSetting, "geminiApiKey");
    const groqSetting = new import_obsidian5.Setting(containerEl).setName("Groq API Key").setDesc("Your Groq API key for fallback processing (password field - secured)").addText((text) => {
      const inputEl = text.setPlaceholder("gsk_... (your key is encrypted)").setValue(this.settings.groqApiKey || "").onChange(async (value) => {
        await this.updateSetting("groqApiKey", value);
      }).inputEl;
      inputEl.type = "password";
      inputEl.style.fontFamily = "monospace";
      inputEl.style.letterSpacing = "0.1em";
      return text;
    });
    this.addKeyToggle(groqSetting, this.settings.groqApiKey);
    this.addKeyClearButton(groqSetting, "groqApiKey");
    const testSection = containerEl.createDiv("ytc-test-connection");
    testSection.style.marginTop = "16px";
    testSection.style.paddingTop = "12px";
    testSection.style.borderTop = "1px solid var(--background-modifier-border)";
    new import_obsidian5.Setting(testSection).setName("Test API Connection").setDesc("Verify your API keys are valid").addButton((btn) => btn.setButtonText("Test Keys").onClick(async () => {
      btn.setDisabled(true);
      btn.setButtonText("Testing...");
      try {
        await this.testAPIKeys();
        btn.setButtonText("\u2713 Success!");
        setTimeout(() => {
          btn.setButtonText("Test Keys");
          btn.setDisabled(false);
        }, 2e3);
      } catch (error) {
        btn.setButtonText("\u2717 Failed");
        ErrorHandler.handle(error, "API key test failed", true);
        setTimeout(() => {
          btn.setButtonText("Test Keys");
          btn.setDisabled(false);
        }, 2e3);
      }
    }));
  }
  /**
   * Add show/hide toggle for sensitive API keys
   */
  addKeyToggle(setting, keyValue) {
    const toggleBtn = setting.addButton((btn) => btn.setButtonText("\u{1F441}\uFE0F Show").setTooltip("Toggle key visibility").onClick((e) => {
      const inputs = setting.settingEl.querySelectorAll('input[type="password"], input[type="text"]');
      if (inputs.length === 0)
        return;
      const input = inputs[0];
      const isPassword = input.type === "password";
      input.type = isPassword ? "text" : "password";
      btn.setButtonText(isPassword ? "\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F Hide" : "\u{1F441}\uFE0F Show");
    }));
  }
  /**
   * Add clear button to remove API key
   */
  addKeyClearButton(setting, settingKey) {
    const clearBtn = setting.addButton((btn) => btn.setButtonText("\u{1F5D1}\uFE0F Clear").setTooltip("Remove this API key").onClick(async () => {
      const keyName = settingKey === "geminiApiKey" ? "Gemini" : "Groq";
      if (confirm(`Are you sure you want to clear the ${keyName} API key?`)) {
        await this.updateSetting(settingKey, "");
        this.display();
      }
    }));
  }
  /**
   * Test API keys for validity
   */
  async testAPIKeys() {
    const errors = [];
    if (this.settings.geminiApiKey) {
      try {
        const response = await fetch(
          "https://generativelanguage.googleapis.com/v1beta/models?key=" + this.settings.geminiApiKey
        );
        if (!response.ok) {
          errors.push(`Gemini API key invalid (${response.status})`);
        }
      } catch (error) {
        errors.push("Gemini API key test failed (network error)");
      }
    } else {
      errors.push("Gemini API key not configured");
    }
    if (errors.length > 0) {
      throw new Error(errors.join("\n"));
    }
  }
  /**
   * Create performance and speed settings
   */
  createPerformanceSettings() {
    var _a, _b;
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "Performance & Speed" });
    const currentMode = this.settings.performanceMode || "balanced";
    const preset = PERFORMANCE_PRESETS[currentMode];
    new import_obsidian5.Setting(containerEl).setName("Performance Mode").setDesc(`Current: ${preset.name} - ${preset.description}`).addDropdown((dropdown) => dropdown.addOption("fast", "\u26A1 Fast - Maximum speed").addOption("balanced", "\u2696\uFE0F Balanced - Speed & Quality").addOption("quality", "\u{1F3AF} Quality - Maximum analysis").setValue(currentMode).onChange(async (value) => {
      await this.updateSetting("performanceMode", value);
      this.display();
    }));
    new import_obsidian5.Setting(containerEl).setName("Parallel Processing").setDesc("Race multiple AI providers simultaneously for faster responses").addToggle((toggle) => toggle.setValue(this.settings.enableParallelProcessing).onChange(async (value) => {
      await this.updateSetting("enableParallelProcessing", value);
    }));
    new import_obsidian5.Setting(containerEl).setName("Multimodal Analysis").setDesc("Use video-aware models that can analyze both audio and visual content").addToggle((toggle) => toggle.setValue(this.settings.preferMultimodal).onChange(async (value) => {
      await this.updateSetting("preferMultimodal", value);
    }));
    const statusEl = containerEl.createDiv();
    statusEl.createEl("h4", { text: "Current Configuration" });
    const statusListEl = statusEl.createEl("ul");
    const statusItems = [
      `Mode: ${preset.name}`,
      `Parallel Processing: ${this.settings.enableParallelProcessing ? "Enabled" : "Disabled"}`,
      `Multimodal: ${this.settings.preferMultimodal ? "Preferred" : "Standard"}`,
      `Gemini Timeout: ${((_a = this.settings.customTimeouts) == null ? void 0 : _a.geminiTimeout) || preset.timeouts.geminiTimeout}ms`,
      `Groq Timeout: ${((_b = this.settings.customTimeouts) == null ? void 0 : _b.groqTimeout) || preset.timeouts.groqTimeout}ms`
    ];
    statusItems.forEach((item) => {
      const li = statusListEl.createEl("li");
      li.textContent = item;
    });
    const recommendations = PerformanceOptimizer.getPerformanceRecommendations(
      this.settings.performanceMode,
      void 0,
      // video duration not available in settings
      "detailed-guide"
      // default format
    );
    const recEl = containerEl.createDiv();
    recEl.createEl("h4", { text: "Recommendations" });
    const recTextEl = recEl.createEl("p");
    recTextEl.textContent = recommendations.reason;
    recTextEl.style.fontStyle = "italic";
    recTextEl.style.color = "var(--text-muted)";
  }
  /**
   * Create security configuration settings
   */
  createSecuritySettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "Security Configuration" });
    new import_obsidian5.Setting(containerEl).setName("Use Environment Variables").setDesc("Load API keys from environment variables instead of storing them in configuration").addToggle((toggle) => toggle.setValue(this.settings.useEnvironmentVariables || false).onChange(async (value) => {
      await this.updateSetting("useEnvironmentVariables", value);
      this.display();
    }));
    if (this.settings.useEnvironmentVariables) {
      new import_obsidian5.Setting(containerEl).setName("Environment Variable Prefix").setDesc("Prefix for environment variable names (e.g., YTC_GEMINI_API_KEY)").addText((text) => text.setPlaceholder("YTC").setValue(this.settings.environmentPrefix || "YTC").onChange(async (value) => {
        await this.updateSetting("environmentPrefix", value || "YTC");
      }));
      const envTemplate = this.secureConfig.getEnvironmentTemplate();
      const envSection = containerEl.createDiv("ytc-env-template");
      envSection.createEl("h4", { text: "Environment Variables Template" });
      envSection.createEl("p", {
        text: "Copy these environment variables to your shell profile:",
        cls: "setting-item-description"
      });
      const preEl = envSection.createEl("pre");
      preEl.createEl("code", { text: envTemplate });
      new import_obsidian5.Setting(envSection).setName("Copy Template").setDesc("Copy the environment variables template to clipboard").addButton((button) => button.setButtonText("Copy to Clipboard").onClick(() => {
        navigator.clipboard.writeText(envTemplate);
        button.setButtonText("Copied!");
        setTimeout(() => button.setButtonText("Copy to Clipboard"), 2e3);
      }));
    }
    const validation = this.secureConfig.validateSecurityConfiguration();
    if (!validation.isSecure) {
      const warningEl = containerEl.createDiv("ytc-security-warnings");
      warningEl.createEl("h4", { text: "\u26A0\uFE0F Security Warnings", cls: "ytc-warning-header" });
      validation.warnings.forEach((warning) => {
        warningEl.createEl("p", { text: warning, cls: "ytc-warning-text" });
      });
    }
  }
  /**
   * Create file configuration settings
   */
  createFileSettings() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "File Configuration" });
    new import_obsidian5.Setting(containerEl).setName("Output Path").setDesc("Directory path where processed videos will be saved (relative to vault root)").addText((text) => text.setPlaceholder(MESSAGES.PLACEHOLDERS.OUTPUT_PATH).setValue(this.settings.outputPath).onChange(async (value) => {
      await this.updateSetting("outputPath", value);
    }));
  }
  /**
   * Create validation status display
   */
  createValidationStatus() {
    const { containerEl } = this;
    if (this.validationErrors.length > 0) {
      const errorSection = containerEl.createDiv();
      errorSection.style.marginTop = "20px";
      errorSection.style.padding = "10px";
      errorSection.style.backgroundColor = "var(--background-modifier-error)";
      errorSection.style.borderRadius = "4px";
      errorSection.createEl("h4", {
        text: "\u26A0\uFE0F Configuration Issues",
        attr: { style: "color: var(--text-error); margin-top: 0;" }
      });
      const errorList = errorSection.createEl("ul");
      this.validationErrors.forEach((error) => {
        errorList.createEl("li", { text: error });
      });
    } else {
      const successSection = containerEl.createDiv();
      successSection.style.marginTop = "20px";
      successSection.style.padding = "10px";
      successSection.style.backgroundColor = "var(--background-modifier-success)";
      successSection.style.borderRadius = "4px";
      successSection.createEl("h4", {
        text: "\u2705 Configuration Valid",
        attr: { style: "color: var(--text-success); margin-top: 0;" }
      });
    }
  }
  /**
   * Create usage instructions
   */
  createUsageInstructions() {
    const { containerEl } = this;
    containerEl.createEl("h3", { text: "Usage Instructions" });
    const instructions = containerEl.createDiv();
    instructions.innerHTML = `
            <p><strong>How to use:</strong></p>
            <ol>
                <li>Set your Gemini or Groq API key above</li>
                <li>Configure your preferred output directory</li>
                <li>Click the video icon in the ribbon or use the command palette</li>
                <li>Paste a YouTube URL and click Process</li>
                <li>The plugin will analyze the video and create a structured note</li>
            </ol>
            
            <p><strong>API Key Information:</strong></p>
            <ul>
                <li><strong>Gemini API:</strong> Get your key from <a href="https://aistudio.google.com/app/apikey">Google AI Studio</a></li>
                <li><strong>Groq API:</strong> Get your key from <a href="https://console.groq.com/keys">Groq Console</a></li>
                <li>At least one API key is required for the plugin to function</li>
            </ul>
            
            <p><strong>Note:</strong> This plugin requires an active internet connection and a valid API key.</p>
            <p><strong>Limitations:</strong> Due to CORS restrictions, full transcript extraction may be limited. The plugin works with available metadata and descriptions.</p>
        `;
  }
  /**
   * Update a setting value
   */
  async updateSetting(key, value) {
    try {
      this.settings[key] = value;
      await this.validateAndSaveSettings();
    } catch (error) {
      ErrorHandler.handle(error, `Settings update for ${key}`);
    }
  }
  /**
   * Validate and save settings
   */
  async validateAndSaveSettings() {
    const validation = ValidationUtils.validateSettings(this.settings);
    this.validationErrors = validation.errors;
    if (validation.isValid) {
      await this.options.onSettingsChange(this.settings);
    }
    this.display();
  }
  /**
   * Get current settings
   */
  getSettings() {
    return { ...this.settings };
  }
  /**
   * Update settings from external source
   */
  updateSettings(newSettings) {
    this.settings = { ...newSettings };
    this.display();
  }
};

// src/services/ai/ai-service.ts
init_api();
var AIService = class {
  constructor(providers, settings) {
    this.providers = [];
    if (!providers || providers.length === 0) {
      throw new Error(MESSAGES.ERRORS.MISSING_API_KEYS);
    }
    this.providers = providers;
    this.settings = settings;
    this.applyPerformanceSettings();
  }
  /**
   * Apply performance settings to providers
   */
  applyPerformanceSettings() {
    const preset = PERFORMANCE_PRESETS[this.settings.performanceMode] || PERFORMANCE_PRESETS.balanced;
    const timeouts = this.settings.customTimeouts || preset.timeouts;
    this.providers.forEach((provider) => {
      if (provider.name === "Google Gemini") {
        provider.setTimeout(timeouts.geminiTimeout);
      } else if (provider.name === "Groq") {
        provider.setTimeout(timeouts.groqTimeout);
      }
    });
  }
  /**
   * Update settings and reapply performance configurations
   */
  updateSettings(newSettings) {
    this.settings = newSettings;
    this.applyPerformanceSettings();
  }
  /**
   * Return available model options for a provider name (from constants mapping)
   */
  getProviderModels(providerName) {
    const raw = PROVIDER_MODEL_OPTIONS[providerName] || [];
    return raw.map((r) => typeof r === "string" ? r : r && r.name ? r.name : String(r));
  }
  /**
   * Best-effort fetch of latest models for all providers by scraping known provider pages.
   * Returns a mapping providerName -> list of discovered models. Falls back to static mapping.
   */
  async fetchLatestModels() {
    const result = {};
    const providers = this.getProviderNames();
    for (const p of providers) {
      try {
        const models = await this.fetchLatestModelsForProvider(p);
        result[p] = models.length > 0 ? models : PROVIDER_MODEL_OPTIONS[p] ? PROVIDER_MODEL_OPTIONS[p].map((m) => typeof m === "string" ? m : m.name) : [];
      } catch (error) {
        result[p] = PROVIDER_MODEL_OPTIONS[p] ? PROVIDER_MODEL_OPTIONS[p].map((m) => typeof m === "string" ? m : m.name) : [];
      }
    }
    return result;
  }
  /**
   * Fetch latest models for a single provider (best-effort scraping).
   */
  async fetchLatestModelsForProvider(providerName) {
    const url = PROVIDER_MODEL_LIST_URLS[providerName];
    const regex = PROVIDER_MODEL_REGEX[providerName];
    if (!url || !regex) {
      return PROVIDER_MODEL_OPTIONS[providerName] ? PROVIDER_MODEL_OPTIONS[providerName].map((m) => typeof m === "string" ? m : m.name) : [];
    }
    try {
      const resp = await fetch(url, { method: "GET" });
      if (!resp.ok) {
        return PROVIDER_MODEL_OPTIONS[providerName] ? PROVIDER_MODEL_OPTIONS[providerName].map((m) => typeof m === "string" ? m : m.name) : [];
      }
      const text = await resp.text();
      const matches = text.match(regex) || [];
      const normalized = Array.from(new Set(matches.map((m) => m.toLowerCase())));
      return normalized;
    } catch (error) {
      return PROVIDER_MODEL_OPTIONS[providerName] ? PROVIDER_MODEL_OPTIONS[providerName].map((m) => typeof m === "string" ? m : m.name) : [];
    }
  }
  /**
   * Process prompt with fallback support (original sequential method)
   */
  async process(prompt) {
    if (!prompt || typeof prompt !== "string") {
      throw new Error("Valid prompt is required");
    }
    if (this.settings.enableParallelProcessing) {
      return this.processParallel(prompt);
    }
    return this.processSequential(prompt);
  }
  /**
   * Process prompt with sequential fallback (original method)
   */
  async processSequential(prompt) {
    let lastError = null;
    for (const provider of this.providers) {
      try {
        console.log(`Attempting to process with ${provider.name}...`);
        const content = await provider.process(prompt);
        if (content && content.trim().length > 0) {
          return {
            content,
            provider: provider.name,
            model: provider.model
          };
        } else {
          throw new Error("Empty response from AI provider");
        }
      } catch (error) {
        lastError = error;
        console.warn(`${provider.name} failed:`, error);
        if (provider === this.providers[this.providers.length - 1]) {
          break;
        }
      }
    }
    const errorMessage = lastError ? MESSAGES.ERRORS.AI_PROCESSING(lastError.message) : "All AI providers failed to process the request";
    throw new Error(errorMessage);
  }
  /**
   * Process prompt with parallel provider racing for maximum speed
   */
  async processParallel(prompt) {
    console.log("Starting parallel provider racing...");
    const providerPromises = this.providers.map(async (provider) => {
      try {
        const content = await provider.processWithTimeout(prompt);
        if (content && content.trim().length > 0) {
          return {
            content,
            provider: provider.name,
            model: provider.model,
            success: true,
            responseTime: Date.now()
          };
        } else {
          throw new Error("Empty response from AI provider");
        }
      } catch (error) {
        console.warn(`${provider.name} failed in parallel race:`, error);
        return {
          error: error.message,
          provider: provider.name,
          model: provider.model,
          success: false,
          responseTime: Date.now()
        };
      }
    });
    const results = await Promise.allSettled(providerPromises);
    for (const result of results) {
      if (result.status === "fulfilled" && result.value.success) {
        console.log(`Parallel winner: ${result.value.provider} (${Date.now() - result.value.responseTime}ms)`);
        return {
          content: result.value.content,
          provider: result.value.provider,
          model: result.value.model
        };
      }
    }
    const errors = results.filter((r) => r.status === "fulfilled" && !r.value.success).map((r) => r.value.error);
    const errorMessage = errors.length > 0 ? MESSAGES.ERRORS.AI_PROCESSING(errors.join("; ")) : "All AI providers failed to process the request";
    throw new Error(errorMessage);
  }
  /**
   * Process prompt using a specific provider name. Optionally override the model if supported.
   */
  async processWith(providerName, prompt, overrideModel) {
    const provider = this.providers.find((p) => p.name === providerName);
    if (!provider) {
      throw new Error(`AI provider not found: ${providerName}`);
    }
    try {
      if (overrideModel && typeof provider.setModel === "function") {
        provider.setModel(overrideModel);
      }
      const content = await provider.process(prompt);
      if (content && content.trim().length > 0) {
        return { content, provider: provider.name, model: provider.model };
      }
      throw new Error("Empty response from AI provider");
    } catch (error) {
      throw new Error(MESSAGES.ERRORS.AI_PROCESSING(error.message));
    }
  }
  /**
   * Check if any providers are available
   */
  hasAvailableProviders() {
    return this.providers.length > 0;
  }
  /**
   * Get list of available provider names
   */
  getProviderNames() {
    return this.providers.map((p) => p.name);
  }
  /**
   * Add a new provider
   */
  addProvider(provider) {
    this.providers.push(provider);
  }
  /**
   * Remove a provider by name
   */
  removeProvider(providerName) {
    const index = this.providers.findIndex((p) => p.name === providerName);
    if (index !== -1) {
      this.providers.splice(index, 1);
      return true;
    }
    return false;
  }
};

// src/services/ai/gemini.ts
init_api();

// src/services/ai/base.ts
var BaseAIProvider = class {
  constructor(apiKey, initialModel, timeout) {
    this.apiKey = apiKey;
    this._timeout = 3e4;
    if (!apiKey) {
      throw new Error("API key is required for AI provider");
    }
    this._model = initialModel || "";
    if (timeout) {
      this._timeout = timeout;
    }
  }
  // Default 30s timeout
  get model() {
    return this._model;
  }
  get timeout() {
    return this._timeout;
  }
  setModel(model) {
    this._model = model;
  }
  setTimeout(timeout) {
    this._timeout = timeout;
  }
  /**
   * Process with timeout support
   */
  async processWithTimeout(prompt, customTimeout) {
    const timeoutMs = customTimeout || this._timeout;
    const timeoutPromise = new Promise((_, reject) => {
      setTimeout(() => {
        reject(new Error(`${this.name} request timed out after ${timeoutMs}ms`));
      }, timeoutMs);
    });
    const processPromise = this.process(prompt);
    return Promise.race([processPromise, timeoutPromise]);
  }
  /**
   * Validate API response structure
   */
  validateResponse(response, requiredPath) {
    let current = response;
    for (const key of requiredPath) {
      if (!current || typeof current !== "object" || !(key in current)) {
        return false;
      }
      current = current[key];
    }
    return current !== null && current !== void 0;
  }
  /**
   * Handle API errors consistently
   */
  async handleAPIError(response) {
    return ErrorHandler.handleAPIError(response, this.name);
  }
};

// src/services/ai/gemini.ts
var GeminiProvider = class extends BaseAIProvider {
  constructor(apiKey, model, timeout) {
    super(apiKey, model || AI_MODELS.GEMINI, timeout);
    this.name = "Google Gemini";
  }
  async process(prompt) {
    const response = await fetch(`${API_ENDPOINTS.GEMINI}?key=${this.apiKey}`, {
      method: "POST",
      headers: this.createHeaders(),
      body: JSON.stringify(this.createRequestBody(prompt))
    });
    if (response.status === 401) {
      throw new Error(MESSAGES.ERRORS.GEMINI_INVALID_KEY);
    }
    if (!response.ok) {
      await this.handleAPIError(response);
    }
    const data = await response.json();
    if (!this.validateResponse(data, ["candidates", "0", "content", "parts", "0", "text"])) {
      throw new Error("Invalid response format from Gemini API");
    }
    return this.extractContent(data);
  }
  createHeaders() {
    return {
      "Content-Type": "application/json"
    };
  }
  createRequestBody(prompt) {
    const normalizedPrompt = prompt.toLowerCase();
    const isVideoAnalysis = normalizedPrompt.includes("youtube video") || normalizedPrompt.includes("youtu.be/") || normalizedPrompt.includes("youtube.com/");
    const baseConfig = {
      contents: [{
        parts: [{ text: prompt }]
      }],
      generationConfig: {
        temperature: 0.7,
        maxOutputTokens: 4e3,
        // Increased for detailed guides
        candidateCount: 1
      }
      // safetySettings: [
      //     {
      //         category: "HARM_CATEGORY_HARASSMENT",
      //         threshold: "BLOCK_MEDIUM_AND_ABOVE"
      //     },
      //     {
      //         category: "HARM_CATEGORY_HATE_SPEECH", 
      //         threshold: "BLOCK_MEDIUM_AND_ABOVE"
      //     }
      // ]
    };
    if (isVideoAnalysis) {
      const providerModels = PROVIDER_MODEL_OPTIONS["Google Gemini"] || [];
      const currentModelName = String(this.model || "").toLowerCase();
      const matched = providerModels.find((m) => {
        const name = typeof m === "string" ? m : m && m.name ? m.name : "";
        return String(name).toLowerCase() === currentModelName;
      });
      const supportsAudioVideo = matched && matched.supportsAudioVideo === true;
      const videoConfig = {
        ...baseConfig,
        systemInstruction: {
          parts: [{
            text: `You are an expert video content analyzer. Provide comprehensive, multimodal analysis using:
\u2022 AUDIO STREAM: Transcribe all spoken content, identify speakers, capture tone/emphasis/emotion
\u2022 VIDEO STREAM: Analyze visual elements, text overlays, diagrams, slides, gestures, scene changes, and visual demonstrations
\u2022 INTEGRATED INSIGHTS: Synthesize audio and visual data to provide complete understanding

For best results:
- Prioritize accuracy in transcription and speaker identification
- Extract and explain key concepts shown visually
- Note timing relationships between audio and visual elements
- Identify visual cues that reinforce or clarify spoken content`
          }]
        }
      };
      const gcsMatch = prompt.match(/(gs:\/\/[\w\-\.\/]+\.(?:mp4|mov|mkv|webm))/i);
      if (gcsMatch && gcsMatch[1]) {
        const gcsUri = gcsMatch[1];
        videoConfig.contents = videoConfig.contents || [];
        videoConfig.contents.push({
          parts: [{ fileData: { fileUri: gcsUri, mimeType: "video/mp4" } }]
        });
      }
      return videoConfig;
    }
    return baseConfig;
  }
  extractContent(response) {
    const content = response.candidates[0].content.parts[0].text;
    return content ? content.trim() : "";
  }
};

// src/services/ai/groq.ts
init_api();
var GroqProvider = class extends BaseAIProvider {
  constructor(apiKey, model, timeout) {
    super(apiKey, model || AI_MODELS.GROQ, timeout);
    this.name = "Groq";
  }
  async process(prompt) {
    const response = await fetch(API_ENDPOINTS.GROQ, {
      method: "POST",
      headers: this.createHeaders(),
      body: JSON.stringify(this.createRequestBody(prompt))
    });
    if (response.status === 404) {
      throw new Error(MESSAGES.ERRORS.GROQ_MODEL_NOT_FOUND);
    }
    if (!response.ok) {
      await this.handleAPIError(response);
    }
    const data = await response.json();
    if (!this.validateResponse(data, ["choices", "0", "message"])) {
      throw new Error("Invalid response format from Groq API");
    }
    return this.extractContent(data);
  }
  createHeaders() {
    return {
      "Content-Type": "application/json",
      "Authorization": `Bearer ${this.apiKey}`
    };
  }
  createRequestBody(prompt) {
    return {
      model: this.model,
      messages: [
        {
          role: "system",
          content: "You are an expert content analyzer specializing in extracting practical value and creating actionable guides from video content. Focus on clarity, practicality, and immediate implementability. Even with limited information, provide maximum value through structured analysis and practical recommendations."
        },
        {
          role: "user",
          content: prompt
        }
      ],
      max_tokens: API_LIMITS.MAX_TOKENS,
      temperature: API_LIMITS.TEMPERATURE
    };
  }
  extractContent(response) {
    const content = response.choices[0].message.content;
    return content ? content.trim() : "";
  }
};

// src/services/youtube/video-data.ts
init_api();

// src/services/youtube/transcript-service.ts
init_api();
var YouTubeTranscriptService = class {
  // 1 hour
  constructor(cache) {
    this.cache = cache;
    this.transcriptTTL = 1e3 * 60 * 60;
  }
  /**
   * Extract transcript for a YouTube video
   */
  async getTranscript(videoId) {
    var _a, _b;
    if (!videoId) {
      throw new Error("Video ID is required");
    }
    const cacheKey = `transcript-${videoId}`;
    const cached = (_a = this.cache) == null ? void 0 : _a.get(cacheKey);
    if (cached) {
      return cached;
    }
    try {
      const transcript = await this.fetchTranscriptWithFallback(videoId);
      if (transcript) {
        (_b = this.cache) == null ? void 0 : _b.set(cacheKey, transcript, this.transcriptTTL);
        return transcript;
      }
      return null;
    } catch (error) {
      console.warn("Failed to fetch transcript:", error);
      return null;
    }
  }
  /**
   * Fetch transcript using multiple methods with fallback
   */
  async fetchTranscriptWithFallback(videoId) {
    try {
      const transcript = await this.fetchFromYouTubeAPI(videoId);
      if (transcript)
        return transcript;
    } catch (error) {
      console.debug("YouTube API method failed:", error);
    }
    try {
      const transcript = await this.scrapeTranscriptFromPage(videoId);
      if (transcript)
        return transcript;
    } catch (error) {
      console.debug("Page scraping method failed:", error);
    }
    try {
      const transcript = await this.fetchFromThirdParty(videoId);
      if (transcript)
        return transcript;
    } catch (error) {
      console.debug("Third-party method failed:", error);
    }
    return null;
  }
  /**
   * Method 1: Official YouTube transcript API
   */
  async fetchFromYouTubeAPI(videoId) {
    const url = `https://video.google.com/timedtext?lang=en&v=${videoId}`;
    const response = await fetch(url);
    if (!response.ok) {
      throw new Error(`Transcript API failed: ${response.status}`);
    }
    const xmlText = await response.text();
    return this.parseXMLTranscript(xmlText, videoId);
  }
  /**
   * Method 2: Scrape transcript from YouTube page
   */
  async scrapeTranscriptFromPage(videoId) {
    const videoUrl = `https://www.youtube.com/watch?v=${videoId}`;
    const proxyUrl = `${API_ENDPOINTS.CORS_PROXY}?url=${encodeURIComponent(videoUrl)}`;
    const response = await fetch(proxyUrl);
    if (!response.ok) {
      throw new Error("Failed to fetch video page");
    }
    const html = await response.text();
    const transcriptData = await this.extractTranscriptFromHTML(html);
    if (transcriptData) {
      return this.createTranscript(transcriptData, videoId, true);
    }
    return null;
  }
  /**
   * Method 3: Third-party transcript service (optional)
   */
  async fetchFromThirdParty(videoId) {
    return null;
  }
  /**
   * Parse XML transcript from YouTube API
   */
  parseXMLTranscript(xmlText, videoId) {
    const parser = new DOMParser();
    const xmlDoc = parser.parseFromString(xmlText, "text/xml");
    const textElements = xmlDoc.getElementsByTagName("text");
    const segments = [];
    let fullText = "";
    for (let i = 0; i < textElements.length; i++) {
      const element = textElements[i];
      const text = element.textContent || "";
      const start = parseFloat(element.getAttribute("start") || "0");
      const duration = parseFloat(element.getAttribute("dur") || "0");
      if (text.trim()) {
        segments.push({ text: text.trim(), start, duration });
        fullText += text.trim() + " ";
      }
    }
    return {
      segments,
      fullText: fullText.trim(),
      language: "en",
      autoGenerated: true
    };
  }
  /**
   * Extract transcript data from YouTube page HTML
   */
  async extractTranscriptFromHTML(html) {
    const transcriptRegex = /"captions":\s*{[^}]*"playerCaptionsTracklistRenderer":\s*{[^}]*"captionTracks":\s*\[([^\]]+)\]/;
    const match = html.match(transcriptRegex);
    if (!match || !match[1]) {
      return null;
    }
    try {
      const captionTracksJson = match[1];
      const captionTracks = JSON.parse(`[${captionTracksJson}]`);
      const englishTrack = captionTracks.find(
        (track) => {
          var _a;
          return track.languageCode === "en" || ((_a = track.languageCode) == null ? void 0 : _a.startsWith("en"));
        }
      );
      if (!englishTrack || !englishTrack.baseUrl) {
        return null;
      }
      return fetch(englishTrack.baseUrl).then((resp) => {
        if (!resp.ok)
          throw new Error("Failed to fetch caption track");
        return resp.text();
      }).then((xmlText) => this.parseXMLTranscript(xmlText, "").segments).catch((err) => {
        console.debug("Failed to fetch caption track:", err);
        return null;
      });
    } catch (error) {
      console.debug("Failed to parse transcript from HTML:", error);
      return null;
    }
  }
  /**
   * Create transcript object from segments
   */
  createTranscript(segments, videoId, autoGenerated = false) {
    if (!Array.isArray(segments)) {
      segments = [segments];
    }
    const normalizedSegments = segments.map((seg) => ({
      text: seg.text,
      start: seg.start,
      duration: seg.duration || 0
    }));
    const fullText = normalizedSegments.map((seg) => seg.text).join(" ").trim();
    return {
      segments: normalizedSegments,
      fullText,
      language: "en",
      autoGenerated
    };
  }
  /**
   * Get transcript summary for quick analysis
   */
  async getTranscriptSummary(videoId, maxLength = 2e3) {
    const transcript = await this.getTranscript(videoId);
    if (!transcript) {
      return null;
    }
    if (transcript.fullText.length <= maxLength) {
      return transcript.fullText;
    }
    const keySegments = transcript.segments.filter((seg) => seg.text.length > 20).slice(0, 10).map((seg) => seg.text).join(" ");
    return keySegments.length > maxLength ? keySegments.substring(0, maxLength) + "..." : keySegments;
  }
  /**
   * Extract key time-stamped moments from transcript
   */
  async extractKeyMoments(videoId, count = 5) {
    const transcript = await this.getTranscript(videoId);
    if (!transcript || transcript.segments.length === 0) {
      return null;
    }
    const meaningfulSegments = transcript.segments.filter((seg) => seg.text.length > 30);
    if (meaningfulSegments.length === 0) {
      return null;
    }
    const totalSegments = meaningfulSegments.length;
    const step = Math.max(1, Math.floor(totalSegments / count));
    const keyMoments = [];
    for (let i = 0; i < totalSegments && keyMoments.length < count; i += step) {
      const segment = meaningfulSegments[i];
      keyMoments.push({
        time: segment.start,
        text: segment.text
      });
    }
    return keyMoments;
  }
  /**
   * Check if transcript is available for a video
   */
  async isTranscriptAvailable(videoId) {
    const transcript = await this.getTranscript(videoId);
    return transcript !== null && transcript.segments.length > 0;
  }
};

// src/services/youtube/video-data.ts
var YouTubeVideoService = class {
  constructor(cache) {
    this.cache = cache;
    this.metadataTTL = 1e3 * 60 * 30;
    // 30 minutes
    this.descriptionTTL = 1e3 * 60 * 30;
    this.transcriptService = new YouTubeTranscriptService(cache);
  }
  /**
   * Extract video ID from YouTube URL
   */
  extractVideoId(url) {
    return ValidationUtils.extractVideoId(url);
  }
  /**
   * Get video metadata and description
   */
  async getVideoData(videoId) {
    var _a, _b;
    if (!videoId) {
      throw new Error("Video ID is required");
    }
    const cacheKey = this.getCacheKey("video-data", videoId);
    const cached = (_a = this.cache) == null ? void 0 : _a.get(cacheKey);
    if (cached) {
      return cached;
    }
    try {
      const metadata = await this.getVideoMetadata(videoId);
      const result = {
        title: metadata.title || "Unknown Title",
        description: metadata.description || "No description available",
        duration: metadata.duration,
        thumbnail: metadata.thumbnail,
        channelName: metadata.channelName
      };
      if (result.duration && result.duration < 1800) {
        this.checkTranscriptAvailability(videoId).then((hasTranscript) => {
          var _a2;
          result.hasTranscript = hasTranscript;
          (_a2 = this.cache) == null ? void 0 : _a2.set(cacheKey, result, this.metadataTTL);
        });
      }
      (_b = this.cache) == null ? void 0 : _b.set(cacheKey, result, this.metadataTTL);
      return result;
    } catch (error) {
      throw ErrorHandler.createUserFriendlyError(
        error,
        "fetch video data"
      );
    }
  }
  /**
   * Get video metadata using YouTube oEmbed API
   */
  async getVideoMetadata(videoId) {
    var _a, _b;
    const cacheKey = this.getCacheKey("metadata", videoId);
    const cached = (_a = this.cache) == null ? void 0 : _a.get(cacheKey);
    if (cached) {
      return cached;
    }
    const oembedUrl = `${API_ENDPOINTS.YOUTUBE_OEMBED}?url=https://www.youtube.com/watch?v=${videoId}&format=json`;
    try {
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), 1e4);
      const response = await fetch(oembedUrl, {
        headers: {
          "User-Agent": "Obsidian YoutubeClipper Plugin"
        },
        signal: controller.signal
      });
      clearTimeout(timeoutId);
      if (!response.ok) {
        if (response.status === 400) {
          throw new Error(`Invalid YouTube video ID: ${videoId}. Please check the URL and try again.`);
        } else if (response.status === 404) {
          throw new Error(`YouTube video not found: ${videoId}. The video may be private, deleted, or the ID is incorrect.`);
        } else if (response.status === 403) {
          throw new Error(`Access denied to YouTube video: ${videoId}. The video may be private or restricted.`);
        } else {
          throw new Error(MESSAGES.ERRORS.FETCH_VIDEO_DATA(response.status));
        }
      }
      const data = await response.json();
      let enhancedData = {
        title: data.title || "Unknown Title",
        thumbnail: data.thumbnail_url,
        author_name: data.author_name
      };
      try {
        const pageData = await this.scrapeAdditionalMetadata(videoId);
        enhancedData = { ...enhancedData, ...pageData };
      } catch (error) {
        console.debug("Could not scrape additional metadata:", error);
      }
      const metadata = {
        title: enhancedData.title,
        description: enhancedData.description,
        duration: enhancedData.duration,
        thumbnail: enhancedData.thumbnail,
        channelName: enhancedData.author_name
      };
      (_b = this.cache) == null ? void 0 : _b.set(cacheKey, metadata, this.metadataTTL);
      return metadata;
    } catch (error) {
      if (error instanceof DOMException && error.name === "AbortError") {
        throw new Error("Request timed out. Please check your internet connection and try again.");
      } else if (error instanceof TypeError) {
        throw new Error(MESSAGES.ERRORS.NETWORK_ERROR);
      } else if (error instanceof Error && error.message.includes("JSON")) {
        throw new Error("Failed to parse YouTube response. The service may be temporarily unavailable.");
      }
      throw error;
    }
  }
  /**
   * Scrape additional metadata from YouTube page
   */
  async scrapeAdditionalMetadata(videoId) {
    try {
      const html = await this.fetchVideoPageHTML(videoId);
      const durationMatch = html.match(/"lengthSeconds":"(\d+)"/);
      const duration = durationMatch ? parseInt(durationMatch[1]) : void 0;
      const descriptionMatch = html.match(/"shortDescription":"([^"]+)"/);
      const description = descriptionMatch ? descriptionMatch[1].replace(/\\u0026/g, "&").replace(/\\n/g, "\n") : void 0;
      return { description, duration };
    } catch (error) {
      return {};
    }
  }
  /**
   * Check if transcript is available for this video
   */
  async checkTranscriptAvailability(videoId) {
    try {
      return await this.transcriptService.isTranscriptAvailable(videoId);
    } catch (error) {
      return false;
    }
  }
  /**
   * Get video description by scraping the YouTube page
   */
  async getVideoDescription(videoId) {
    var _a, _b, _c;
    const cacheKey = this.getCacheKey("description", videoId);
    const cached = (_a = this.cache) == null ? void 0 : _a.get(cacheKey);
    if (cached) {
      return cached;
    }
    try {
      const html = await this.fetchVideoPageHTML(videoId);
      const description = this.extractDescriptionFromHTML(html);
      (_b = this.cache) == null ? void 0 : _b.set(cacheKey, description, this.descriptionTTL);
      return description;
    } catch (error) {
      console.warn("Failed to scrape video page:", error);
      const fallback = MESSAGES.WARNINGS.EXTRACTION_FAILED;
      (_c = this.cache) == null ? void 0 : _c.set(cacheKey, fallback, this.descriptionTTL);
      return fallback;
    }
  }
  /**
   * Fetch YouTube page HTML using CORS proxy
   */
  async fetchVideoPageHTML(videoId) {
    const videoUrl = `https://www.youtube.com/watch?v=${videoId}`;
    const proxyUrl = `${API_ENDPOINTS.CORS_PROXY}?url=${encodeURIComponent(videoUrl)}`;
    const response = await fetch(proxyUrl);
    if (!response.ok) {
      throw new Error(MESSAGES.WARNINGS.CORS_RESTRICTIONS);
    }
    return response.text();
  }
  /**
   * Extract description from YouTube page HTML
   */
  extractDescriptionFromHTML(html) {
    const patterns = [
      /"shortDescription":"([^"]*?)"/,
      /"description":{"simpleText":"([^"]*?)"}/,
      /<meta name="description" content="([^"]*?)">/,
      /<meta property="og:description" content="([^"]*?)">/
    ];
    for (const pattern of patterns) {
      const match = html.match(pattern);
      if (match && match[1]) {
        const cleanedText = ValidationUtils.cleanText(match[1]);
        return ValidationUtils.truncateText(cleanedText, API_LIMITS.DESCRIPTION_MAX_LENGTH);
      }
    }
    return MESSAGES.WARNINGS.AUTO_EXTRACTION;
  }
  /**
   * Validate YouTube URL and extract video ID
   */
  validateAndExtractVideoId(url) {
    if (!ValidationUtils.isValidYouTubeUrl(url)) {
      throw new Error(MESSAGES.ERRORS.INVALID_URL);
    }
    const videoId = this.extractVideoId(url);
    if (!videoId) {
      throw new Error(MESSAGES.ERRORS.INVALID_URL);
    }
    return videoId;
  }
  getCacheKey(namespace, videoId) {
    return `youtube-video-service:${namespace}:${videoId}`;
  }
};

// src/services/file/obsidian-file.ts
var import_obsidian6 = require("obsidian");
init_api();

// src/components/modals/file-conflict-modal.ts
init_base_modal();
var COPY_WARNING = "A note with this title already exists. Choose how to proceed.";
var FileConflictModal = class extends BaseModal {
  constructor(app, file) {
    super(app);
    this.file = file;
    this.decision = "cancel";
  }
  onOpen() {
    this.createHeader("Note Already Exists");
    this.createMessage(`${COPY_WARNING}

Existing note: ${this.file.path}`);
    this.createButtons();
  }
  openAndWait() {
    return new Promise((resolve) => {
      this.resolve = resolve;
      this.forceVisible();
      this.open();
    });
  }
  onClose() {
    if (this.resolve) {
      this.resolve(this.decision);
    }
    super.onClose();
  }
  createButtons() {
    const container = this.createButtonContainer();
    this.createButton(container, "Cancel", false, () => {
      this.closeWithDecision("cancel");
    });
    this.createButton(container, "Save as Numbered Copy", false, () => {
      this.closeWithDecision("new-name");
    });
    this.createButton(container, "Overwrite Existing", true, () => {
      this.closeWithDecision("overwrite");
    });
  }
  closeWithDecision(decision) {
    this.decision = decision;
    this.close();
  }
};

// src/services/file/obsidian-file.ts
var ObsidianFileService = class {
  constructor(app) {
    this.app = app;
  }
  /**
   * Save content to a file in the vault
   */
  async saveToFile(title, content, outputPath) {
    try {
      const filename = this.createSafeFilename(title);
      const normalizedBase = this.normalizePath(outputPath);
      await this.ensureDirectoryExists(normalizedBase);
      const dailyFolder = this.getDailyFolderPath(normalizedBase);
      await this.ensureDirectoryExists(dailyFolder);
      const filePath = `${dailyFolder}/${filename}`;
      const finalPath = await this.handleFileConflicts(filePath, content);
      return finalPath;
    } catch (error) {
      throw new Error(MESSAGES.ERRORS.SAVE_FILE(error.message));
    }
  }
  /**
   * Open a file with user confirmation
   */
  async openFileWithConfirmation(file) {
    await this.waitForFileCreation();
    try {
      const currentFile = this.app.vault.getAbstractFileByPath(file.path);
      if (!(currentFile instanceof import_obsidian6.TFile)) {
        throw new Error(MESSAGES.ERRORS.FILE_NOT_EXISTS);
      }
      const leaf = this.app.workspace.getLeaf(false);
      await leaf.openFile(currentFile);
    } catch (error) {
      throw new Error(MESSAGES.ERRORS.COULD_NOT_OPEN(error.message));
    }
  }
  /**
   * Create a safe filename from title
   */
  createSafeFilename(title) {
    const sanitized = ValidationUtils.sanitizeFilename(title);
    return `${sanitized}.md`;
  }
  /**
   * Ensure the output directory exists
   */
  async ensureDirectoryExists(outputPath) {
    try {
      await this.app.vault.createFolder(outputPath);
    } catch (error) {
    }
  }
  getDailyFolderPath(basePath) {
    const trimmedBase = basePath.replace(/\/+$/, "");
    const today = new Date().toISOString().split("T")[0];
    return `${trimmedBase}/${today}`;
  }
  /**
   * Handle file naming conflicts by adding timestamp
   */
  async handleFileConflicts(filePath, content) {
    const existingFile = this.app.vault.getAbstractFileByPath(filePath);
    if (existingFile instanceof import_obsidian6.TFile) {
      const decision = await this.promptConflictResolution(existingFile);
      switch (decision) {
        case "overwrite":
          await this.app.vault.modify(existingFile, content);
          return existingFile.path;
        case "new-name":
          return this.createVersionedCopy(existingFile.path, content);
        default:
          throw new Error("Save cancelled by user");
      }
    }
    await this.app.vault.create(filePath, content);
    return filePath;
  }
  /**
   * Wait for file creation to complete
   */
  async waitForFileCreation() {
    return new Promise(
      (resolve) => setTimeout(resolve, TIMEOUTS.FILE_CREATION_WAIT)
    );
  }
  /**
   * Get file by path with validation
   */
  getFileByPath(filePath) {
    const file = this.app.vault.getAbstractFileByPath(filePath);
    return file instanceof import_obsidian6.TFile ? file : null;
  }
  /**
   * Check if file exists at path
   */
  fileExists(filePath) {
    return this.getFileByPath(filePath) !== null;
  }
  /**
   * Create a file with unique naming
   */
  async createUniqueFile(basePath, content) {
    let counter = 1;
    let filePath = basePath;
    while (this.fileExists(filePath)) {
      const pathParts = basePath.split("/");
      const filename = pathParts.pop();
      const nameWithoutExt = filename.replace(".md", "");
      const newFilename = `${nameWithoutExt} (${counter}).md`;
      filePath = [...pathParts, newFilename].join("/");
      counter++;
    }
    await this.app.vault.create(filePath, content);
    return filePath;
  }
  async promptConflictResolution(file) {
    const modal = new FileConflictModal(this.app, file);
    const decision = await modal.openAndWait();
    return decision;
  }
  async createVersionedCopy(originalPath, content) {
    const pathParts = originalPath.split("/");
    const filename = pathParts.pop();
    const nameWithoutExt = filename.replace(".md", "");
    let counter = 1;
    let candidatePath;
    do {
      candidatePath = [...pathParts, `${nameWithoutExt} (${counter}).md`].join("/");
      counter++;
    } while (this.fileExists(candidatePath));
    await this.app.vault.create(candidatePath, content);
    return candidatePath;
  }
  normalizePath(path) {
    if (!path) {
      return "";
    }
    let normalized = path.trim();
    if (normalized.startsWith("./")) {
      normalized = normalized.slice(2);
    }
    while (normalized.startsWith("/")) {
      normalized = normalized.slice(1);
    }
    normalized = normalized.replace(/\/+/g, "/");
    return normalized;
  }
};

// src/services/prompt-service.ts
var _AIPromptService = class {
  /**
   * Create analysis prompt for YouTube video content with performance optimization
   */
  createAnalysisPrompt(videoData, videoUrl, format = "detailed-guide", customPrompt, performanceMode = "balanced") {
    if (customPrompt && customPrompt.trim()) {
      return this.applyCustomPrompt(customPrompt, videoData, videoUrl);
    }
    let baseTemplate;
    switch (performanceMode) {
      case "fast":
        baseTemplate = _AIPromptService.COMPACT_BASE_TEMPLATE;
        break;
      case "quality":
        baseTemplate = _AIPromptService.COMPREHENSIVE_BASE_TEMPLATE;
        break;
      default:
        baseTemplate = _AIPromptService.BALANCED_BASE_TEMPLATE;
    }
    const baseContent = baseTemplate.replace("{{TITLE}}", videoData.title).replace("{{URL}}", videoUrl).replace("{{DESCRIPTION}}", videoData.description);
    switch (format) {
      case "executive-summary":
        return this.createExecutiveSummaryPrompt(baseContent, videoUrl, performanceMode);
      case "brief":
        return this.createBriefPrompt(baseContent, videoUrl, performanceMode);
      case "detailed-guide":
      default:
        return this.createDetailedGuidePrompt(baseContent, videoUrl, performanceMode);
    }
  }
  /**
   * Apply custom prompt template with placeholder substitution
   */
  applyCustomPrompt(customPrompt, videoData, videoUrl) {
    const videoId = ValidationUtils.extractVideoId(videoUrl);
    const embedUrl = videoId ? `https://www.youtube-nocookie.com/embed/${videoId}` : videoUrl;
    return customPrompt.replace(/__VIDEO_TITLE__/g, videoData.title).replace(/__VIDEO_DESCRIPTION__/g, videoData.description).replace(/__VIDEO_URL__/g, videoUrl).replace(/__VIDEO_ID__/g, videoId || "unknown").replace(/__EMBED_URL__/g, embedUrl).replace(/__DATE__/g, new Date().toISOString().split("T")[0]).replace(/__TIMESTAMP__/g, new Date().toISOString());
  }
  /**
   * Create a brief prompt: short description plus resources list
   */
  createBriefPrompt(baseContent, videoUrl, performanceMode = "balanced") {
    const videoId = ValidationUtils.extractVideoId(videoUrl);
    const embedUrl = videoId ? `https://www.youtube-nocookie.com/embed/${videoId}` : videoUrl;
    return `${baseContent}

        OUTPUT FORMAT - BRIEF DESCRIPTION + RESOURCES:

        Use this EXACT template:

        ---
        title: {Video Title}
        source: ${videoUrl}
        created: "${new Date().toISOString().split("T")[0]}"
        modified: "${new Date().toISOString().split("T")[0]}"
        description: "One short paragraph (3-4 sentences) summarizing the video"
        type: youtube-note
        format: brief
        tags:
          - youtube
          - brief
        status: processed
        duration: "[Extract video duration]"
        channel: "[Extract channel name]"
        video_id: "${videoId || "unknown"}"
        processing_date: "${new Date().toISOString()}"
    ai_provider: "__AI_PROVIDER__"
    ai_model: "__AI_MODEL__"
        ---

        <iframe width="640" height="360" src="${embedUrl}" title="{Video Title}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

        ---

        ## Brief Description
        [Provide a concise 3-4 sentence description that captures the core message of the video]

        ## Resources
        - **Original Video:** [Watch on YouTube](${videoUrl})
        - **Channel:** [Creator's Channel](https://youtube.com/channel/[extract-channel-id])
        - **Top resources mentioned or related (links):**
          - [Resource 1]
          - [Resource 2]
          - [Resource 3]

        IMPORTANT: Keep the Brief Description short and focused. Provide 2-3 high-quality resource links that help the reader explore the topic further.`;
  }
  /**
   * Create executive summary prompt (250 words)
   */
  createExecutiveSummaryPrompt(baseContent, videoUrl, performanceMode = "balanced") {
    const videoId = ValidationUtils.extractVideoId(videoUrl);
    const embedUrl = videoId ? `https://www.youtube-nocookie.com/embed/${videoId}` : videoUrl;
    return `${baseContent}

        OUTPUT FORMAT - EXECUTIVE SUMMARY:
        
        Use this EXACT template:

        ---
        title: {Video Title}
        source: ${videoUrl}
        created: "${new Date().toISOString().split("T")[0]}"
        modified: "${new Date().toISOString().split("T")[0]}"
        description: "Single sentence capturing the core insight"
        type: youtube-note
        format: executive-summary
        tags:
          - youtube
          - executive-summary
          - tag_1
          - tag_2
          - tag_3
        status: processed
        duration: "[Extract video duration]"
        channel: "[Extract channel name]"
        video_id: "${videoId || "unknown"}"
        processing_date: "${new Date().toISOString()}"
        word_count: 250
    ai_provider: "__AI_PROVIDER__"
    ai_model: "__AI_MODEL__"
        ---

        <iframe width="640" height="360" src="${embedUrl}" title="{Video Title}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

        ---

        ## Key Insights
        - [Critical insight 1 with specific detail]
        - [Critical insight 2 with specific detail]
        - [Critical insight 3 with specific detail]

        ## Concise Summary
        [Provide a concise, cohesive summary in exactly two paragraphs, maximum 250 words total. Focus on the core value, main insights, and key actionable takeaways. Make every word count.]

        ## Resources
        - **Original Video:** [Watch on YouTube](${videoUrl})
        - **Channel:** [Creator's Channel](https://youtube.com/channel/[extract-channel-id])
        - **Key Tools/Frameworks:** [List main tools or frameworks mentioned]
        - **Official Documentation:** [Links to official docs for mentioned technologies]
        - **Further Reading:** [1-2 high-quality related articles or resources]

        CRITICAL: Keep the Executive Summary section to exactly 250 words or fewer. Be concise but comprehensive.`;
  }
  /**
   * Create detailed guide prompt
   */
  createDetailedGuidePrompt(baseContent, videoUrl, performanceMode = "balanced") {
    const videoId = ValidationUtils.extractVideoId(videoUrl);
    const embedUrl = videoId ? `https://www.youtube-nocookie.com/embed/${videoId}` : videoUrl;
    return `${baseContent}

        OUTPUT FORMAT - COMPREHENSIVE TUTORIAL:

        Use this EXACT template:

        ---
        title: {Video Title}
        source: ${videoUrl}
        created: "${new Date().toISOString().split("T")[0]}"
        modified: "${new Date().toISOString().split("T")[0]}"
        description: "Single sentence capturing the core insight"
        type: youtube-note
        format: detailed-tutorial
        tags:
          - youtube
          - tutorial
          - step-by-step
          - tag_1
          - tag_2
          - tag_3
        status: processed
        duration: "[Extract video duration]"
        channel: "[Extract channel name]"
        video_id: "${videoId || "unknown"}"
        processing_date: "${new Date().toISOString()}"
        word_count: "[estimated word count]"
    ai_provider: "__AI_PROVIDER__"
    ai_model: "__AI_MODEL__"
        difficulty: "[beginner/intermediate/advanced]"
        estimated_time: "[time to complete]"
        ---

        <iframe width="640" height="360" src="${embedUrl}" title="{Video Title}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

        ---

        ## Comprehensive Tutorial

        ### Concise Summary

        [Two-part response: a concise summary under 150 words that captures the video's core value and main insights]

        ## Step-by-Step Implementation Guide
        ### Step 1: [Action Title]
        - Detailed instruction 1
        - Detailed instruction 2
        - Key considerations or tips
        
        ### Step 2: [Action Title]
        - Detailed instruction 1
        - Detailed instruction 2
        - Key considerations or tips

        [Continue with additional steps as needed - provide comprehensive coverage]

        ## Resources
        - **Original Video:** [Watch on YouTube](${videoUrl})
        - **Channel:** [Creator's Channel](https://youtube.com/channel/[extract-channel-id])
        - **Related Documentation:** [If any tools/frameworks mentioned, provide official docs links]
        - **Additional Learning:** [Suggest 2-3 related high-quality resources]
        - **Tools & Software:** [List any tools mentioned with download/setup links]
        - **Community:** [Relevant forums, Discord servers, or communities]

        IMPORTANT: Provide detailed, actionable steps that someone could follow to implement the concepts from the video.`;
  }
  /**
   * Process AI response and inject provider information
   */
  processAIResponse(content, provider, model, format) {
    if (!content) {
      return content;
    }
    const providerValue = provider || "unknown";
    const modelValue = model || "unknown";
    let updatedContent = content.replace(/__AI_PROVIDER__/g, providerValue).replace(/__AI_MODEL__/g, modelValue);
    updatedContent = this.ensureFrontMatterValue(updatedContent, "ai_provider", providerValue);
    updatedContent = this.ensureFrontMatterValue(updatedContent, "ai_model", modelValue);
    return updatedContent;
  }
  ensureFrontMatterValue(content, key, value) {
    const pattern = new RegExp(`(${key}\\s*:\\s*)(["'])?([^"'\\n]*)(["'])?`, "i");
    if (pattern.test(content)) {
      return content.replace(pattern, (_, prefix, openingQuote, _existing, closingQuote) => {
        const quote = openingQuote || closingQuote ? '"' : "";
        return `${prefix}${quote}${value}${quote}`;
      });
    }
    if (content.startsWith("---")) {
      return content.replace(/^---\s*\n/, `---
${key}: "${value}"
`);
    }
    return content;
  }
  /**
   * Create a summary prompt for shorter content
   */
  createSummaryPrompt(videoData, videoUrl) {
    return `Create a concise summary for this YouTube video:

        Title: ${videoData.title}
        URL: ${videoUrl}
        Description: ${videoData.description}

        Please provide:
        1. A 2-paragraph summary (max 250 words)
        2. 3-5 key takeaways
        3. Main actionable insights

        Format as markdown with clear headings.`;
  }
  /**
   * Validate prompt length and content
   */
  validatePrompt(prompt) {
    return Boolean(prompt) && typeof prompt === "string" && prompt.trim().length > 10 && prompt.length < 5e4;
  }
};
var AIPromptService = _AIPromptService;
// Optimized prompt templates for different performance modes
AIPromptService.COMPACT_BASE_TEMPLATE = `Analyze this YouTube video:
Title: {{TITLE}}
URL: {{URL}}
Description: {{DESCRIPTION}}

Focus on extracting the key information and insights.`;
AIPromptService.BALANCED_BASE_TEMPLATE = `Analyze this YouTube video with multimodal analysis:
Title: {{TITLE}}
URL: {{URL}}
Description: {{DESCRIPTION}}

Extract insights from both spoken content and visual elements, focusing on practical information.`;
AIPromptService.COMPREHENSIVE_BASE_TEMPLATE = `Analyze this YouTube video using comprehensive multimodal analysis:
Title: {{TITLE}}
URL: {{URL}}
Description: {{DESCRIPTION}}

MULTIMODAL ANALYSIS INSTRUCTIONS:
1. Watch the complete video using both audio and visual analysis capabilities
2. Extract insights from spoken content, music, sound effects, and ambient audio
3. Analyze visual elements including slides, diagrams, charts, body language, and demonstrations
4. Focus on practical, action-oriented information with specific examples
5. Maintain accuracy and cite specific examples from the video when relevant`;

// src/services/cache/memory-cache.ts
var MemoryCacheService = class {
  constructor() {
    this.cache = /* @__PURE__ */ new Map();
    this.defaultTTL = 3e5;
    // 5 minutes
    this.lastCleanup = 0;
    this.CLEANUP_INTERVAL = 6e4;
  }
  // 1 minute
  /**
   * Get item from cache (optimized with lazy cleanup)
   */
  get(key) {
    var _a;
    if (this.cache.size > 50) {
      this.cleanup();
    }
    const item = this.cache.get(key);
    if (!item)
      return null;
    const ttl = (_a = item.ttl) != null ? _a : this.defaultTTL;
    if (Date.now() - item.timestamp > ttl) {
      this.cache.delete(key);
      return null;
    }
    return item.data;
  }
  /**
   * Set item in cache
   */
  set(key, data, ttl) {
    this.cache.set(key, {
      data,
      timestamp: Date.now(),
      ttl
    });
  }
  /**
   * Clear all cache items
   */
  clear() {
    this.cache.clear();
  }
  /**
   * Delete specific cache item
   */
  delete(key) {
    return this.cache.delete(key);
  }
  /**
   * Check if key exists in cache
   */
  has(key) {
    var _a;
    const item = this.cache.get(key);
    if (!item) {
      return false;
    }
    const ttl = (_a = item.ttl) != null ? _a : this.defaultTTL;
    if (Date.now() - item.timestamp > ttl) {
      this.cache.delete(key);
      return false;
    }
    return true;
  }
  /**
   * Get cache size
   */
  size() {
    return this.cache.size;
  }
  /**
   * Clean up expired items (optimized with batched operations)
   */
  cleanup() {
    var _a;
    const now = Date.now();
    if (now - this.lastCleanup < this.CLEANUP_INTERVAL)
      return;
    this.lastCleanup = now;
    const expiredKeys = [];
    for (const [key, item] of this.cache.entries()) {
      const ttl = (_a = item.ttl) != null ? _a : this.defaultTTL;
      if (now - item.timestamp > ttl) {
        expiredKeys.push(key);
      }
    }
    expiredKeys.forEach((key) => this.cache.delete(key));
  }
};

// src/services/service-container.ts
var ServiceContainer = class {
  constructor(settings, app) {
    this.settings = settings;
    this.app = app;
  }
  get aiService() {
    if (!this._aiService) {
      const providers = [];
      if (this.settings.geminiApiKey) {
        providers.push(new GeminiProvider(this.settings.geminiApiKey));
      }
      if (this.settings.groqApiKey) {
        providers.push(new GroqProvider(this.settings.groqApiKey));
      }
      this._aiService = new AIService(providers);
    }
    return this._aiService;
  }
  get videoService() {
    if (!this._videoService) {
      this._videoService = new YouTubeVideoService(this.cacheService);
    }
    return this._videoService;
  }
  get fileService() {
    if (!this._fileService) {
      this._fileService = new ObsidianFileService(this.app);
    }
    return this._fileService;
  }
  get cacheService() {
    if (!this._cacheService) {
      this._cacheService = new MemoryCacheService();
    }
    return this._cacheService;
  }
  get promptService() {
    if (!this._promptService) {
      this._promptService = new AIPromptService();
    }
    return this._promptService;
  }
  /**
   * Update settings and refresh services that depend on them
   */
  async updateSettings(newSettings) {
    this.settings = newSettings;
    this._aiService = void 0;
  }
  /**
   * Clear all cached services
   */
  clearServices() {
    this._aiService = void 0;
    this._videoService = void 0;
    this._fileService = void 0;
    this._cacheService = void 0;
    this._promptService = void 0;
  }
};

// src/main.ts
var PLUGIN_PREFIX = "ytp";
var DEFAULT_SETTINGS = {
  geminiApiKey: "",
  groqApiKey: "",
  outputPath: "YouTube/Processed Videos",
  useEnvironmentVariables: false,
  environmentPrefix: "YTC",
  // Performance settings with smart defaults
  performanceMode: "balanced",
  enableParallelProcessing: true,
  preferMultimodal: true
};
var YoutubeClipperPlugin = class extends import_obsidian7.Plugin {
  constructor() {
    super(...arguments);
    this.settings = DEFAULT_SETTINGS;
    this.isUnloading = false;
    this.operationCount = 0;
    // Track temp notes we've already handled to avoid duplicate modal opens
    this.handledTempFiles = /* @__PURE__ */ new Set();
  }
  async onload() {
    var _a;
    this.logInfo("Initializing YoutubeClipper Plugin v1.2.0...");
    const conflicts = ConflictPrevention.checkForPotentialConflicts();
    if (conflicts.length > 0) {
      this.logWarning(`Potential conflicts detected but proceeding: ${conflicts.join(", ")}`);
    }
    try {
      await this.loadSettings();
      await this.initializeServices();
      this.registerUIComponents();
      const NOTE_MARKER = "<!-- ytc-extension:youtube-clipper -->";
      this.registerEvent(this.app.vault.on("create", async (file) => {
        try {
          if (!(file instanceof import_obsidian7.TFile))
            return;
          const content = await this.app.vault.read(file);
          let url = null;
          if (content && content.includes(NOTE_MARKER)) {
            url = content.replace(NOTE_MARKER, "").trim();
          } else {
            const maybe = (content || "").trim();
            const ytRegex = /(https?:\/\/(?:www\.)?youtube\.com\/watch\?v=[A-Za-z0-9_-]{6,}|https?:\/\/(?:www\.)?youtu\.be\/[A-Za-z0-9_-]{6,})/i;
            const m = maybe.match(ytRegex);
            if (m && m[1]) {
              url = m[1].trim();
            } else if (file.name && file.name.startsWith("YouTube Clip -")) {
              const single = maybe.split("\n").map((s) => s.trim()).find(Boolean) || "";
              if (ValidationUtils.isValidYouTubeUrl(single))
                url = single;
            }
          }
          if (!url) {
            console.debug("YouTubeClipper: create handler - no url extracted for", file.path);
            return;
          }
          console.debug("YouTubeClipper: detected temp note", { path: file.path, url });
          setTimeout(() => {
            console.debug("YouTubeClipper: opening modal for", url);
            void this.safeShowUrlModal(url);
          }, 300);
        } catch (e) {
        }
      }));
      this.registerEvent(this.app.workspace.on("active-leaf-change", async () => {
        try {
          const file = this.app.workspace.getActiveFile();
          if (!file || !(file instanceof import_obsidian7.TFile))
            return;
          if (this.handledTempFiles.has(file.path))
            return;
          const content = await this.app.vault.read(file);
          let url = null;
          if (content && content.includes(NOTE_MARKER)) {
            url = content.replace(NOTE_MARKER, "").trim();
          } else {
            const maybe = (content || "").trim();
            const ytRegex = /(https?:\/\/(?:www\.)?youtube\.com\/watch\?v=[A-Za-z0-9_-]{6,}|https?:\/\/(?:www\.)?youtu\.be\/[A-Za-z0-9_-]{6,})/i;
            const m = maybe.match(ytRegex);
            if (m && m[1]) {
              url = m[1].trim();
            } else if (file.name && file.name.startsWith("YouTube Clip -")) {
              const single = maybe.split("\n").map((s) => s.trim()).find(Boolean) || "";
              if (ValidationUtils.isValidYouTubeUrl(single))
                url = single;
            }
          }
          if (!url) {
            console.debug("YouTubeClipper: active-leaf-change - no url for", file.path);
            return;
          }
          console.debug("YouTubeClipper: active-leaf-change detected temp note", { path: file.path, url });
          this.handledTempFiles.add(file.path);
          setTimeout(() => {
            console.debug("YouTubeClipper: opening modal (active-leaf) for", url);
            void this.safeShowUrlModal(url);
          }, 250);
        } catch (e) {
        }
      }));
      this.logInfo("YoutubeClipper Plugin loaded successfully");
      try {
        (_a = this.registerObsidianProtocolHandler) == null ? void 0 : _a.call(this, "youtube-clipper", (params) => {
          try {
            const url = params.url || params.content || params.path || "";
            if (url && ValidationUtils.isValidYouTubeUrl(url)) {
              setTimeout(() => {
                void this.safeShowUrlModal(url);
              }, 200);
            } else {
              console.debug("YouTubeClipper: protocol handler received no valid url", params);
            }
          } catch (e) {
            console.warn("YouTubeClipper: protocol handler error", e);
          }
        });
      } catch (e) {
      }
    } catch (error) {
      this.logError("Failed to load plugin", error);
      ErrorHandler.handle(error, "Plugin initialization");
      new import_obsidian7.Notice("Failed to load YoutubeClipper Plugin. Check console for details.");
    }
  }
  onunload() {
    var _a;
    this.logInfo("Unloading YoutubeClipper Plugin...");
    this.isUnloading = true;
    try {
      (_a = this.serviceContainer) == null ? void 0 : _a.clearServices();
      this.cleanupUIElements();
      ConflictPrevention.cleanupAllElements();
      this.logInfo("YoutubeClipper Plugin unloaded successfully");
    } catch (error) {
      this.logError("Error during plugin unload", error);
    }
  }
  async initializeServices() {
    this.serviceContainer = new ServiceContainer(this.settings, this.app);
  }
  registerUIComponents() {
    this.ribbonIcon = this.addRibbonIcon("video", "Process YouTube Video", () => {
      void this.safeShowUrlModal();
    });
    this.addCommand({
      id: `${PLUGIN_PREFIX}-process-youtube-video`,
      name: "Process YouTube Video",
      callback: () => {
        void this.safeShowUrlModal();
      }
    });
    this.addSettingTab(new YouTubeSettingsTab(this.app, {
      plugin: this,
      onSettingsChange: this.handleSettingsChange.bind(this)
    }));
    this.addCommand({
      id: `${PLUGIN_PREFIX}-open-url-from-clipboard`,
      name: "YouTube Clipper: Open URL Modal (from clipboard)",
      callback: async () => {
        try {
          let text = "";
          try {
            if (navigator && navigator.clipboard && navigator.clipboard.readText) {
              text = await navigator.clipboard.readText() || "";
            }
          } catch (e) {
            text = "";
          }
          if (text && ValidationUtils.isValidYouTubeUrl(text.trim())) {
            void this.safeShowUrlModal(text.trim());
            return;
          }
          const manual = window.prompt("Paste YouTube URL to open in YouTube Clipper:");
          if (manual && ValidationUtils.isValidYouTubeUrl(manual.trim())) {
            void this.safeShowUrlModal(manual.trim());
          } else {
            new import_obsidian7.Notice("No valid YouTube URL provided.");
          }
        } catch (error) {
          ErrorHandler.handle(error, "Open URL from clipboard");
        }
      }
    });
  }
  cleanupUIElements() {
    if (this.ribbonIcon) {
      this.ribbonIcon.remove();
      this.ribbonIcon = void 0;
    }
  }
  async safeShowUrlModal(initialUrl) {
    await this.safeOperation(async () => {
      this.openYouTubeUrlModal(initialUrl);
    }, "Show URL Modal");
  }
  async safeOperation(operation, operationName) {
    if (this.isUnloading) {
      this.logWarning(`Attempted ${operationName} during plugin unload - skipping`);
      return null;
    }
    const opId = ++this.operationCount;
    this.logInfo(`Starting operation ${opId}: ${operationName}`);
    try {
      const result = await operation();
      this.logInfo(`Completed operation ${opId}: ${operationName}`);
      return result;
    } catch (error) {
      this.logError(`Failed operation ${opId}: ${operationName}`, error);
      ErrorHandler.handle(error, operationName);
      return null;
    }
  }
  openYouTubeUrlModal(initialUrl) {
    if (this.isUnloading) {
      ConflictPrevention.log("Plugin is unloading, ignoring modal request");
      return;
    }
    ConflictPrevention.safeOperation(async () => {
      var _a;
      const aiService = (_a = this.serviceContainer) == null ? void 0 : _a.aiService;
      const providers = aiService ? aiService.getProviderNames() : [];
      const modelOptionsMap = this.settings.modelOptionsCache || {};
      if (aiService && (!this.settings.modelOptionsCache || Object.keys(this.settings.modelOptionsCache).length === 0)) {
        for (const p of providers) {
          modelOptionsMap[p] = aiService.getProviderModels(p) || [];
        }
      }
      new YouTubeUrlModal(this.app, {
        onProcess: this.processYouTubeVideo.bind(this),
        onOpenFile: this.openFileByPath.bind(this),
        initialUrl,
        providers,
        modelOptions: modelOptionsMap,
        fetchModels: async () => {
          try {
            const map = await this.serviceContainer.aiService.fetchLatestModels();
            this.settings.modelOptionsCache = map;
            await this.saveSettings();
            return map;
          } catch (error) {
            return modelOptionsMap;
          }
        }
      }).open();
    }, "YouTube URL Modal").catch((error) => {
      ErrorHandler.handle(error, "Opening YouTube URL modal");
    });
  }
  async processYouTubeVideo(url, format = "detailed-guide", providerName, model, customPrompt) {
    if (this.isUnloading) {
      ConflictPrevention.log("Plugin is unloading, cancelling video processing");
      throw new Error("Plugin is shutting down");
    }
    const result = await ConflictPrevention.safeOperation(async () => {
      var _a;
      new import_obsidian7.Notice(MESSAGES.PROCESSING);
      const validation = ValidationUtils.validateSettings(this.settings);
      if (!validation.isValid) {
        throw new Error(`Configuration invalid: ${validation.errors.join(", ")}`);
      }
      const youtubeService = this.serviceContainer.videoService;
      const aiService = this.serviceContainer.aiService;
      const fileService = this.serviceContainer.fileService;
      const promptService = this.serviceContainer.promptService;
      const videoId = youtubeService.extractVideoId(url);
      if (!videoId) {
        throw new Error(MESSAGES.ERRORS.VIDEO_ID_EXTRACTION);
      }
      const videoData = await youtubeService.getVideoData(videoId);
      let promptToUse;
      if (format === "custom") {
        promptToUse = customPrompt;
      } else {
        promptToUse = (_a = this.settings.customPrompts) == null ? void 0 : _a[format];
      }
      const prompt = promptService.createAnalysisPrompt(videoData, url, format, promptToUse);
      let aiResponse;
      if (providerName) {
        aiResponse = await aiService.processWith(providerName, prompt, model);
      } else {
        aiResponse = await aiService.process(prompt);
      }
      const formattedContent = promptService.processAIResponse(
        aiResponse.content,
        aiResponse.provider,
        aiResponse.model,
        format,
        videoData,
        url
      );
      const filePath = await fileService.saveToFile(
        videoData.title,
        formattedContent,
        this.settings.outputPath
      );
      new import_obsidian7.Notice(MESSAGES.SUCCESS(videoData.title));
      return filePath;
    }, "YouTube Video Processing");
    if (!result) {
      throw new Error("Failed to process YouTube video");
    }
    return result;
  }
  async openFileByPath(filePath) {
    try {
      await new Promise((resolve) => setTimeout(resolve, 300));
      const cleanPath = filePath.startsWith("/") ? filePath.substring(1) : filePath;
      const file = this.app.vault.getAbstractFileByPath(cleanPath);
      if (!file || !(file instanceof import_obsidian7.TFile)) {
        throw new Error(`File not found at path: ${cleanPath}`);
      }
      await this.openFileInNewTab(file);
    } catch (error) {
      ErrorHandler.handle(error, "Opening file by path");
      throw error;
    }
  }
  async openFileInNewTab(file) {
    try {
      const leaf = this.app.workspace.getLeaf("tab");
      await leaf.openFile(file);
      this.app.workspace.setActiveLeaf(leaf);
      new import_obsidian7.Notice(`\u{1F4C2} Opened: ${file.name}`);
    } catch (error) {
      try {
        const currentLeaf = this.app.workspace.getLeaf(false);
        await currentLeaf.openFile(file);
        new import_obsidian7.Notice(`\u{1F4C2} Opened: ${file.name}`);
      } catch (fallbackError) {
        ErrorHandler.handle(fallbackError, "Opening file in current tab");
        new import_obsidian7.Notice(`Note saved as "${file.name}" but could not auto-open. Please open manually.`);
      }
    }
  }
  showPersistentSaveConfirmation(file) {
    try {
      const modal = new SaveConfirmationModal(this.app, file, (shouldOpen) => {
        if (shouldOpen) {
          void this.openFileInNewTab(file);
        }
      });
      modal.open();
    } catch (error) {
      ErrorHandler.handle(error, "Showing save confirmation");
      new import_obsidian7.Notice(`File saved: ${file.name}. Click to open.`, 0).noticeEl.onclick = () => {
        void this.openFileInNewTab(file);
      };
    }
  }
  async handleSettingsChange(newSettings) {
    var _a;
    try {
      this.settings = { ...newSettings };
      await this.saveSettings();
      await ((_a = this.serviceContainer) == null ? void 0 : _a.updateSettings(this.settings));
    } catch (error) {
      ErrorHandler.handle(error, "Settings update");
      throw error;
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  getServiceContainer() {
    return this.serviceContainer;
  }
  logInfo(message) {
    ConflictPrevention.log(`[INFO] ${message}`);
  }
  logWarning(message) {
    ConflictPrevention.log(`[WARN] ${message}`, "warn");
  }
  logError(message, error) {
    ConflictPrevention.log(`[ERROR] ${message}: ${error.message}`, "error");
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL2NvbnN0YW50cy9zdHlsZXMudHMiLCAic3JjL3V0aWxzL2RvbS50cyIsICJzcmMvY29uc3RhbnRzL2FwaS50cyIsICJzcmMvY29tcG9uZW50cy9tb2RhbHMvY29uZmlybWF0aW9uLW1vZGFsLnRzIiwgInNyYy9jb21wb25lbnRzL21vZGFscy9iYXNlLW1vZGFsLnRzIiwgIm1haW4udHMiLCAic3JjL21haW4udHMiLCAic3JjL3V0aWxzL2NvbmZsaWN0LXByZXZlbnRpb24udHMiLCAic3JjL2NvbnN0YW50cy9tZXNzYWdlcy50cyIsICJzcmMvdXRpbHMvdmFsaWRhdGlvbi50cyIsICJzcmMvdXRpbHMvZXJyb3ItaGFuZGxlci50cyIsICJzcmMvY29tcG9uZW50cy9tb2RhbHMvc2F2ZS1jb25maXJtYXRpb24tbW9kYWwudHMiLCAic3JjL2NvbXBvbmVudHMvbW9kYWxzL3lvdXR1YmUtdXJsLW1vZGFsLnRzIiwgInNyYy9jb21wb25lbnRzL3NldHRpbmdzL3NldHRpbmdzLXRhYi50cyIsICJzcmMvc2VydmljZXMvc2VjdXJlLWNvbmZpZy50cyIsICJzcmMvY29uc3RhbnRzL3BlcmZvcm1hbmNlLnRzIiwgInNyYy9zZXJ2aWNlcy9haS9haS1zZXJ2aWNlLnRzIiwgInNyYy9zZXJ2aWNlcy9haS9nZW1pbmkudHMiLCAic3JjL3NlcnZpY2VzL2FpL2Jhc2UudHMiLCAic3JjL3NlcnZpY2VzL2FpL2dyb3EudHMiLCAic3JjL3NlcnZpY2VzL3lvdXR1YmUvdmlkZW8tZGF0YS50cyIsICJzcmMvc2VydmljZXMveW91dHViZS90cmFuc2NyaXB0LXNlcnZpY2UudHMiLCAic3JjL3NlcnZpY2VzL2ZpbGUvb2JzaWRpYW4tZmlsZS50cyIsICJzcmMvY29tcG9uZW50cy9tb2RhbHMvZmlsZS1jb25mbGljdC1tb2RhbC50cyIsICJzcmMvc2VydmljZXMvcHJvbXB0LXNlcnZpY2UudHMiLCAic3JjL3NlcnZpY2VzL2NhY2hlL21lbW9yeS1jYWNoZS50cyIsICJzcmMvc2VydmljZXMvc2VydmljZS1jb250YWluZXIudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbIi8qKlxuICogVUkgc3R5bGluZyBjb25zdGFudHMgdG8gZWxpbWluYXRlIERSWSB2aW9sYXRpb25zXG4gKi9cblxuZXhwb3J0IGNvbnN0IE1PREFMX1NUWUxFUyA9IHtcbiAgICB6SW5kZXg6ICcxMDAwMCcsXG4gICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgIGhlYWRlcjoge1xuICAgICAgICBtYXJnaW5Cb3R0b206ICcxNXB4JyxcbiAgICAgICAgY29sb3I6ICd2YXIoLS10ZXh0LWFjY2VudCknXG4gICAgfSxcbiAgICBtZXNzYWdlOiB7XG4gICAgICAgIG1hcmdpbkJvdHRvbTogJzIwcHgnLFxuICAgICAgICBsaW5lSGVpZ2h0OiAnMS41J1xuICAgIH0sXG4gICAgYnV0dG9uQ29udGFpbmVyOiB7XG4gICAgICAgIG1hcmdpblRvcDogJzIwcHgnLFxuICAgICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICAgIGdhcDogJzEwcHgnLFxuICAgICAgICBqdXN0aWZ5Q29udGVudDogJ2ZsZXgtZW5kJ1xuICAgIH0sXG4gICAgYnV0dG9uOiB7XG4gICAgICAgIHBhZGRpbmc6ICc4cHggMTZweCcsXG4gICAgICAgIG1pbldpZHRoOiAnMTAwcHgnXG4gICAgfVxufSBhcyBjb25zdDtcblxuZXhwb3J0IGNvbnN0IElOUFVUX1NUWUxFUyA9IHtcbiAgICB3aWR0aDogJzEwMCUnLFxuICAgIG1hcmdpblRvcDogJzhweCcsXG4gICAgcGFkZGluZzogJzhweCcsXG4gICAgYm9yZGVyOiAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKScsXG4gICAgYm9yZGVyUmFkaXVzOiAnNHB4J1xufSBhcyBjb25zdDtcblxuZXhwb3J0IGNvbnN0IENPTlRBSU5FUl9TVFlMRVMgPSB7XG4gICAgbWFyZ2luVG9wOiAnMjBweCdcbn0gYXMgY29uc3Q7XG4iLCAiLyoqXG4gKiBET00gbWFuaXB1bGF0aW9uIHV0aWxpdGllcyB0byBlbGltaW5hdGUgY29kZSBkdXBsaWNhdGlvblxuICovXG5cbmltcG9ydCB7IE1PREFMX1NUWUxFUywgSU5QVVRfU1RZTEVTIH0gZnJvbSAnLi4vY29uc3RhbnRzL3N0eWxlcyc7XG5pbXBvcnQgeyBET01VdGlsc0ludGVyZmFjZSwgU3R5bGVPYmplY3QgfSBmcm9tICcuLi9pbnRlcmZhY2VzL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIERPTVV0aWxzIGltcGxlbWVudHMgRE9NVXRpbHNJbnRlcmZhY2Uge1xuICAgIC8qKlxuICAgICAqIEFwcGx5IHN0eWxlcyB0byBhbiBIVE1MIGVsZW1lbnRcbiAgICAgKi9cbiAgICBzdGF0aWMgYXBwbHlTdHlsZXMoZWxlbWVudDogSFRNTEVsZW1lbnQsIHN0eWxlczogU3R5bGVPYmplY3QpOiB2b2lkIHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihlbGVtZW50LnN0eWxlLCBzdHlsZXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIHN0YW5kYXJkaXplZCBidXR0b24gY29udGFpbmVyXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZUJ1dHRvbkNvbnRhaW5lcihwYXJlbnQ6IEhUTUxFbGVtZW50KTogSFRNTERpdkVsZW1lbnQge1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSBwYXJlbnQuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRoaXMuYXBwbHlTdHlsZXMoY29udGFpbmVyLCBNT0RBTF9TVFlMRVMuYnV0dG9uQ29udGFpbmVyKTtcbiAgICAgICAgcmV0dXJuIGNvbnRhaW5lcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBzdHlsZWQgYnV0dG9uIHdpdGggY29uc2lzdGVudCBhcHBlYXJhbmNlXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZVN0eWxlZEJ1dHRvbihcbiAgICAgICAgY29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgdGV4dDogc3RyaW5nLFxuICAgICAgICBpc1ByaW1hcnkgPSBmYWxzZSxcbiAgICAgICAgb25DbGljaz86ICgpID0+IHZvaWRcbiAgICApOiBIVE1MQnV0dG9uRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0IH0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKGlzUHJpbWFyeSkge1xuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ21vZC1jdGEnKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5hcHBseVN0eWxlcyhidXR0b24sIE1PREFMX1NUWUxFUy5idXR0b24pO1xuICAgICAgICBcbiAgICAgICAgaWYgKG9uQ2xpY2spIHtcbiAgICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xpY2spO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gYnV0dG9uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIHN0eWxlZCBpbnB1dCBmaWVsZFxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGVTdHlsZWRJbnB1dChcbiAgICAgICAgY29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgdHlwZTogc3RyaW5nLFxuICAgICAgICBwbGFjZWhvbGRlcjogc3RyaW5nLFxuICAgICAgICB2YWx1ZSA9ICcnXG4gICAgKTogSFRNTElucHV0RWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gY29udGFpbmVyLmNyZWF0ZUVsKCdpbnB1dCcsIHtcbiAgICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgICBwbGFjZWhvbGRlcixcbiAgICAgICAgICAgIHZhbHVlXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5hcHBseVN0eWxlcyhpbnB1dCwgSU5QVVRfU1RZTEVTKTtcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCB1cCBtb2RhbCBiYXNlIHN0eWxpbmcgZm9yIGNvbnNpc3RlbmN5XG4gICAgICovXG4gICAgc3RhdGljIHNldHVwTW9kYWxTdHlsaW5nKG1vZGFsRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMuYXBwbHlTdHlsZXMobW9kYWxFbCwge1xuICAgICAgICAgICAgekluZGV4OiBNT0RBTF9TVFlMRVMuekluZGV4LFxuICAgICAgICAgICAgZGlzcGxheTogTU9EQUxfU1RZTEVTLmRpc3BsYXlcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgaGVhZGVyIGVsZW1lbnQgd2l0aCBjb25zaXN0ZW50IHN0eWxpbmdcbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlTW9kYWxIZWFkZXIocGFyZW50OiBIVE1MRWxlbWVudCwgdGV4dDogc3RyaW5nKTogSFRNTEhlYWRpbmdFbGVtZW50IHtcbiAgICAgICAgY29uc3QgaGVhZGVyID0gcGFyZW50LmNyZWF0ZUVsKCdoMicsIHsgdGV4dCB9KTtcbiAgICAgICAgdGhpcy5hcHBseVN0eWxlcyhoZWFkZXIsIE1PREFMX1NUWUxFUy5oZWFkZXIpO1xuICAgICAgICByZXR1cm4gaGVhZGVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG1lc3NhZ2UgcGFyYWdyYXBoIHdpdGggY29uc2lzdGVudCBzdHlsaW5nXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZU1vZGFsTWVzc2FnZShwYXJlbnQ6IEhUTUxFbGVtZW50LCB0ZXh0OiBzdHJpbmcpOiBIVE1MUGFyYWdyYXBoRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBwYXJlbnQuY3JlYXRlRWwoJ3AnKTtcbiAgICAgICAgbWVzc2FnZS5zZXRUZXh0KHRleHQpO1xuICAgICAgICB0aGlzLmFwcGx5U3R5bGVzKG1lc3NhZ2UsIE1PREFMX1NUWUxFUy5tZXNzYWdlKTtcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHVwIGtleWJvYXJkIGV2ZW50IGhhbmRsZXJzIGZvciBtb2RhbHNcbiAgICAgKi9cbiAgICBzdGF0aWMgc2V0dXBNb2RhbEtleUhhbmRsZXJzKFxuICAgICAgICBlbGVtZW50OiBIVE1MRWxlbWVudCxcbiAgICAgICAgb25FbnRlcjogKCkgPT4gdm9pZCxcbiAgICAgICAgb25Fc2NhcGU/OiAoKSA9PiB2b2lkXG4gICAgKTogdm9pZCB7XG4gICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBvbkVudGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnICYmIG9uRXNjYXBlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgb25Fc2NhcGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gSW5zdGFuY2UgbWV0aG9kcyBpbXBsZW1lbnRpbmcgaW50ZXJmYWNlXG4gICAgYXBwbHlTdHlsZXMoZWxlbWVudDogSFRNTEVsZW1lbnQsIHN0eWxlczogU3R5bGVPYmplY3QpOiB2b2lkIHtcbiAgICAgICAgRE9NVXRpbHMuYXBwbHlTdHlsZXMoZWxlbWVudCwgc3R5bGVzKTtcbiAgICB9XG5cbiAgICBjcmVhdGVCdXR0b25Db250YWluZXIocGFyZW50OiBIVE1MRWxlbWVudCk6IEhUTUxEaXZFbGVtZW50IHtcbiAgICAgICAgcmV0dXJuIERPTVV0aWxzLmNyZWF0ZUJ1dHRvbkNvbnRhaW5lcihwYXJlbnQpO1xuICAgIH1cblxuICAgIGNyZWF0ZVN0eWxlZEJ1dHRvbihcbiAgICAgICAgY29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgdGV4dDogc3RyaW5nLFxuICAgICAgICBpc1ByaW1hcnkgPSBmYWxzZSxcbiAgICAgICAgb25DbGljaz86ICgpID0+IHZvaWRcbiAgICApOiBIVE1MQnV0dG9uRWxlbWVudCB7XG4gICAgICAgIHJldHVybiBET01VdGlscy5jcmVhdGVTdHlsZWRCdXR0b24oY29udGFpbmVyLCB0ZXh0LCBpc1ByaW1hcnksIG9uQ2xpY2spO1xuICAgIH1cbn1cbiIsICIvKipcbiAqIEFQSSBlbmRwb2ludHMgYW5kIGNvbmZpZ3VyYXRpb24gY29uc3RhbnRzXG4gKi9cblxuZXhwb3J0IGNvbnN0IEFQSV9FTkRQT0lOVFMgPSB7XG4gICAgR0VNSU5JOiAnaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy9nZW1pbmktMi41LXBybzpnZW5lcmF0ZUNvbnRlbnQnLFxuICAgIEdST1E6ICdodHRwczovL2FwaS5ncm9xLmNvbS9vcGVuYWkvdjEvY2hhdC9jb21wbGV0aW9ucycsXG4gICAgWU9VVFVCRV9PRU1CRUQ6ICdodHRwczovL3d3dy55b3V0dWJlLmNvbS9vZW1iZWQnLFxuICAgIENPUlNfUFJPWFk6ICdodHRwczovL2FwaS5hbGxvcmlnaW5zLndpbi9yYXcnXG59IGFzIGNvbnN0O1xuXG5leHBvcnQgY29uc3QgQUlfTU9ERUxTID0ge1xuICAgIEdFTUlOSTogJ2dlbWluaS0yLjUtcHJvJywgLy8gU2V0IEdlbWluaSBtb2RlbCB0byBnZW1pbmktMi41LXByb1xuICAgIEdST1E6ICdsbGFtYS0zLjMtNzBiLXZlcnNhdGlsZSdcbn0gYXMgY29uc3Q7XG5cbi8vIEtub3duIG1vZGVsIG9wdGlvbnMgcGVyIHByb3ZpZGVyICh1c2VkIHRvIHBvcHVsYXRlIG1vZGVsIHNlbGVjdG9yIGluIFVJKVxuLy8gRWFjaCBlbnRyeSBpcyBub3cgYW4gb2JqZWN0IHdpdGggYG5hbWVgIGFuZCBvcHRpb25hbCBtZXRhZGF0YSBsaWtlIGBzdXBwb3J0c0F1ZGlvVmlkZW9gLlxuLy8gTW9kZWxzIGFyZSB1cGRhdGVkIHRvIHJlZmxlY3QgdGhlIGxhdGVzdCBhdmFpbGFibGUgdmVyc2lvbnMgKE5vdiAyMDI0IC0gTm92IDIwMjUpLlxuZXhwb3J0IHR5cGUgUHJvdmlkZXJNb2RlbEVudHJ5ID0geyBuYW1lOiBzdHJpbmc7IHN1cHBvcnRzQXVkaW9WaWRlbz86IGJvb2xlYW4gfTtcbmV4cG9ydCBjb25zdCBQUk9WSURFUl9NT0RFTF9PUFRJT05TOiBSZWNvcmQ8c3RyaW5nLCBQcm92aWRlck1vZGVsRW50cnlbXT4gPSB7XG4gICAgJ0dvb2dsZSBHZW1pbmknOiBbXG4gICAgICAgIC8vIEdlbWluaSAyLjUgc2VyaWVzIChsYXRlc3QsIGFsbCBzdXBwb3J0IG11bHRpbW9kYWwgdmlkZW8gYW5hbHlzaXMpXG4gICAgICAgIHsgbmFtZTogJ2dlbWluaS0yLjUtcHJvJywgc3VwcG9ydHNBdWRpb1ZpZGVvOiB0cnVlIH0sXG4gICAgICAgIHsgbmFtZTogJ2dlbWluaS0yLjUtcHJvLXR0cycsIHN1cHBvcnRzQXVkaW9WaWRlbzogdHJ1ZSB9LFxuICAgICAgICB7IG5hbWU6ICdnZW1pbmktMi41LWZsYXNoJywgc3VwcG9ydHNBdWRpb1ZpZGVvOiB0cnVlIH0sXG4gICAgICAgIHsgbmFtZTogJ2dlbWluaS0yLjUtZmxhc2gtbGl0ZScsIHN1cHBvcnRzQXVkaW9WaWRlbzogdHJ1ZSB9LFxuICAgICAgICAvLyBHZW1pbmkgMi4wIHNlcmllcyAodmlkZW8gc3VwcG9ydCB2aWEgbmF0aXZlIEFQSSwgYnV0IG5vIGV4cGxpY2l0IG11bHRpbW9kYWwgZmxhZylcbiAgICAgICAgeyBuYW1lOiAnZ2VtaW5pLTIuMC1wcm8nLCBzdXBwb3J0c0F1ZGlvVmlkZW86IHRydWUgfSxcbiAgICAgICAgeyBuYW1lOiAnZ2VtaW5pLTIuMC1mbGFzaCcgfSxcbiAgICAgICAgeyBuYW1lOiAnZ2VtaW5pLTIuMC1mbGFzaC1saXRlJyB9LFxuICAgICAgICAvLyBHZW1pbmkgMS41IHNlcmllcyAoYXZhaWxhYmxlLCBzdXBwb3J0cyB2aWRlbyB2aWEgRmlsZSBBUEkpXG4gICAgICAgIHsgbmFtZTogJ2dlbWluaS0xLjUtcHJvJyB9LFxuICAgICAgICB7IG5hbWU6ICdnZW1pbmktMS41LWZsYXNoJyB9XG4gICAgXSxcbiAgICAnR3JvcSc6IFtcbiAgICAgICAgLy8gTGF0ZXN0IG1vZGVscyAoTm92IDIwMjQgLSBOb3YgMjAyNSlcbiAgICAgICAgLy8gTm90ZTogR3JvcSBtb2RlbHMgcHJpb3JpdGl6ZSBzcGVlZC90ZXh0OyBmb3IgbXVsdGltb2RhbCB2aWRlbywgR2VtaW5pIGlzIHJlY29tbWVuZGVkXG4gICAgICAgIHsgbmFtZTogJ2xsYW1hLTQtbWF2ZXJpY2stMTdiLTEyOGUtaW5zdHJ1Y3QnIH0sXG4gICAgICAgIHsgbmFtZTogJ2xsYW1hLTQtc2NvdXQtMTdiLTE2ZS1pbnN0cnVjdCcgfSxcbiAgICAgICAgLy8gTGxhbWEgMy54IHNlcmllc1xuICAgICAgICB7IG5hbWU6ICdsbGFtYS0zLjMtNzBiLXZlcnNhdGlsZScgfSxcbiAgICAgICAgeyBuYW1lOiAnbGxhbWEtMy4xLThiLWluc3RhbnQnIH1cbiAgICBdXG59O1xuXG4vLyBPcHRpb25hbDogcHJvdmlkZXIgcGFnZXMgdG8gYXR0ZW1wdCB0byBzY3JhcGUgZm9yIGxhdGVzdCBtb2RlbCBuYW1lcyAoYmVzdC1lZmZvcnQpXG5leHBvcnQgY29uc3QgUFJPVklERVJfTU9ERUxfTElTVF9VUkxTOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICdHb29nbGUgR2VtaW5pJzogJ2h0dHBzOi8vZGV2ZWxvcGVycy5nZW5lcmF0aXZlYWkuZ29vZ2xlL21vZGVscycsXG4gICAgJ0dyb3EnOiAnaHR0cHM6Ly9ncm9xLmNvbSdcbn07XG5cbi8vIFNpbXBsZSByZWdleCBwYXR0ZXJucyB0byB0cnkgdG8gZXh0cmFjdCBtb2RlbC1saWtlIHRva2VucyBmcm9tIHByb3ZpZGVyIHBhZ2VzXG5leHBvcnQgY29uc3QgUFJPVklERVJfTU9ERUxfUkVHRVg6IFJlY29yZDxzdHJpbmcsIFJlZ0V4cD4gPSB7XG4gICAgJ0dvb2dsZSBHZW1pbmknOiAvZ2VtaW5pWy1fXFwuXT9cXGQrKD86XFwuXFxkKyk/KD86LVthLXowLTlcXC1dKyk/L2dpLFxuICAgICdHcm9xJzogL2xsYW1hWy1fXFwuXT9cXGQrKD86XFwuXFxkKyk/KD86LVthLXowLTlcXC1dKyk/L2dpXG59O1xuXG5leHBvcnQgY29uc3QgQVBJX0xJTUlUUyA9IHtcbiAgICBNQVhfVE9LRU5TOiAyMDAwLFxuICAgIFRFTVBFUkFUVVJFOiAwLjcsXG4gICAgREVTQ1JJUFRJT05fTUFYX0xFTkdUSDogMTAwMCxcbiAgICBUSVRMRV9NQVhfTEVOR1RIOiAxMDBcbn0gYXMgY29uc3Q7XG5cbmV4cG9ydCBjb25zdCBUSU1FT1VUUyA9IHtcbiAgICBGSUxFX0NSRUFUSU9OX1dBSVQ6IDMwMCxcbiAgICBNT0RBTF9ERUxBWTogMTAwLFxuICAgIEZBTExCQUNLX01PREFMX0NIRUNLOiA1MDAsXG4gICAgRk9DVVNfREVMQVk6IDE1MCxcbiAgICBSRVBBSU5UX0RFTEFZOiA1MFxufSBhcyBjb25zdDtcbiIsICIvKipcbiAqIEN1c3RvbSBzdHlsZWQgY29uZmlybWF0aW9uIG1vZGFsIGZvciBiZXR0ZXIgYWNjZXNzaWJpbGl0eSBhbmQgVVhcbiAqIFJlcGxhY2VzIG5hdGl2ZSBicm93c2VyIGNvbmZpcm0oKSB3aXRoIGEgZnVsbHkgYWNjZXNzaWJsZSBtb2RhbCBkaWFsb2dcbiAqL1xuXG5pbXBvcnQgeyBBcHAsIE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQmFzZU1vZGFsIH0gZnJvbSAnLi9iYXNlLW1vZGFsJztcblxuZXhwb3J0IGludGVyZmFjZSBDb25maXJtYXRpb25Nb2RhbE9wdGlvbnMge1xuICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgbWVzc2FnZTogc3RyaW5nO1xuICAgIGNvbmZpcm1UZXh0Pzogc3RyaW5nO1xuICAgIGNhbmNlbFRleHQ/OiBzdHJpbmc7XG4gICAgaXNEYW5nZXJvdXM/OiBib29sZWFuOyAvLyBJZiB0cnVlLCBzd2FwIGJ1dHRvbiBwb3NpdGlvbnMgKGNhbmNlbCBvbiByaWdodClcbn1cblxuLyoqXG4gKiBDdXN0b20gY29uZmlybWF0aW9uIG1vZGFsIHdpdGgga2V5Ym9hcmQgc2hvcnRjdXRzIChFbnRlciB0byBjb25maXJtLCBFc2NhcGUgdG8gY2FuY2VsKVxuICogYW5kIHByb3BlciBBUklBIGxhYmVscyBmb3IgYWNjZXNzaWJpbGl0eVxuICovXG5leHBvcnQgY2xhc3MgQ29uZmlybWF0aW9uTW9kYWwgZXh0ZW5kcyBCYXNlTW9kYWwge1xuICAgIHByaXZhdGUgY29uZmlybUJ1dHRvbj86IEhUTUxCdXR0b25FbGVtZW50O1xuICAgIHByaXZhdGUgY2FuY2VsQnV0dG9uPzogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSByZXN1bHQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIHJlc29sdmVyPzogKHZhbHVlOiBib29sZWFuKSA9PiB2b2lkO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIG9wdGlvbnM6IENvbmZpcm1hdGlvbk1vZGFsT3B0aW9uc1xuICAgICkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgIH1cblxuICAgIG9uT3BlbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jcmVhdGVNb2RhbENvbnRlbnQoKTtcbiAgICAgICAgdGhpcy5zZXR1cEV2ZW50SGFuZGxlcnMoKTtcbiAgICAgICAgdGhpcy5mb2N1c0NvbmZpcm1CdXR0b24oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgbW9kYWwgY29udGVudCB3aXRoIGFjY2Vzc2libGUgc3RydWN0dXJlXG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVNb2RhbENvbnRlbnQoKTogdm9pZCB7XG4gICAgICAgIC8vIEhlYWRlclxuICAgICAgICBjb25zdCBoZWFkZXIgPSB0aGlzLmNyZWF0ZUhlYWRlcih0aGlzLm9wdGlvbnMudGl0bGUpO1xuICAgICAgICBoZWFkZXIuc2V0QXR0cmlidXRlKCdpZCcsICdjb25maXJtYXRpb24tbW9kYWwtdGl0bGUnKTtcblxuICAgICAgICAvLyBNZXNzYWdlIGNvbnRhaW5lciB3aXRoIGFyaWEtZGVzY3JpYmVkYnlcbiAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdignY29uZmlybWF0aW9uLW1lc3NhZ2UnKTtcbiAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2NvbmZpcm1hdGlvbi1tb2RhbC1kZXNjcmlwdGlvbicpO1xuICAgICAgICBtZXNzYWdlQ29udGFpbmVyLnRleHRDb250ZW50ID0gdGhpcy5vcHRpb25zLm1lc3NhZ2U7XG5cbiAgICAgICAgLy8gQnV0dG9ucyBjb250YWluZXJcbiAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gdGhpcy5jcmVhdGVCdXR0b25Db250YWluZXIoKTtcbiAgICAgICAgYnV0dG9uQ29udGFpbmVyLnN0eWxlLm1hcmdpblRvcCA9ICcyMHB4JztcblxuICAgICAgICBjb25zdCBjb25maXJtVGV4dCA9IHRoaXMub3B0aW9ucy5jb25maXJtVGV4dCB8fCAnQ29uZmlybSc7XG4gICAgICAgIGNvbnN0IGNhbmNlbFRleHQgPSB0aGlzLm9wdGlvbnMuY2FuY2VsVGV4dCB8fCAnQ2FuY2VsJztcbiAgICAgICAgY29uc3QgaXNEYW5nZXJvdXMgPSB0aGlzLm9wdGlvbnMuaXNEYW5nZXJvdXMgfHwgZmFsc2U7XG5cbiAgICAgICAgaWYgKGlzRGFuZ2Vyb3VzKSB7XG4gICAgICAgICAgICAvLyBTd2FwOiBjYW5jZWwgb24gbGVmdCwgY29uZmlybSBvbiByaWdodCAoZm9yIGRlc3RydWN0aXZlIGFjdGlvbnMpXG4gICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKFxuICAgICAgICAgICAgICAgIGJ1dHRvbkNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICBjYW5jZWxUZXh0LFxuICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgICgpID0+IHRoaXMuaGFuZGxlQ2FuY2VsKClcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBgQ2FuY2VsOiAke2NhbmNlbFRleHR9YCk7XG5cbiAgICAgICAgICAgIHRoaXMuY29uZmlybUJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKFxuICAgICAgICAgICAgICAgIGJ1dHRvbkNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICBjb25maXJtVGV4dCxcbiAgICAgICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAgICAgICgpID0+IHRoaXMuaGFuZGxlQ29uZmlybSgpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy5jb25maXJtQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGBDb25maXJtOiAke2NvbmZpcm1UZXh0fWApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gRGVmYXVsdDogY29uZmlybSBvbiBsZWZ0LCBjYW5jZWwgb24gcmlnaHRcbiAgICAgICAgICAgIHRoaXMuY29uZmlybUJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKFxuICAgICAgICAgICAgICAgIGJ1dHRvbkNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICBjb25maXJtVGV4dCxcbiAgICAgICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAgICAgICgpID0+IHRoaXMuaGFuZGxlQ29uZmlybSgpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy5jb25maXJtQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGBDb25maXJtOiAke2NvbmZpcm1UZXh0fWApO1xuXG4gICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKFxuICAgICAgICAgICAgICAgIGJ1dHRvbkNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICBjYW5jZWxUZXh0LFxuICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgICgpID0+IHRoaXMuaGFuZGxlQ2FuY2VsKClcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBgQ2FuY2VsOiAke2NhbmNlbFRleHR9YCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXQgbW9kYWwgY29udGVudCBhcmlhLWxhYmVsbGVkYnkgYW5kIGFyaWEtZGVzY3JpYmVkYnlcbiAgICAgICAgdGhpcy5jb250ZW50RWwuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsbGVkYnknLCAnY29uZmlybWF0aW9uLW1vZGFsLXRpdGxlJyk7XG4gICAgICAgIHRoaXMuY29udGVudEVsLnNldEF0dHJpYnV0ZSgnYXJpYS1kZXNjcmliZWRieScsICdjb25maXJtYXRpb24tbW9kYWwtZGVzY3JpcHRpb24nKTtcbiAgICAgICAgdGhpcy5jb250ZW50RWwuc2V0QXR0cmlidXRlKCdyb2xlJywgJ2FsZXJ0ZGlhbG9nJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHVwIGtleWJvYXJkIGV2ZW50IGhhbmRsZXJzIChFbnRlciB0byBjb25maXJtLCBFc2NhcGUgdG8gY2FuY2VsKVxuICAgICAqL1xuICAgIHByaXZhdGUgc2V0dXBFdmVudEhhbmRsZXJzKCk6IHZvaWQge1xuICAgICAgICAvLyBFbnRlciBrZXk6IGNvbmZpcm1cbiAgICAgICAgdGhpcy5zY29wZS5yZWdpc3RlcihbXSwgJ0VudGVyJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVDb25maXJtKCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEVzY2FwZSBrZXk6IGNhbmNlbFxuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtdLCAnRXNjYXBlJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVDYW5jZWwoKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRm9jdXMgdGhlIGNvbmZpcm0gYnV0dG9uIGJ5IGRlZmF1bHRcbiAgICAgKi9cbiAgICBwcml2YXRlIGZvY3VzQ29uZmlybUJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuY29uZmlybUJ1dHRvbikge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maXJtQnV0dG9uIS5mb2N1cygpO1xuICAgICAgICAgICAgfSwgNTApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIGNvbmZpcm1hdGlvbiAoQ29uZmlybSBidXR0b24gb3IgRW50ZXIga2V5KVxuICAgICAqL1xuICAgIHByaXZhdGUgaGFuZGxlQ29uZmlybSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXN1bHQgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5yZXNvbHZlcikge1xuICAgICAgICAgICAgdGhpcy5yZXNvbHZlcih0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGFuZGxlIGNhbmNlbGxhdGlvbiAoQ2FuY2VsIGJ1dHRvbiBvciBFc2NhcGUga2V5KVxuICAgICAqL1xuICAgIHByaXZhdGUgaGFuZGxlQ2FuY2VsKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlc3VsdCA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5yZXNvbHZlcikge1xuICAgICAgICAgICAgdGhpcy5yZXNvbHZlcihmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE9wZW4gbW9kYWwgYW5kIHdhaXQgZm9yIHVzZXIgcmVzcG9uc2VcbiAgICAgKiBSZXR1cm5zIHByb21pc2UgdGhhdCByZXNvbHZlcyB0byB0cnVlIGlmIGNvbmZpcm1lZCwgZmFsc2UgaWYgY2FuY2VsbGVkXG4gICAgICovXG4gICAgcHVibGljIG9wZW5BbmRXYWl0KCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZXIgPSByZXNvbHZlO1xuICAgICAgICAgICAgdGhpcy5vcGVuKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgcmVzdWx0IChzeW5jaHJvbm91cyBpZiBhbHJlYWR5IGNsb3NlZClcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0UmVzdWx0KCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHQ7XG4gICAgfVxufVxuIiwgIi8qKlxuICogQmFzZSBtb2RhbCBjbGFzcyB3aXRoIHNoYXJlZCBmdW5jdGlvbmFsaXR5IGFuZCBjb25zaXN0ZW50IHN0eWxpbmdcbiAqIERlc2lnbmVkIHRvIHByZXZlbnQgY29uZmxpY3RzIHdpdGggb3RoZXIgcGx1Z2luIG1vZGFsc1xuICovXG5cbmltcG9ydCB7IEFwcCwgTW9kYWwgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBET01VdGlscyB9IGZyb20gJy4uLy4uL3V0aWxzL2RvbSc7XG5pbXBvcnQgeyBNT0RBTF9TVFlMRVMsIElOUFVUX1NUWUxFUyB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9zdHlsZXMnO1xuaW1wb3J0IHsgVElNRU9VVFMgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvYXBpJztcbmltcG9ydCB7IE1vZGFsRXZlbnRzIH0gZnJvbSAnLi4vLi4vaW50ZXJmYWNlcy90eXBlcyc7XG5cbi8vIFVuaXF1ZSBDU1MgY2xhc3NlcyB0byBwcmV2ZW50IGNvbmZsaWN0c1xuY29uc3QgTU9EQUxfQ1NTX0NMQVNTRVMgPSB7XG4gICAgbW9kYWw6ICd5dGMtbW9kYWwnLFxuICAgIGhlYWRlcjogJ3l0Yy1tb2RhbC1oZWFkZXInLFxuICAgIGNvbnRlbnQ6ICd5dGMtbW9kYWwtY29udGVudCcsXG4gICAgYnV0dG9uOiAneXRjLW1vZGFsLWJ1dHRvbicsXG4gICAgaW5wdXQ6ICd5dGMtbW9kYWwtaW5wdXQnXG59IGFzIGNvbnN0O1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmFzZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHByb3RlY3RlZCBldmVudHM6IFBhcnRpYWw8TW9kYWxFdmVudHM+ID0ge307XG4gICAgcHJpdmF0ZSBpc0Rpc3Bvc2VkID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLnNldHVwTW9kYWxTdHlsaW5nKCk7XG4gICAgICAgIHRoaXMuc2V0dXBDb25mbGljdFByZXZlbnRpb24oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdXAgYmFzZSBtb2RhbCBzdHlsaW5nIGZvciBjb25zaXN0ZW5jeVxuICAgICAqL1xuICAgIHByaXZhdGUgc2V0dXBNb2RhbFN0eWxpbmcoKTogdm9pZCB7XG4gICAgICAgIERPTVV0aWxzLnNldHVwTW9kYWxTdHlsaW5nKHRoaXMubW9kYWxFbCk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdW5pcXVlIENTUyBjbGFzcyB0byBwcmV2ZW50IGNvbmZsaWN0c1xuICAgICAgICB0aGlzLm1vZGFsRWwuYWRkQ2xhc3MoTU9EQUxfQ1NTX0NMQVNTRVMubW9kYWwpO1xuICAgICAgICB0aGlzLmNvbnRlbnRFbC5hZGRDbGFzcyhNT0RBTF9DU1NfQ0xBU1NFUy5jb250ZW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdXAgY29uZmxpY3QgcHJldmVudGlvbiBtZWFzdXJlc1xuICAgICAqL1xuICAgIHByaXZhdGUgc2V0dXBDb25mbGljdFByZXZlbnRpb24oKTogdm9pZCB7XG4gICAgICAgIC8vIEFkZCB1bmlxdWUgYXR0cmlidXRlIGZvciBpZGVudGlmaWNhdGlvblxuICAgICAgICB0aGlzLm1vZGFsRWwuc2V0QXR0cmlidXRlKCdkYXRhLXBsdWdpbicsICd5b3V0dWJlLWNsaXBwZXInKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEVuc3VyZSBtb2RhbCBoYXMgaGlnaCB6LWluZGV4IGJ1dCBub3QgY29uZmxpY3RpbmdcbiAgICAgICAgdGhpcy5tb2RhbEVsLnN0eWxlLnpJbmRleCA9ICc5OTk5JztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgc3RhbmRhcmRpemVkIG1vZGFsIGhlYWRlciB3aXRoIGNvbmZsaWN0IHByZXZlbnRpb25cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgY3JlYXRlSGVhZGVyKHRleHQ6IHN0cmluZyk6IEhUTUxIZWFkaW5nRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGhlYWRlciA9IERPTVV0aWxzLmNyZWF0ZU1vZGFsSGVhZGVyKHRoaXMuY29udGVudEVsLCB0ZXh0KTtcbiAgICAgICAgaGVhZGVyLmFkZENsYXNzKE1PREFMX0NTU19DTEFTU0VTLmhlYWRlcik7XG4gICAgICAgIHJldHVybiBoZWFkZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHN0YW5kYXJkaXplZCBtb2RhbCBtZXNzYWdlXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGNyZWF0ZU1lc3NhZ2UodGV4dDogc3RyaW5nKTogSFRNTFBhcmFncmFwaEVsZW1lbnQge1xuICAgICAgICByZXR1cm4gRE9NVXRpbHMuY3JlYXRlTW9kYWxNZXNzYWdlKHRoaXMuY29udGVudEVsLCB0ZXh0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgc3RhbmRhcmRpemVkIGJ1dHRvbiBjb250YWluZXJcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgY3JlYXRlQnV0dG9uQ29udGFpbmVyKCk6IEhUTUxEaXZFbGVtZW50IHtcbiAgICAgICAgcmV0dXJuIERPTVV0aWxzLmNyZWF0ZUJ1dHRvbkNvbnRhaW5lcih0aGlzLmNvbnRlbnRFbCk7XG4gICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAqIENyZWF0ZSBzdGFuZGFyZGl6ZWQgYnV0dG9uIHdpdGggY29uZmxpY3QgcHJldmVudGlvbiBhbmQgYWNjZXNzaWJpbGl0eVxuICAgICAqL1xuICAgIHByb3RlY3RlZCBjcmVhdGVCdXR0b24oXG4gICAgICAgIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIHRleHQ6IHN0cmluZyxcbiAgICAgICAgaXNQcmltYXJ5ID0gZmFsc2UsXG4gICAgICAgIG9uQ2xpY2s/OiAoKSA9PiB2b2lkXG4gICAgKTogSFRNTEJ1dHRvbkVsZW1lbnQge1xuICAgICAgICBjb25zdCBidXR0b24gPSBET01VdGlscy5jcmVhdGVTdHlsZWRCdXR0b24oY29udGFpbmVyLCB0ZXh0LCBpc1ByaW1hcnksIG9uQ2xpY2spO1xuICAgICAgICBidXR0b24uYWRkQ2xhc3MoTU9EQUxfQ1NTX0NMQVNTRVMuYnV0dG9uKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCB1bmlxdWUgZGF0YSBhdHRyaWJ1dGVcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS1wbHVnaW4nLCAneW91dHViZS1jbGlwcGVyJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBBY2Nlc3NpYmlsaXR5OiBhZGQgcm9sZSBhbmQgYXJpYS1sYWJlbFxuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdyb2xlJywgJ2J1dHRvbicpO1xuICAgICAgICBpZiAoIWJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnKSkge1xuICAgICAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIHRleHQpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gYnV0dG9uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBzdGFuZGFyZGl6ZWQgaW5wdXQgd2l0aCBjb25mbGljdCBwcmV2ZW50aW9uIGFuZCBhY2Nlc3NpYmlsaXR5XG4gICAgICovXG4gICAgcHJvdGVjdGVkIGNyZWF0ZUlucHV0KFxuICAgICAgICBjb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICB0eXBlOiBzdHJpbmcsXG4gICAgICAgIHBsYWNlaG9sZGVyPzogc3RyaW5nXG4gICAgKTogSFRNTElucHV0RWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gY29udGFpbmVyLmNyZWF0ZUVsKCdpbnB1dCcsIHtcbiAgICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgICBwbGFjZWhvbGRlclxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFwcGx5IHN0eWxlcyBhbmQgYWRkIHVuaXF1ZSBjbGFzc1xuICAgICAgICBET01VdGlscy5hcHBseVN0eWxlcyhpbnB1dCwgSU5QVVRfU1RZTEVTKTtcbiAgICAgICAgaW5wdXQuYWRkQ2xhc3MoTU9EQUxfQ1NTX0NMQVNTRVMuaW5wdXQpO1xuICAgICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcGx1Z2luJywgJ3lvdXR1YmUtY2xpcHBlcicpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWNjZXNzaWJpbGl0eTogYWRkIEFSSUEgbGFiZWxzIGlmIHBsYWNlaG9sZGVyIGV4aXN0c1xuICAgICAgICBpZiAocGxhY2Vob2xkZXIpIHtcbiAgICAgICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIHBsYWNlaG9sZGVyKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCB1cCBrZXlib2FyZCBldmVudCBoYW5kbGVyc1xuICAgICAqL1xuICAgIHByb3RlY3RlZCBzZXR1cEtleUhhbmRsZXJzKFxuICAgICAgICBvbkVudGVyOiAoKSA9PiB2b2lkIHwgUHJvbWlzZTx2b2lkPixcbiAgICAgICAgb25Fc2NhcGU/OiAoKSA9PiB2b2lkIHwgUHJvbWlzZTx2b2lkPlxuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCB3cmFwcGVkT25FbnRlciA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgb25FbnRlcigpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFbnRlciBrZXkgaGFuZGxlciBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3Qgd3JhcHBlZE9uRXNjYXBlID0gb25Fc2NhcGUgPyBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IG9uRXNjYXBlKCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0VzY2FwZSBrZXkgaGFuZGxlciBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gOiB1bmRlZmluZWQ7XG5cbiAgICAgICAgRE9NVXRpbHMuc2V0dXBNb2RhbEtleUhhbmRsZXJzKHRoaXMuY29udGVudEVsLCB3cmFwcGVkT25FbnRlciwgd3JhcHBlZE9uRXNjYXBlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGb2N1cyBlbGVtZW50IHdpdGggZGVsYXkgZm9yIGJldHRlciBVWFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBmb2N1c0VsZW1lbnQoZWxlbWVudDogSFRNTEVsZW1lbnQsIGRlbGF5ID0gVElNRU9VVFMuRk9DVVNfREVMQVkpOiB2b2lkIHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBlbGVtZW50LmZvY3VzKCk7XG4gICAgICAgIH0sIGRlbGF5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdXAgZXZlbnQgaGFuZGxlcnNcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgc2V0RXZlbnRzKGV2ZW50czogUGFydGlhbDxNb2RhbEV2ZW50cz4pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5ldmVudHMgPSBldmVudHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvdyBjdXN0b20gc3R5bGVkIGNvbmZpcm1hdGlvbiBkaWFsb2cgYmVmb3JlIGNsb3NpbmdcbiAgICAgKiBUaGlzIHVzZXMgb3VyIGN1c3RvbSBDb25maXJtYXRpb25Nb2RhbCBpbnN0ZWFkIG9mIHRoZSBuYXRpdmUgYnJvd3NlciBjb25maXJtKClcbiAgICAgKiBmb3IgYmV0dGVyIGFjY2Vzc2liaWxpdHkgYW5kIFVYLlxuICAgICAqIFxuICAgICAqIE5vdGU6IFRoaXMgaXMgbm93IHN5bmNocm9ub3VzIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSB3aXRoIGV4aXN0aW5nIGNhbGxlcnMsXG4gICAgICogYnV0IHJldHVybnMgYSBib29sZWFuIGltbWVkaWF0ZWx5LiBGb3IgYXN5bmMgY29uZmlybWF0aW9uIHdpdGggcHJvcGVyIG1vZGFsLFxuICAgICAqIHVzZSBzaG93Q29uZmlybWF0aW9uTW9kYWwoKSBpbnN0ZWFkLlxuICAgICAqL1xuICAgIHByb3RlY3RlZCBjb25maXJtQ2xvc2UobWVzc2FnZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIC8vIEZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5LCByZXR1cm4gYSBzeW5jaHJvbm91cyB2YWx1ZS5cbiAgICAgICAgLy8gSG93ZXZlciwgaW4gcHJhY3RpY2UsIHlvdSBzaG91bGQgdXNlIHNob3dDb25maXJtYXRpb25Nb2RhbCgpIGZvciB0aGUgZnVsbCBhc3luYyBleHBlcmllbmNlLlxuICAgICAgICAvLyBUaGlzIGZhbGxiYWNrIHVzZXMgbmF0aXZlIGNvbmZpcm0oKSBvbmx5IGlmIG5lZWRlZC5cbiAgICAgICAgcmV0dXJuIGNvbmZpcm0obWVzc2FnZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvdyBhIGN1c3RvbSBhY2Nlc3NpYmxlIGNvbmZpcm1hdGlvbiBtb2RhbCBhbmQgd2FpdCBmb3IgdXNlciByZXNwb25zZS5cbiAgICAgKiBQcmVmZXJyZWQgbWV0aG9kIGZvciBjb25maXJtYXRpb24gZGlhbG9ncyAoYXN5bmMsIGZ1bGx5IGFjY2Vzc2libGUpLlxuICAgICAqL1xuICAgIHByb3RlY3RlZCBhc3luYyBzaG93Q29uZmlybWF0aW9uTW9kYWwoXG4gICAgICAgIHRpdGxlOiBzdHJpbmcsXG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAgICAgY29uZmlybVRleHQgPSAnQ29uZmlybScsXG4gICAgICAgIGNhbmNlbFRleHQgPSAnQ2FuY2VsJyxcbiAgICAgICAgaXNEYW5nZXJvdXMgPSBmYWxzZVxuICAgICk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICBjb25zdCB7IENvbmZpcm1hdGlvbk1vZGFsIH0gPSBhd2FpdCBpbXBvcnQoJy4vY29uZmlybWF0aW9uLW1vZGFsJyk7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IENvbmZpcm1hdGlvbk1vZGFsKHRoaXMuYXBwLCB7XG4gICAgICAgICAgICB0aXRsZSxcbiAgICAgICAgICAgIG1lc3NhZ2UsXG4gICAgICAgICAgICBjb25maXJtVGV4dCxcbiAgICAgICAgICAgIGNhbmNlbFRleHQsXG4gICAgICAgICAgICBpc0Rhbmdlcm91c1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG1vZGFsLm9wZW5BbmRXYWl0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRm9yY2UgbW9kYWwgdmlzaWJpbGl0eSAoZm9yIHN0dWJib3JuIG1vZGFscylcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgZm9yY2VWaXNpYmxlKCk6IHZvaWQge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIERPTVV0aWxzLnNldHVwTW9kYWxTdHlsaW5nKHRoaXMubW9kYWxFbCk7XG4gICAgICAgIH0sIFRJTUVPVVRTLlJFUEFJTlRfREVMQVkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFuIHVwIG9uIGNsb3NlIHdpdGggcHJvcGVyIGRpc3Bvc2FsXG4gICAgICovXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZygnW3lvdXR1YmUtY2xpcHBlcl0gQ2xlYW5pbmcgdXAgbW9kYWwnKTtcbiAgICAgICAgXG4gICAgICAgIC8vIE1hcmsgYXMgZGlzcG9zZWQgdG8gcHJldmVudCBkb3VibGUgY2xlYW51cFxuICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2xlYXIgY29udGVudFxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgICAgIFxuICAgICAgICAvLyBSZW1vdmUgdW5pcXVlIGNsYXNzZXMgYW5kIGF0dHJpYnV0ZXNcbiAgICAgICAgdGhpcy5tb2RhbEVsLnJlbW92ZUNsYXNzKE1PREFMX0NTU19DTEFTU0VTLm1vZGFsKTtcbiAgICAgICAgdGhpcy5tb2RhbEVsLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1wbHVnaW4nKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdbeW91dHViZS1jbGlwcGVyXSBNb2RhbCBjbGVhbnVwIGNvbXBsZXRlJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWJzdHJhY3QgbWV0aG9kIGZvciBtb2RhbCBjb250ZW50IGNyZWF0aW9uXG4gICAgICovXG4gICAgYWJzdHJhY3Qgb25PcGVuKCk6IHZvaWQ7XG59XG4iLCAiZXhwb3J0IHsgZGVmYXVsdCB9IGZyb20gJy4vc3JjL21haW4nO1xuIiwgImltcG9ydCB7IE5vdGljZSwgUGx1Z2luLCBURmlsZSwgV29ya3NwYWNlTGVhZiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IENvbmZsaWN0UHJldmVudGlvbiB9IGZyb20gJy4vdXRpbHMvY29uZmxpY3QtcHJldmVudGlvbic7XG5pbXBvcnQgeyBNRVNTQUdFUyB9IGZyb20gJy4vY29uc3RhbnRzL21lc3NhZ2VzJztcbmltcG9ydCB7IFZhbGlkYXRpb25VdGlscyB9IGZyb20gJy4vdXRpbHMvdmFsaWRhdGlvbic7XG5pbXBvcnQgeyBFcnJvckhhbmRsZXIgfSBmcm9tICcuL3V0aWxzL2Vycm9yLWhhbmRsZXInO1xuaW1wb3J0IHsgU2F2ZUNvbmZpcm1hdGlvbk1vZGFsIH0gZnJvbSAnLi9jb21wb25lbnRzL21vZGFscy9zYXZlLWNvbmZpcm1hdGlvbi1tb2RhbCc7XG5pbXBvcnQgeyBZb3VUdWJlVXJsTW9kYWwgfSBmcm9tICcuL2NvbXBvbmVudHMvbW9kYWxzL3lvdXR1YmUtdXJsLW1vZGFsJztcbmltcG9ydCB7IFlvdVR1YmVTZXR0aW5nc1RhYiB9IGZyb20gJy4vY29tcG9uZW50cy9zZXR0aW5ncy9zZXR0aW5ncy10YWInO1xuaW1wb3J0IHsgU2VydmljZUNvbnRhaW5lciB9IGZyb20gJy4vc2VydmljZXMvc2VydmljZS1jb250YWluZXInO1xuaW1wb3J0IHsgT3V0cHV0Rm9ybWF0LCBZb3VUdWJlUGx1Z2luU2V0dGluZ3MgfSBmcm9tICcuL2ludGVyZmFjZXMvdHlwZXMnO1xuXG5jb25zdCBQTFVHSU5fUFJFRklYID0gJ3l0cCc7XG5cbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFlvdVR1YmVQbHVnaW5TZXR0aW5ncyA9IHtcbiAgICBnZW1pbmlBcGlLZXk6ICcnLFxuICAgIGdyb3FBcGlLZXk6ICcnLFxuICAgIG91dHB1dFBhdGg6ICdZb3VUdWJlL1Byb2Nlc3NlZCBWaWRlb3MnLFxuICAgIHVzZUVudmlyb25tZW50VmFyaWFibGVzOiBmYWxzZSxcbiAgICBlbnZpcm9ubWVudFByZWZpeDogJ1lUQycsXG4gICAgLy8gUGVyZm9ybWFuY2Ugc2V0dGluZ3Mgd2l0aCBzbWFydCBkZWZhdWx0c1xuICAgIHBlcmZvcm1hbmNlTW9kZTogJ2JhbGFuY2VkJyxcbiAgICBlbmFibGVQYXJhbGxlbFByb2Nlc3Npbmc6IHRydWUsXG4gICAgcHJlZmVyTXVsdGltb2RhbDogdHJ1ZVxufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgWW91dHViZUNsaXBwZXJQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHByaXZhdGUgc2V0dGluZ3M6IFlvdVR1YmVQbHVnaW5TZXR0aW5ncyA9IERFRkFVTFRfU0VUVElOR1M7XG4gICAgcHJpdmF0ZSBzZXJ2aWNlQ29udGFpbmVyPzogU2VydmljZUNvbnRhaW5lcjtcbiAgICBwcml2YXRlIHJpYmJvbkljb24/OiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIGlzVW5sb2FkaW5nID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBvcGVyYXRpb25Db3VudCA9IDA7XG4gICAgLy8gVHJhY2sgdGVtcCBub3RlcyB3ZSd2ZSBhbHJlYWR5IGhhbmRsZWQgdG8gYXZvaWQgZHVwbGljYXRlIG1vZGFsIG9wZW5zXG4gICAgcHJpdmF0ZSBoYW5kbGVkVGVtcEZpbGVzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcblxuICAgIGFzeW5jIG9ubG9hZCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5sb2dJbmZvKCdJbml0aWFsaXppbmcgWW91dHViZUNsaXBwZXIgUGx1Z2luIHYxLjIuMC4uLicpO1xuICAgICAgICBjb25zdCBjb25mbGljdHMgPSBDb25mbGljdFByZXZlbnRpb24uY2hlY2tGb3JQb3RlbnRpYWxDb25mbGljdHMoKTtcbiAgICAgICAgaWYgKGNvbmZsaWN0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ1dhcm5pbmcoYFBvdGVudGlhbCBjb25mbGljdHMgZGV0ZWN0ZWQgYnV0IHByb2NlZWRpbmc6ICR7Y29uZmxpY3RzLmpvaW4oJywgJyl9YCk7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZVNlcnZpY2VzKCk7XG4gICAgICAgICAgICB0aGlzLnJlZ2lzdGVyVUlDb21wb25lbnRzKCk7XG5cbiAgICAgICAgICAgIC8vIExpc3RlbiBmb3Igbm90ZXMgY3JlYXRlZCB2aWEgT2JzaWRpYW4gVVJJLiBUaGUgZXh0ZW5zaW9uIGFwcGVuZHMgYVxuICAgICAgICAgICAgLy8gaGlkZGVuIG1hcmtlciB0byBjcmVhdGVkIG5vdGVzIHNvIHdlIGNhbiByZWxpYWJseSBkZXRlY3QgdGhlbS5cbiAgICAgICAgICAgIGNvbnN0IE5PVEVfTUFSS0VSID0gJzwhLS0geXRjLWV4dGVuc2lvbjp5b3V0dWJlLWNsaXBwZXIgLS0+JztcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC52YXVsdC5vbignY3JlYXRlJywgYXN5bmMgKGZpbGUpID0+IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUgYXMgVEZpbGUpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEhldXJpc3RpY3MgdG8gZGV0ZWN0IHRlbXBvcmFyeSBub3RlcyBjcmVhdGVkIGJ5IHRoZSBDaHJvbWUgZXh0ZW5zaW9uOlxuICAgICAgICAgICAgICAgICAgICAvLyAtIENvbnRhaW5zIHRoZSBoaWRkZW4gbWFya2VyLCBPUlxuICAgICAgICAgICAgICAgICAgICAvLyAtIEZpbGUgbmFtZSBzdGFydHMgd2l0aCB0aGUga25vd24gcHJlZml4LCBPUlxuICAgICAgICAgICAgICAgICAgICAvLyAtIFRoZSBlbnRpcmUgZmlsZSBjb250ZW50IGlzIGEgc2luZ2xlIFlvdVR1YmUgVVJMIChjb21tb24gd2hlbiBPYnNpZGlhblxuICAgICAgICAgICAgICAgICAgICAvLyAgIG9wZW5zIGFuIGV4aXN0aW5nIGZpbGUgb3Igc3RyaXBzIGNvbW1lbnRzKS5cbiAgICAgICAgICAgICAgICAgICAgbGV0IHVybDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQgJiYgY29udGVudC5pbmNsdWRlcyhOT1RFX01BUktFUikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IGNvbnRlbnQucmVwbGFjZShOT1RFX01BUktFUiwgJycpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyeSB0byBmaW5kIHRoZSBmaXJzdCBZb3VUdWJlIFVSTCBhbnl3aGVyZSBpbiB0aGUgY29udGVudFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF5YmUgPSAoY29udGVudCB8fCAnJykudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVnZXggdG8gY2FwdHVyZSBjb21tb24gWW91VHViZSB3YXRjaCBVUkxzIGFuZCB5b3V0dS5iZSBsaW5rc1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeXRSZWdleCA9IC8oaHR0cHM/OlxcL1xcLyg/Ond3d1xcLik/eW91dHViZVxcLmNvbVxcL3dhdGNoXFw/dj1bQS1aYS16MC05Xy1dezYsfXxodHRwcz86XFwvXFwvKD86d3d3XFwuKT95b3V0dVxcLmJlXFwvW0EtWmEtejAtOV8tXXs2LH0pL2k7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtID0gbWF5YmUubWF0Y2goeXRSZWdleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobSAmJiBtWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gbVsxXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGUubmFtZSAmJiBmaWxlLm5hbWUuc3RhcnRzV2l0aCgnWW91VHViZSBDbGlwIC0nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZhbGxiYWNrOiBpZiBmaWxlbmFtZSBtYXRjaGVzIGFuZCBjb250ZW50IGlzIGEgc2luZ2xlIHRva2VuIHBvc3NpYmx5IFVSTFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNpbmdsZSA9IG1heWJlLnNwbGl0KCdcXG4nKS5tYXAocyA9PiBzLnRyaW0oKSkuZmluZChCb29sZWFuKSB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoVmFsaWRhdGlvblV0aWxzLmlzVmFsaWRZb3VUdWJlVXJsKHNpbmdsZSkpIHVybCA9IHNpbmdsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICghdXJsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdZb3VUdWJlQ2xpcHBlcjogY3JlYXRlIGhhbmRsZXIgLSBubyB1cmwgZXh0cmFjdGVkIGZvcicsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdZb3VUdWJlQ2xpcHBlcjogZGV0ZWN0ZWQgdGVtcCBub3RlJywgeyBwYXRoOiBmaWxlLnBhdGgsIHVybCB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBEZWZlciBzbGlnaHRseSBzbyB0aGUgVUkgc2V0dGxlcywgdGhlbiBvcGVuIHRoZSBtb2RhbCB3aXRoIHRoZSBVUkxcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdZb3VUdWJlQ2xpcHBlcjogb3BlbmluZyBtb2RhbCBmb3InLCB1cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCB0aGlzLnNhZmVTaG93VXJsTW9kYWwodXJsISk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBLZWVwIHRoZSB0ZW1wb3Jhcnkgbm90ZSBmb3IgZGVidWdnaW5nLiBEbyBub3QgZGVsZXRlIGl0IGhlcmUuXG4gICAgICAgICAgICAgICAgICAgIH0sIDMwMCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBzd2FsbG93OyBub24tY3JpdGljYWxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIC8vIEFsc28gbGlzdGVuIGZvciB3aGVuIGEgZmlsZSBiZWNvbWVzIGFjdGl2ZSAob3BlbmVkKS4gU29tZSBPYnNpZGlhblxuICAgICAgICAgICAgLy8gVVJMIGZsb3dzIGNyZWF0ZSB0aGUgZmlsZSBhbmQgaW1tZWRpYXRlbHkgb3BlbiBpdDsgZGV0ZWN0aW5nIHRoZVxuICAgICAgICAgICAgLy8gYWN0aXZlIGxlYWYgZW5zdXJlcyB3ZSBjYXRjaCBub3RlcyBjcmVhdGVkIHdpdGhvdXQgZmlyaW5nIGEgY3JlYXRlXG4gICAgICAgICAgICAvLyBldmVudCBpbiB0aW1lIGZvciBvdXIgaGFuZGxlci5cbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2FjdGl2ZS1sZWFmLWNoYW5nZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oYW5kbGVkVGVtcEZpbGVzLmhhcyhmaWxlLnBhdGgpKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSBhcyBURmlsZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQXR0ZW1wdCBzYW1lIFVSTCBleHRyYWN0aW9uIGxvZ2ljIGFzIGNyZWF0ZSBoYW5kbGVyXG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmw6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29udGVudCAmJiBjb250ZW50LmluY2x1ZGVzKE5PVEVfTUFSS0VSKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gY29udGVudC5yZXBsYWNlKE5PVEVfTUFSS0VSLCAnJykudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF5YmUgPSAoY29udGVudCB8fCAnJykudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeXRSZWdleCA9IC8oaHR0cHM/OlxcL1xcLyg/Ond3d1xcLik/eW91dHViZVxcLmNvbVxcL3dhdGNoXFw/dj1bQS1aYS16MC05Xy1dezYsfXxodHRwcz86XFwvXFwvKD86d3d3XFwuKT95b3V0dVxcLmJlXFwvW0EtWmEtejAtOV8tXXs2LH0pL2k7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtID0gbWF5YmUubWF0Y2goeXRSZWdleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobSAmJiBtWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gbVsxXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGUubmFtZSAmJiBmaWxlLm5hbWUuc3RhcnRzV2l0aCgnWW91VHViZSBDbGlwIC0nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNpbmdsZSA9IG1heWJlLnNwbGl0KCdcXG4nKS5tYXAocyA9PiBzLnRyaW0oKSkuZmluZChCb29sZWFuKSB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoVmFsaWRhdGlvblV0aWxzLmlzVmFsaWRZb3VUdWJlVXJsKHNpbmdsZSkpIHVybCA9IHNpbmdsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICghdXJsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdZb3VUdWJlQ2xpcHBlcjogYWN0aXZlLWxlYWYtY2hhbmdlIC0gbm8gdXJsIGZvcicsIGZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdZb3VUdWJlQ2xpcHBlcjogYWN0aXZlLWxlYWYtY2hhbmdlIGRldGVjdGVkIHRlbXAgbm90ZScsIHsgcGF0aDogZmlsZS5wYXRoLCB1cmwgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlZFRlbXBGaWxlcy5hZGQoZmlsZS5wYXRoKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBPcGVuIG1vZGFsIChkb24ndCBkZWxldGUgdGhlIHRlbXAgbm90ZSBhdXRvbWF0aWNhbGx5KVxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ1lvdVR1YmVDbGlwcGVyOiBvcGVuaW5nIG1vZGFsIChhY3RpdmUtbGVhZikgZm9yJywgdXJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5zYWZlU2hvd1VybE1vZGFsKHVybCEpO1xuICAgICAgICAgICAgICAgICAgICB9LCAyNTApO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICB0aGlzLmxvZ0luZm8oJ1lvdXR1YmVDbGlwcGVyIFBsdWdpbiBsb2FkZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICAgICAgICAvLyBSZWdpc3RlciBhIGN1c3RvbSBwcm90b2NvbCBoYW5kbGVyIHNvIGV4dGVybmFsIGFwcHMgKG9yIHRoZVxuICAgICAgICAgICAgLy8gQ2hyb21lIGV4dGVuc2lvbikgY2FuIG9wZW4gYW4gVVJJIGxpa2U6XG4gICAgICAgICAgICAvLyBvYnNpZGlhbjovL3lvdXR1YmUtY2xpcHBlcj92YXVsdD1WQVVMVCZ1cmw9PHZpZGVvVXJsPlxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBgcmVnaXN0ZXJPYnNpZGlhblByb3RvY29sSGFuZGxlcmAgaXMgYXZhaWxhYmxlIGluIE9ic2lkaWFuJ3NcbiAgICAgICAgICAgICAgICAvLyBQbHVnaW4gQVBJLiBJdCBnaXZlcyB1cyBhIGNsZWFuIHdheSB0byByZWNlaXZlIGEgVVJMIGRpcmVjdGx5XG4gICAgICAgICAgICAgICAgLy8gZnJvbSB0aGUgZXh0ZW5zaW9uIHdpdGhvdXQgY3JlYXRpbmcgdGVtcG9yYXJ5IG5vdGVzLlxuICAgICAgICAgICAgICAgIC8vIFRoZSBoYW5kbGVyIHJlY2VpdmVzIGEgcGFyYW1zIG9iamVjdCB3aXRoIHF1ZXJ5IHBhcmFtZXRlcnMuXG4gICAgICAgICAgICAgICAgLy8gRXhhbXBsZSBpbnZvY2F0aW9uOiBvYnNpZGlhbjovL3lvdXR1YmUtY2xpcHBlcj92YXVsdD1NeVZhdWx0JnVybD08ZW5jb2RlZD5cbiAgICAgICAgICAgICAgICAvLyBXZSdsbCBvcGVuIHRoZSBtb2RhbCB3aXRoIHRoZSBwcm92aWRlZCBVUkwuXG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudFxuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICB0aGlzLnJlZ2lzdGVyT2JzaWRpYW5Qcm90b2NvbEhhbmRsZXI/LigneW91dHViZS1jbGlwcGVyJywgKHBhcmFtczogUmVjb3JkPHN0cmluZywgc3RyaW5nPikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdXJsID0gcGFyYW1zLnVybCB8fCBwYXJhbXMuY29udGVudCB8fCBwYXJhbXMucGF0aCB8fCAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1cmwgJiYgVmFsaWRhdGlvblV0aWxzLmlzVmFsaWRZb3VUdWJlVXJsKHVybCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEZWZlciBpbnRvIHRoZSBwbHVnaW4gbWFpbiBsb29wXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5zYWZlU2hvd1VybE1vZGFsKHVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMjAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnWW91VHViZUNsaXBwZXI6IHByb3RvY29sIGhhbmRsZXIgcmVjZWl2ZWQgbm8gdmFsaWQgdXJsJywgcGFyYW1zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdZb3VUdWJlQ2xpcHBlcjogcHJvdG9jb2wgaGFuZGxlciBlcnJvcicsIGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gTm90IGZhdGFsIGlmIEFQSSBtaXNzaW5nXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ0Vycm9yKCdGYWlsZWQgdG8gbG9hZCBwbHVnaW4nLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICAgICAgICBFcnJvckhhbmRsZXIuaGFuZGxlKGVycm9yIGFzIEVycm9yLCAnUGx1Z2luIGluaXRpYWxpemF0aW9uJyk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdGYWlsZWQgdG8gbG9hZCBZb3V0dWJlQ2xpcHBlciBQbHVnaW4uIENoZWNrIGNvbnNvbGUgZm9yIGRldGFpbHMuJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbnVubG9hZCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5sb2dJbmZvKCdVbmxvYWRpbmcgWW91dHViZUNsaXBwZXIgUGx1Z2luLi4uJyk7XG4gICAgICAgIHRoaXMuaXNVbmxvYWRpbmcgPSB0cnVlO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VDb250YWluZXI/LmNsZWFyU2VydmljZXMoKTtcbiAgICAgICAgICAgIHRoaXMuY2xlYW51cFVJRWxlbWVudHMoKTtcbiAgICAgICAgICAgIENvbmZsaWN0UHJldmVudGlvbi5jbGVhbnVwQWxsRWxlbWVudHMoKTtcbiAgICAgICAgICAgIHRoaXMubG9nSW5mbygnWW91dHViZUNsaXBwZXIgUGx1Z2luIHVubG9hZGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5sb2dFcnJvcignRXJyb3IgZHVyaW5nIHBsdWdpbiB1bmxvYWQnLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGluaXRpYWxpemVTZXJ2aWNlcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5zZXJ2aWNlQ29udGFpbmVyID0gbmV3IFNlcnZpY2VDb250YWluZXIodGhpcy5zZXR0aW5ncywgdGhpcy5hcHApO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVnaXN0ZXJVSUNvbXBvbmVudHMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucmliYm9uSWNvbiA9IHRoaXMuYWRkUmliYm9uSWNvbigndmlkZW8nLCAnUHJvY2VzcyBZb3VUdWJlIFZpZGVvJywgKCkgPT4ge1xuICAgICAgICAgICAgdm9pZCB0aGlzLnNhZmVTaG93VXJsTW9kYWwoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBgJHtQTFVHSU5fUFJFRklYfS1wcm9jZXNzLXlvdXR1YmUtdmlkZW9gLFxuICAgICAgICAgICAgbmFtZTogJ1Byb2Nlc3MgWW91VHViZSBWaWRlbycsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5zYWZlU2hvd1VybE1vZGFsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgWW91VHViZVNldHRpbmdzVGFiKHRoaXMuYXBwLCB7XG4gICAgICAgICAgICBwbHVnaW46IHRoaXMsXG4gICAgICAgICAgICBvblNldHRpbmdzQ2hhbmdlOiB0aGlzLmhhbmRsZVNldHRpbmdzQ2hhbmdlLmJpbmQodGhpcylcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vIENvbW1hbmQgdXNlZCBieSBBZHZhbmNlZCBVUkkgb3Igb3RoZXIgZXh0ZXJuYWwgY2FsbGVycy4gVGhpcyBjb21tYW5kXG4gICAgICAgIC8vIHJlYWRzIHRoZSBjbGlwYm9hcmQgKHRoZSBDaHJvbWUgZXh0ZW5zaW9uIGNvcGllcyB0aGUgVVJMIHRoZXJlKSBhbmRcbiAgICAgICAgLy8gb3BlbnMgdGhlIFlvdVR1YmUgVVJMIG1vZGFsIHdpdGggdGhhdCBVUkwuIFRoaXMgYWxsb3dzIHRoZSBleHRlbnNpb25cbiAgICAgICAgLy8gdG8gaW52b2tlIHRoZSBjb21tYW5kIHdpdGhvdXQgcGFzc2luZyBhcmdzLlxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IGAke1BMVUdJTl9QUkVGSVh9LW9wZW4tdXJsLWZyb20tY2xpcGJvYXJkYCxcbiAgICAgICAgICAgIG5hbWU6ICdZb3VUdWJlIENsaXBwZXI6IE9wZW4gVVJMIE1vZGFsIChmcm9tIGNsaXBib2FyZCknLFxuICAgICAgICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBUcnkgY2xpcGJvYXJkIGZpcnN0XG4gICAgICAgICAgICAgICAgICAgIGxldCB0ZXh0ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBuYXZpZ2F0b3IuY2xpcGJvYXJkIG1heSBub3QgYmUgYXZhaWxhYmxlIGluIGFsbCBob3N0c1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gKGJ1dCB1c3VhbGx5IGlzIGluIE9ic2lkaWFuIHJlbmRlcmVyKS5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXRzLWNvbW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYXZpZ2F0b3IgJiYgbmF2aWdhdG9yLmNsaXBib2FyZCAmJiBuYXZpZ2F0b3IuY2xpcGJvYXJkLnJlYWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gKGF3YWl0IG5hdmlnYXRvci5jbGlwYm9hcmQucmVhZFRleHQoKSkgfHwgJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ZXh0ICYmIFZhbGlkYXRpb25VdGlscy5pc1ZhbGlkWW91VHViZVVybCh0ZXh0LnRyaW0oKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5zYWZlU2hvd1VybE1vZGFsKHRleHQudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIE5vIHZhbGlkIFVSTCBvbiBjbGlwYm9hcmQgXHUyMDE0IHByb21wdCB0aGUgdXNlciB0byBwYXN0ZSBvbmUuXG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSBhIHNpbXBsZSBwcm9tcHQgc2luY2UgdGhpcyBpcyBhIGZhbGxiYWNrIHBhdGguXG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1hbGVydFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYW51YWwgPSB3aW5kb3cucHJvbXB0KCdQYXN0ZSBZb3VUdWJlIFVSTCB0byBvcGVuIGluIFlvdVR1YmUgQ2xpcHBlcjonKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hbnVhbCAmJiBWYWxpZGF0aW9uVXRpbHMuaXNWYWxpZFlvdVR1YmVVcmwobWFudWFsLnRyaW0oKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5zYWZlU2hvd1VybE1vZGFsKG1hbnVhbC50cmltKCkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnTm8gdmFsaWQgWW91VHViZSBVUkwgcHJvdmlkZWQuJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBFcnJvckhhbmRsZXIuaGFuZGxlKGVycm9yIGFzIEVycm9yLCAnT3BlbiBVUkwgZnJvbSBjbGlwYm9hcmQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgY2xlYW51cFVJRWxlbWVudHMoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnJpYmJvbkljb24pIHtcbiAgICAgICAgICAgIHRoaXMucmliYm9uSWNvbi5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMucmliYm9uSWNvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgc2FmZVNob3dVcmxNb2RhbChpbml0aWFsVXJsPzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2FmZU9wZXJhdGlvbihhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9wZW5Zb3VUdWJlVXJsTW9kYWwoaW5pdGlhbFVybCk7XG4gICAgICAgIH0sICdTaG93IFVSTCBNb2RhbCcpO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgc2FmZU9wZXJhdGlvbjxUPihvcGVyYXRpb246ICgpID0+IFByb21pc2U8VD4sIG9wZXJhdGlvbk5hbWU6IHN0cmluZyk6IFByb21pc2U8VCB8IG51bGw+IHtcbiAgICAgICAgaWYgKHRoaXMuaXNVbmxvYWRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMubG9nV2FybmluZyhgQXR0ZW1wdGVkICR7b3BlcmF0aW9uTmFtZX0gZHVyaW5nIHBsdWdpbiB1bmxvYWQgLSBza2lwcGluZ2ApO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBvcElkID0gKyt0aGlzLm9wZXJhdGlvbkNvdW50O1xuICAgICAgICB0aGlzLmxvZ0luZm8oYFN0YXJ0aW5nIG9wZXJhdGlvbiAke29wSWR9OiAke29wZXJhdGlvbk5hbWV9YCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG9wZXJhdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5sb2dJbmZvKGBDb21wbGV0ZWQgb3BlcmF0aW9uICR7b3BJZH06ICR7b3BlcmF0aW9uTmFtZX1gKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ0Vycm9yKGBGYWlsZWQgb3BlcmF0aW9uICR7b3BJZH06ICR7b3BlcmF0aW9uTmFtZX1gLCBlcnJvciBhcyBFcnJvcik7XG4gICAgICAgICAgICBFcnJvckhhbmRsZXIuaGFuZGxlKGVycm9yIGFzIEVycm9yLCBvcGVyYXRpb25OYW1lKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvcGVuWW91VHViZVVybE1vZGFsKGluaXRpYWxVcmw/OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuaXNVbmxvYWRpbmcpIHtcbiAgICAgICAgICAgIENvbmZsaWN0UHJldmVudGlvbi5sb2coJ1BsdWdpbiBpcyB1bmxvYWRpbmcsIGlnbm9yaW5nIG1vZGFsIHJlcXVlc3QnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIENvbmZsaWN0UHJldmVudGlvbi5zYWZlT3BlcmF0aW9uKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vIFByb3ZpZGUgYXZhaWxhYmxlIEFJIHByb3ZpZGVycyBhbmQgbW9kZWwgb3B0aW9ucyB0byB0aGUgbW9kYWwgZm9yIHNlbGVjdGlvblxuICAgICAgICAgICAgY29uc3QgYWlTZXJ2aWNlID0gdGhpcy5zZXJ2aWNlQ29udGFpbmVyPy5haVNlcnZpY2U7XG4gICAgICAgICAgICBjb25zdCBwcm92aWRlcnMgPSBhaVNlcnZpY2UgPyBhaVNlcnZpY2UuZ2V0UHJvdmlkZXJOYW1lcygpIDogW107XG4gICAgICAgICAgICAvLyBQcmVmZXIgY2FjaGVkIG1vZGVsIG9wdGlvbnMgZnJvbSBzZXR0aW5ncyBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgIGNvbnN0IG1vZGVsT3B0aW9uc01hcDogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0gdGhpcy5zZXR0aW5ncy5tb2RlbE9wdGlvbnNDYWNoZSB8fCB7fTtcbiAgICAgICAgICAgIGlmIChhaVNlcnZpY2UgJiYgKCF0aGlzLnNldHRpbmdzLm1vZGVsT3B0aW9uc0NhY2hlIHx8IE9iamVjdC5rZXlzKHRoaXMuc2V0dGluZ3MubW9kZWxPcHRpb25zQ2FjaGUpLmxlbmd0aCA9PT0gMCkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHAgb2YgcHJvdmlkZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsT3B0aW9uc01hcFtwXSA9IGFpU2VydmljZS5nZXRQcm92aWRlck1vZGVscyhwKSB8fCBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG5ldyBZb3VUdWJlVXJsTW9kYWwodGhpcy5hcHAsIHtcbiAgICAgICAgICAgICAgICBvblByb2Nlc3M6IHRoaXMucHJvY2Vzc1lvdVR1YmVWaWRlby5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgIG9uT3BlbkZpbGU6IHRoaXMub3BlbkZpbGVCeVBhdGguYmluZCh0aGlzKSxcbiAgICAgICAgICAgICAgICBpbml0aWFsVXJsOiBpbml0aWFsVXJsLFxuICAgICAgICAgICAgICAgIHByb3ZpZGVycyxcbiAgICAgICAgICAgICAgICBtb2RlbE9wdGlvbnM6IG1vZGVsT3B0aW9uc01hcCxcbiAgICAgICAgICAgICAgICBmZXRjaE1vZGVsczogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBBc2sgdGhlIGFpU2VydmljZSB0byB0cnkgdG8gZmV0Y2ggbGF0ZXN0IG1vZGVscyBmb3IgYWxsIHByb3ZpZGVyc1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWFwID0gYXdhaXQgKHRoaXMuc2VydmljZUNvbnRhaW5lciEuYWlTZXJ2aWNlIGFzIGFueSkuZmV0Y2hMYXRlc3RNb2RlbHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBlcnNpc3QgdG8gc2V0dGluZ3Mgc28gZnV0dXJlIG1vZGFsIG9wZW5zIHVzZSBjYWNoZWQgbGlzdHNcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubW9kZWxPcHRpb25zQ2FjaGUgPSBtYXA7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hcDtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb2RlbE9wdGlvbnNNYXA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5vcGVuKCk7XG4gICAgICAgIH0sICdZb3VUdWJlIFVSTCBNb2RhbCcpLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgRXJyb3JIYW5kbGVyLmhhbmRsZShlcnJvciBhcyBFcnJvciwgJ09wZW5pbmcgWW91VHViZSBVUkwgbW9kYWwnKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBwcm9jZXNzWW91VHViZVZpZGVvKHVybDogc3RyaW5nLCBmb3JtYXQ6IE91dHB1dEZvcm1hdCA9ICdkZXRhaWxlZC1ndWlkZScsIHByb3ZpZGVyTmFtZT86IHN0cmluZywgbW9kZWw/OiBzdHJpbmcsIGN1c3RvbVByb21wdD86IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGlmICh0aGlzLmlzVW5sb2FkaW5nKSB7XG4gICAgICAgICAgICBDb25mbGljdFByZXZlbnRpb24ubG9nKCdQbHVnaW4gaXMgdW5sb2FkaW5nLCBjYW5jZWxsaW5nIHZpZGVvIHByb2Nlc3NpbmcnKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUGx1Z2luIGlzIHNodXR0aW5nIGRvd24nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IENvbmZsaWN0UHJldmVudGlvbi5zYWZlT3BlcmF0aW9uKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoTUVTU0FHRVMuUFJPQ0VTU0lORyk7XG5cbiAgICAgICAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSBWYWxpZGF0aW9uVXRpbHMudmFsaWRhdGVTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb25maWd1cmF0aW9uIGludmFsaWQ6ICR7dmFsaWRhdGlvbi5lcnJvcnMuam9pbignLCAnKX1gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgeW91dHViZVNlcnZpY2UgPSB0aGlzLnNlcnZpY2VDb250YWluZXIhLnZpZGVvU2VydmljZTtcbiAgICAgICAgICAgIGNvbnN0IGFpU2VydmljZSA9IHRoaXMuc2VydmljZUNvbnRhaW5lciEuYWlTZXJ2aWNlO1xuICAgICAgICAgICAgY29uc3QgZmlsZVNlcnZpY2UgPSB0aGlzLnNlcnZpY2VDb250YWluZXIhLmZpbGVTZXJ2aWNlO1xuICAgICAgICAgICAgY29uc3QgcHJvbXB0U2VydmljZSA9IHRoaXMuc2VydmljZUNvbnRhaW5lciEucHJvbXB0U2VydmljZTtcblxuICAgICAgICAgICAgY29uc3QgdmlkZW9JZCA9IHlvdXR1YmVTZXJ2aWNlLmV4dHJhY3RWaWRlb0lkKHVybCk7XG4gICAgICAgICAgICBpZiAoIXZpZGVvSWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTUVTU0FHRVMuRVJST1JTLlZJREVPX0lEX0VYVFJBQ1RJT04pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCB2aWRlb0RhdGEgPSBhd2FpdCB5b3V0dWJlU2VydmljZS5nZXRWaWRlb0RhdGEodmlkZW9JZCk7XG4gICAgICAgICAgICAvLyBGb3IgJ2N1c3RvbScgZm9ybWF0LCB1c2UgdGhlIHByb3ZpZGVkIGN1c3RvbSBwcm9tcHQ7IG90aGVyd2lzZSBjaGVjayBzZXR0aW5nc1xuICAgICAgICAgICAgbGV0IHByb21wdFRvVXNlOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICAgICAgICBpZiAoZm9ybWF0ID09PSAnY3VzdG9tJykge1xuICAgICAgICAgICAgICAgIHByb21wdFRvVXNlID0gY3VzdG9tUHJvbXB0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcm9tcHRUb1VzZSA9IHRoaXMuc2V0dGluZ3MuY3VzdG9tUHJvbXB0cz8uW2Zvcm1hdF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSBwcm9tcHRTZXJ2aWNlLmNyZWF0ZUFuYWx5c2lzUHJvbXB0KHZpZGVvRGF0YSwgdXJsLCBmb3JtYXQsIHByb21wdFRvVXNlKTtcbiAgICAgICAgICAgIGxldCBhaVJlc3BvbnNlO1xuICAgICAgICAgICAgaWYgKHByb3ZpZGVyTmFtZSkge1xuICAgICAgICAgICAgICAgIC8vIFVzZSBzZWxlY3RlZCBwcm92aWRlciBhbmQgb3B0aW9uYWwgbW9kZWwgb3ZlcnJpZGVcbiAgICAgICAgICAgICAgICBhaVJlc3BvbnNlID0gYXdhaXQgKGFpU2VydmljZSBhcyBhbnkpLnByb2Nlc3NXaXRoKHByb3ZpZGVyTmFtZSwgcHJvbXB0LCBtb2RlbCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGFpUmVzcG9uc2UgPSBhd2FpdCBhaVNlcnZpY2UucHJvY2Vzcyhwcm9tcHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkQ29udGVudCA9IHByb21wdFNlcnZpY2UucHJvY2Vzc0FJUmVzcG9uc2UoXG4gICAgICAgICAgICAgICAgYWlSZXNwb25zZS5jb250ZW50LFxuICAgICAgICAgICAgICAgIGFpUmVzcG9uc2UucHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgYWlSZXNwb25zZS5tb2RlbCxcbiAgICAgICAgICAgICAgICBmb3JtYXQsXG4gICAgICAgICAgICAgICAgdmlkZW9EYXRhLFxuICAgICAgICAgICAgICAgIHVybFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBhd2FpdCBmaWxlU2VydmljZS5zYXZlVG9GaWxlKFxuICAgICAgICAgICAgICAgIHZpZGVvRGF0YS50aXRsZSxcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRDb250ZW50LFxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Mub3V0cHV0UGF0aFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgbmV3IE5vdGljZShNRVNTQUdFUy5TVUNDRVNTKHZpZGVvRGF0YS50aXRsZSkpO1xuICAgICAgICAgICAgcmV0dXJuIGZpbGVQYXRoO1xuICAgICAgICB9LCAnWW91VHViZSBWaWRlbyBQcm9jZXNzaW5nJyk7XG5cbiAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHByb2Nlc3MgWW91VHViZSB2aWRlbycpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIG9wZW5GaWxlQnlQYXRoKGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDMwMCkpO1xuICAgICAgICAgICAgY29uc3QgY2xlYW5QYXRoID0gZmlsZVBhdGguc3RhcnRzV2l0aCgnLycpID8gZmlsZVBhdGguc3Vic3RyaW5nKDEpIDogZmlsZVBhdGg7XG4gICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGNsZWFuUGF0aCk7XG5cbiAgICAgICAgICAgIGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGUgbm90IGZvdW5kIGF0IHBhdGg6ICR7Y2xlYW5QYXRofWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhd2FpdCB0aGlzLm9wZW5GaWxlSW5OZXdUYWIoZmlsZSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBFcnJvckhhbmRsZXIuaGFuZGxlKGVycm9yIGFzIEVycm9yLCAnT3BlbmluZyBmaWxlIGJ5IHBhdGgnKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBvcGVuRmlsZUluTmV3VGFiKGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoJ3RhYicpIGFzIFdvcmtzcGFjZUxlYWY7XG4gICAgICAgICAgICBhd2FpdCBsZWFmLm9wZW5GaWxlKGZpbGUpO1xuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLnNldEFjdGl2ZUxlYWYobGVhZik7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBcdUQ4M0RcdURDQzIgT3BlbmVkOiAke2ZpbGUubmFtZX1gKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudExlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZihmYWxzZSk7XG4gICAgICAgICAgICAgICAgYXdhaXQgY3VycmVudExlYWYub3BlbkZpbGUoZmlsZSk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgXHVEODNEXHVEQ0MyIE9wZW5lZDogJHtmaWxlLm5hbWV9YCk7XG4gICAgICAgICAgICB9IGNhdGNoIChmYWxsYmFja0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgRXJyb3JIYW5kbGVyLmhhbmRsZShmYWxsYmFja0Vycm9yIGFzIEVycm9yLCAnT3BlbmluZyBmaWxlIGluIGN1cnJlbnQgdGFiJyk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgTm90ZSBzYXZlZCBhcyBcIiR7ZmlsZS5uYW1lfVwiIGJ1dCBjb3VsZCBub3QgYXV0by1vcGVuLiBQbGVhc2Ugb3BlbiBtYW51YWxseS5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgc2hvd1BlcnNpc3RlbnRTYXZlQ29uZmlybWF0aW9uKGZpbGU6IFRGaWxlKTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBTYXZlQ29uZmlybWF0aW9uTW9kYWwodGhpcy5hcHAsIGZpbGUsIChzaG91bGRPcGVuKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHNob3VsZE9wZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgdm9pZCB0aGlzLm9wZW5GaWxlSW5OZXdUYWIoZmlsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBFcnJvckhhbmRsZXIuaGFuZGxlKGVycm9yIGFzIEVycm9yLCAnU2hvd2luZyBzYXZlIGNvbmZpcm1hdGlvbicpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShgRmlsZSBzYXZlZDogJHtmaWxlLm5hbWV9LiBDbGljayB0byBvcGVuLmAsIDApLm5vdGljZUVsLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdm9pZCB0aGlzLm9wZW5GaWxlSW5OZXdUYWIoZmlsZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVTZXR0aW5nc0NoYW5nZShuZXdTZXR0aW5nczogWW91VHViZVBsdWdpblNldHRpbmdzKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzID0geyAuLi5uZXdTZXR0aW5ncyB9O1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2VydmljZUNvbnRhaW5lcj8udXBkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBFcnJvckhhbmRsZXIuaGFuZGxlKGVycm9yIGFzIEVycm9yLCAnU2V0dGluZ3MgdXBkYXRlJyk7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgbG9hZFNldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHNhdmVTZXR0aW5ncygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBnZXRTZXJ2aWNlQ29udGFpbmVyKCk6IFNlcnZpY2VDb250YWluZXIgfCB1bmRlZmluZWQge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXJ2aWNlQ29udGFpbmVyO1xuICAgIH1cblxuICAgIHByaXZhdGUgbG9nSW5mbyhtZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgQ29uZmxpY3RQcmV2ZW50aW9uLmxvZyhgW0lORk9dICR7bWVzc2FnZX1gKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGxvZ1dhcm5pbmcobWVzc2FnZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIENvbmZsaWN0UHJldmVudGlvbi5sb2coYFtXQVJOXSAke21lc3NhZ2V9YCwgJ3dhcm4nKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGxvZ0Vycm9yKG1lc3NhZ2U6IHN0cmluZywgZXJyb3I6IEVycm9yKTogdm9pZCB7XG4gICAgICAgIENvbmZsaWN0UHJldmVudGlvbi5sb2coYFtFUlJPUl0gJHttZXNzYWdlfTogJHtlcnJvci5tZXNzYWdlfWAsICdlcnJvcicpO1xuICAgIH1cbn1cbiIsICIvKipcbiAqIENvbmZsaWN0IHByZXZlbnRpb24gdXRpbGl0aWVzIGZvciBZb3V0dWJlQ2xpcHBlciBQbHVnaW5cbiAqIERlc2lnbmVkIHRvIHByZXZlbnQgY29uZmxpY3RzIHdpdGggb3RoZXIgT2JzaWRpYW4gcGx1Z2luc1xuICovXG5cbmV4cG9ydCBjbGFzcyBDb25mbGljdFByZXZlbnRpb24ge1xuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFBMVUdJTl9JRCA9ICd5b3V0dWJlLWNsaXBwZXInO1xuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IENTU19QUkVGSVggPSAneXRjJztcbiAgICBcbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBhbm90aGVyIHBsdWdpbiBtaWdodCBiZSBjb25mbGljdGluZ1xuICAgICAqL1xuICAgIHN0YXRpYyBjaGVja0ZvclBvdGVudGlhbENvbmZsaWN0cygpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IHdhcm5pbmdzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgZm9yIFdlYkNsaXBwZXItbGlrZSBwbHVnaW5zXG4gICAgICAgIGNvbnN0IHN1c3BpY2lvdXNFbGVtZW50cyA9IFtcbiAgICAgICAgICAgICdkaXZbZGF0YS1wbHVnaW49XCJ3ZWItY2xpcHBlclwiXScsXG4gICAgICAgICAgICAnLndlYi1jbGlwcGVyLW1vZGFsJyxcbiAgICAgICAgICAgICcuY2xpcHBlci1idXR0b24nLFxuICAgICAgICAgICAgJ1tpZCo9XCJjbGlwcGVyXCJdJyxcbiAgICAgICAgICAgICdbY2xhc3MqPVwiY2xpcFwiXSdcbiAgICAgICAgXTtcbiAgICAgICAgXG4gICAgICAgIHN1c3BpY2lvdXNFbGVtZW50cy5mb3JFYWNoKHNlbGVjdG9yID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XG4gICAgICAgICAgICBpZiAoZWxlbWVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHdhcm5pbmdzLnB1c2goYERldGVjdGVkIHBvdGVudGlhbCBwbHVnaW4gY29uZmxpY3Q6ICR7c2VsZWN0b3J9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHdhcm5pbmdzO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBBZGQgY29uZmxpY3QgcHJldmVudGlvbiBhdHRyaWJ1dGVzIHRvIGFuIGVsZW1lbnRcbiAgICAgKi9cbiAgICBzdGF0aWMgbWFya0VsZW1lbnQoZWxlbWVudDogSFRNTEVsZW1lbnQsIHR5cGU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1wbHVnaW4nLCB0aGlzLlBMVUdJTl9JRCk7XG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXl0Yy10eXBlJywgdHlwZSk7XG4gICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoYCR7dGhpcy5DU1NfUFJFRklYfS0ke3R5cGV9YCk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBjb25mbGljdCBwcmV2ZW50aW9uIGF0dHJpYnV0ZXNcbiAgICAgKi9cbiAgICBzdGF0aWMgdW5tYXJrRWxlbWVudChlbGVtZW50OiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1wbHVnaW4nKTtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEteXRjLXR5cGUnKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlbW92ZSBhbGwgY2xhc3NlcyBzdGFydGluZyB3aXRoIG91ciBwcmVmaXhcbiAgICAgICAgY29uc3QgY2xhc3NlcyA9IEFycmF5LmZyb20oZWxlbWVudC5jbGFzc0xpc3QpO1xuICAgICAgICBjbGFzc2VzLmZvckVhY2goY2xhc3NOYW1lID0+IHtcbiAgICAgICAgICAgIGlmIChjbGFzc05hbWUuc3RhcnRzV2l0aCh0aGlzLkNTU19QUkVGSVgpKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmFtZXNwYWNlZCBJRCB0byBwcmV2ZW50IGNvbmZsaWN0c1xuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGVVbmlxdWVJZChiYXNlOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYCR7dGhpcy5DU1NfUFJFRklYfS0ke2Jhc2V9LSR7RGF0ZS5ub3coKX1gO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCBhbGwgcGx1Z2luIGVsZW1lbnRzIGZyb20gRE9NXG4gICAgICovXG4gICAgc3RhdGljIGNsZWFudXBBbGxFbGVtZW50cygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGBbZGF0YS1wbHVnaW49XCIke3RoaXMuUExVR0lOX0lEfVwiXWApO1xuICAgICAgICBlbGVtZW50cy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMudW5tYXJrRWxlbWVudChlbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIEdldCBzYWZlIHN0b3JhZ2Uga2V5IHdpdGggbmFtZXNwYWNlXG4gICAgICovXG4gICAgc3RhdGljIGdldFN0b3JhZ2VLZXkoa2V5OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYCR7dGhpcy5QTFVHSU5fSUR9LSR7a2V5fWA7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIExvZyBwbHVnaW4gYWN0aXZpdHkgd2l0aCBuYW1lc3BhY2VcbiAgICAgKi9cbiAgICBzdGF0aWMgbG9nKG1lc3NhZ2U6IHN0cmluZywgbGV2ZWw6ICdpbmZvJyB8ICd3YXJuJyB8ICdlcnJvcicgPSAnaW5mbycpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgICAgICBjb25zdCBsb2dNZXNzYWdlID0gYFske3RoaXMuUExVR0lOX0lEfV0gJHt0aW1lc3RhbXB9IC0gJHttZXNzYWdlfWA7XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggKGxldmVsKSB7XG4gICAgICAgICAgICBjYXNlICd3YXJuJzpcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4obG9nTWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdlcnJvcic6XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihsb2dNZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cobG9nTWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgcGx1Z2luIGlzIHNhZmUgdG8gb3BlcmF0ZVxuICAgICAqL1xuICAgIHN0YXRpYyBpc1NhZmVUb09wZXJhdGUoKTogYm9vbGVhbiB7XG4gICAgICAgIC8vIENoZWNrIGlmIHdlJ3JlIGluIGEgc2FmZSBzdGF0ZSB0byBvcGVyYXRlXG4gICAgICAgIGNvbnN0IGNvbmZsaWN0cyA9IHRoaXMuY2hlY2tGb3JQb3RlbnRpYWxDb25mbGljdHMoKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChjb25mbGljdHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5sb2coYFBvdGVudGlhbCBjb25mbGljdHMgZGV0ZWN0ZWQ6ICR7Y29uZmxpY3RzLmpvaW4oJywgJyl9YCwgJ3dhcm4nKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFdyYXAgYXN5bmMgb3BlcmF0aW9ucyB3aXRoIGNvbmZsaWN0IGNoZWNraW5nXG4gICAgICovXG4gICAgc3RhdGljIGFzeW5jIHNhZmVPcGVyYXRpb248VD4oXG4gICAgICAgIG9wZXJhdGlvbjogKCkgPT4gUHJvbWlzZTxUPixcbiAgICAgICAgb3BlcmF0aW9uTmFtZTogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xuICAgICAgICBpZiAoIXRoaXMuaXNTYWZlVG9PcGVyYXRlKCkpIHtcbiAgICAgICAgICAgIHRoaXMubG9nKGBTa2lwcGluZyAke29wZXJhdGlvbk5hbWV9IGR1ZSB0byBwb3RlbnRpYWwgY29uZmxpY3RzYCwgJ3dhcm4nKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5sb2coYFN0YXJ0aW5nICR7b3BlcmF0aW9uTmFtZX1gKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG9wZXJhdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5sb2coYENvbXBsZXRlZCAke29wZXJhdGlvbk5hbWV9YCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5sb2coYEVycm9yIGluICR7b3BlcmF0aW9uTmFtZX06ICR7ZXJyb3J9YCwgJ2Vycm9yJyk7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICIvKipcbiAqIFVzZXItZmFjaW5nIG1lc3NhZ2VzIGFuZCBub3RpZmljYXRpb25zXG4gKi9cblxuZXhwb3J0IGNvbnN0IE1FU1NBR0VTID0ge1xuICAgIFBST0NFU1NJTkc6ICdQcm9jZXNzaW5nIFlvdVR1YmUgdmlkZW8uLi4nLFxuICAgIFNVQ0NFU1M6ICh0aXRsZTogc3RyaW5nKSA9PiBgU3VjY2Vzc2Z1bGx5IHByb2Nlc3NlZDogJHt0aXRsZX1gLFxuICAgIE9QRU5FRF9GSUxFOiAoZmlsZW5hbWU6IHN0cmluZykgPT4gYE9wZW5lZDogJHtmaWxlbmFtZX1gLFxuICAgIFxuICAgIEVSUk9SUzoge1xuICAgICAgICBJTlZBTElEX1VSTDogJ0ludmFsaWQgWW91VHViZSBVUkwuIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgWW91VHViZSB2aWRlbyBVUkwgKGUuZy4sIGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9VklERU9fSUQpJyxcbiAgICAgICAgTUlTU0lOR19BUElfS0VZUzogJ05vIHZhbGlkIEdlbWluaSBvciBHcm9xIEFQSSBrZXkgY29uZmlndXJlZC4gUGxlYXNlIHNldCBvbmUgaW4gcGx1Z2luIHNldHRpbmdzLicsXG4gICAgICAgIEdFTUlOSV9JTlZBTElEX0tFWTogJ0dlbWluaSBBUEkga2V5IGlzIGludmFsaWQgb3IgbWlzc2luZy4gUGxlYXNlIGNoZWNrIHlvdXIga2V5LicsXG4gICAgICAgIEdST1FfTU9ERUxfTk9UX0ZPVU5EOiAnR3JvcSBBUEkgZXJyb3I6IE1vZGVsIG5vdCBmb3VuZCBvciB5b3UgZG8gbm90IGhhdmUgYWNjZXNzLiBQbGVhc2UgY2hlY2sgeW91ciBBUEkga2V5IGFuZCBtb2RlbCBuYW1lLicsXG4gICAgICAgIEZFVENIX1ZJREVPX0RBVEE6IChzdGF0dXM6IG51bWJlcikgPT4gYEZhaWxlZCB0byBmZXRjaCB2aWRlbyBtZXRhZGF0YTogJHtzdGF0dXN9YCxcbiAgICAgICAgU0FWRV9GSUxFOiAobWVzc2FnZTogc3RyaW5nKSA9PiBgRmFpbGVkIHRvIHNhdmUgZmlsZTogJHttZXNzYWdlfWAsXG4gICAgICAgIEFJX1BST0NFU1NJTkc6IChtZXNzYWdlOiBzdHJpbmcpID0+IGBBSSBwcm9jZXNzaW5nIGZhaWxlZDogJHttZXNzYWdlfWAsXG4gICAgICAgIEZJTEVfTk9UX0VYSVNUUzogJ0ZpbGUgbm8gbG9uZ2VyIGV4aXN0cycsXG4gICAgICAgIENPVUxEX05PVF9PUEVOOiAobWVzc2FnZTogc3RyaW5nKSA9PiBgQ291bGQgbm90IG9wZW4gZmlsZTogJHttZXNzYWdlfWAsXG4gICAgICAgIEVOVEVSX1VSTDogJ1BsZWFzZSBlbnRlciBhIFlvdVR1YmUgVVJMJyxcbiAgICAgICAgVklERU9fSURfRVhUUkFDVElPTjogJ0NvdWxkIG5vdCBleHRyYWN0IHZpZGVvIElEIGZyb20gVVJMLiBQbGVhc2UgY2hlY2sgdGhlIFVSTCBmb3JtYXQuJyxcbiAgICAgICAgTkVUV09SS19FUlJPUjogJ05ldHdvcmsgZXJyb3Igb2NjdXJyZWQuIFBsZWFzZSBjaGVjayB5b3VyIGludGVybmV0IGNvbm5lY3Rpb24gYW5kIHRyeSBhZ2Fpbi4nXG4gICAgfSxcbiAgICBcbiAgICBXQVJOSU5HUzoge1xuICAgICAgICBDT1JTX1JFU1RSSUNUSU9OUzogJ0Rlc2NyaXB0aW9uIG5vdCBhdmFpbGFibGUgZHVlIHRvIENPUlMgcmVzdHJpY3Rpb25zJyxcbiAgICAgICAgRVhUUkFDVElPTl9GQUlMRUQ6ICdEZXNjcmlwdGlvbiBleHRyYWN0aW9uIGZhaWxlZCcsXG4gICAgICAgIEFVVE9fRVhUUkFDVElPTjogJ1ZpZGVvIGRlc2NyaXB0aW9uIGNvdWxkIG5vdCBiZSBleHRyYWN0ZWQgYXV0b21hdGljYWxseS4nXG4gICAgfSxcbiAgICBcbiAgICBNT0RBTFM6IHtcbiAgICAgICAgWU9VVFVCRV9QUk9DRVNTRUQ6ICdZb3VUdWJlIFZpZGVvIFByb2Nlc3NlZCcsXG4gICAgICAgIENPTkZJUk1fT1BFTjogKGZpbGVuYW1lOiBzdHJpbmcpID0+IGBTdWNjZXNzZnVsbHkgcHJvY2Vzc2VkIFlvdVR1YmUgdmlkZW8gYW5kIHNhdmVkIGFzIFwiJHtmaWxlbmFtZX1cIi4gV291bGQgeW91IGxpa2UgdG8gb3BlbiB0aGUgbm90ZSBub3c/YCxcbiAgICAgICAgQ0xPU0VfQ09ORklSTUFUSU9OOiAnQ2xvc2Ugd2l0aG91dCBvcGVuaW5nIHRoZSBub3RlPycsXG4gICAgICAgIFBST0NFU1NfVklERU86ICdQcm9jZXNzIFlvdVR1YmUgVmlkZW8nLFxuICAgICAgICBZRVNfT1BFTjogJ1llcywgb3BlbiBub3RlJyxcbiAgICAgICAgTk9fVEhBTktTOiAnTm8sIHRoYW5rcycsXG4gICAgICAgIENBTkNFTDogJ0NhbmNlbCcsXG4gICAgICAgIFBST0NFU1M6ICdQcm9jZXNzJ1xuICAgIH0sXG4gICAgXG4gICAgUExBQ0VIT0xERVJTOiB7XG4gICAgICAgIFlPVVRVQkVfVVJMOiAnaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj0uLi4nLFxuICAgICAgICBHRU1JTklfS0VZOiAnQUl6YS4uLicsXG4gICAgICAgIEdST1FfS0VZOiAnZ3NrXy4uLicsXG4gICAgICAgIE9VVFBVVF9QQVRIOiAnWW91VHViZS9Qcm9jZXNzZWQgVmlkZW9zJ1xuICAgIH1cbn0gYXMgY29uc3Q7XG4iLCAiLyoqXG4gKiBJbnB1dCB2YWxpZGF0aW9uIHV0aWxpdGllc1xuICovXG5cbmltcG9ydCB7IE1FU1NBR0VTIH0gZnJvbSAnLi4vY29uc3RhbnRzL21lc3NhZ2VzJztcblxuZXhwb3J0IGNsYXNzIFZhbGlkYXRpb25VdGlscyB7XG4gICAgLyoqXG4gICAgICogWW91VHViZSBVUkwgcGF0dGVybnMgZm9yIHZhbGlkYXRpb24gKG9yZGVyZWQgYnkgZnJlcXVlbmN5IGZvciBwZXJmb3JtYW5jZSlcbiAgICAgKiBFbmhhbmNlZCBwYXR0ZXJucyB0byBoYW5kbGUgdmFyaW91cyBZb3VUdWJlIFVSTCBmb3JtYXRzXG4gICAgICovXG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgVVJMX1BBVFRFUk5TID0gW1xuICAgICAgICAvLyBTdGFuZGFyZCB5b3V0dWJlLmNvbS93YXRjaD92PSBmb3JtYXQgKG1vc3QgY29tbW9uKVxuICAgICAgICAvKD86aHR0cHM/OlxcL1xcLyk/KD86d3d3XFwuKT95b3V0dWJlXFwuY29tXFwvd2F0Y2hcXD92PShbYS16QS1aMC05Xy1dezExfSkoPzomLiopPyQvLFxuICAgICAgICAvLyB5b3V0dS5iZSBzaG9ydCBmb3JtYXQgKHNlY29uZCBtb3N0IGNvbW1vbilcbiAgICAgICAgLyg/Omh0dHBzPzpcXC9cXC8pPyg/Ond3d1xcLik/eW91dHVcXC5iZVxcLyhbYS16QS1aMC05Xy1dezExfSkoPzpcXD8uKik/JC8sXG4gICAgICAgIC8vIHlvdXR1YmUuY29tL2VtYmVkIGZvcm1hdFxuICAgICAgICAvKD86aHR0cHM/OlxcL1xcLyk/KD86d3d3XFwuKT95b3V0dWJlXFwuY29tXFwvZW1iZWRcXC8oW2EtekEtWjAtOV8tXXsxMX0pKD86XFw/LiopPyQvLFxuICAgICAgICAvLyB5b3V0dWJlLmNvbS92IGZvcm1hdFxuICAgICAgICAvKD86aHR0cHM/OlxcL1xcLyk/KD86d3d3XFwuKT95b3V0dWJlXFwuY29tXFwvdlxcLyhbYS16QS1aMC05Xy1dezExfSkoPzpcXD8uKik/JC8sXG4gICAgICAgIC8vIE1vYmlsZSB5b3V0dWJlLmNvbSBmb3JtYXRcbiAgICAgICAgLyg/Omh0dHBzPzpcXC9cXC8pPyg/Om1cXC4pP3lvdXR1YmVcXC5jb21cXC93YXRjaFxcP3Y9KFthLXpBLVowLTlfLV17MTF9KSg/OiYuKik/JC9cbiAgICBdO1xuXG4gICAgLy8gTWVtb2l6ZWQgcmVnZXggZm9yIHZpZGVvIElEIHZhbGlkYXRpb24gKGhvdCBwYXRoIG9wdGltaXphdGlvbilcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBWSURFT19JRF9SRUdFWCA9IC9eW2EtekEtWjAtOV8tXXsxMX0kLztcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBVUkxfQ0FDSEUgPSBuZXcgTWFwPHN0cmluZywgc3RyaW5nIHwgbnVsbD4oKTtcblxuICAgIC8qKlxuICAgICAqIENsZWFuIGFuZCBub3JtYWxpemUgWW91VHViZSBVUkxcbiAgICAgKi9cbiAgICBzdGF0aWMgY2xlYW5Zb3VUdWJlVXJsKHVybDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKCF1cmwgfHwgdHlwZW9mIHVybCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJlbW92ZSBleHRyYSB3aGl0ZXNwYWNlIGFuZCBub3JtYWxpemVcbiAgICAgICAgbGV0IGNsZWFuVXJsID0gdXJsLnRyaW0oKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEhhbmRsZSBVUkxzIHRoYXQgbWlnaHQgaGF2ZSBiZWVuIGNvcHktcGFzdGVkIHdpdGggZXh0cmEgY2hhcmFjdGVyc1xuICAgICAgICBjbGVhblVybCA9IGNsZWFuVXJsLnJlcGxhY2UoL1tcXHUyMDBCLVxcdTIwMERcXHVGRUZGXS9nLCAnJyk7IC8vIFJlbW92ZSB6ZXJvLXdpZHRoIGNoYXJhY3RlcnNcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBodHRwczovLyBpZiBtaXNzaW5nIHByb3RvY29sXG4gICAgICAgIGlmICghY2xlYW5Vcmwuc3RhcnRzV2l0aCgnaHR0cDovLycpICYmICFjbGVhblVybC5zdGFydHNXaXRoKCdodHRwczovLycpKSB7XG4gICAgICAgICAgICBjbGVhblVybCA9ICdodHRwczovLycgKyBjbGVhblVybDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENvbnZlcnQgaHR0cCB0byBodHRwcyBmb3IgWW91VHViZVxuICAgICAgICBpZiAoY2xlYW5Vcmwuc3RhcnRzV2l0aCgnaHR0cDovL3lvdXR1YmUuY29tJykgfHwgY2xlYW5Vcmwuc3RhcnRzV2l0aCgnaHR0cDovL3d3dy55b3V0dWJlLmNvbScpKSB7XG4gICAgICAgICAgICBjbGVhblVybCA9IGNsZWFuVXJsLnJlcGxhY2UoJ2h0dHA6Ly8nLCAnaHR0cHM6Ly8nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjbGVhblVybDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IFlvdVR1YmUgdmlkZW8gSUQgZnJvbSBVUkwgKG1lbW9pemVkIGZvciBwZXJmb3JtYW5jZSlcbiAgICAgKiBFbmhhbmNlZCBleHRyYWN0aW9uIHdpdGggYmV0dGVyIGVycm9yIGhhbmRsaW5nXG4gICAgICovXG4gICAgc3RhdGljIGV4dHJhY3RWaWRlb0lkKHVybDogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgICAgIGlmICghdXJsIHx8IHR5cGVvZiB1cmwgIT09ICdzdHJpbmcnKSByZXR1cm4gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGNhY2hlIGZpcnN0IChPKDEpIGZvciByZXBlYXRlZCBVUkxzKVxuICAgICAgICBpZiAodGhpcy5VUkxfQ0FDSEUuaGFzKHVybCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLlVSTF9DQUNIRS5nZXQodXJsKSE7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjbGVhblVybCA9IHRoaXMuY2xlYW5Zb3VUdWJlVXJsKHVybCk7XG4gICAgICAgIGxldCByZXN1bHQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXG4gICAgICAgIC8vIERpcmVjdCBpbmRleCBhY2Nlc3MgZm9yIG1vc3QgY29tbW9uIHBhdHRlcm4gZmlyc3QgKG1pY3JvLW9wdGltaXphdGlvbilcbiAgICAgICAgbGV0IG1hdGNoID0gY2xlYW5VcmwubWF0Y2godGhpcy5VUkxfUEFUVEVSTlNbMF0pOyAvLyBNb3N0IGNvbW1vbiBwYXR0ZXJuIGZpcnN0XG4gICAgICAgIGlmIChtYXRjaD8uWzFdICYmIHRoaXMuVklERU9fSURfUkVHRVgudGVzdChtYXRjaFsxXSkpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IG1hdGNoWzFdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gRmFsbGJhY2sgdG8gcmVtYWluaW5nIHBhdHRlcm5zXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHRoaXMuVVJMX1BBVFRFUk5TLmxlbmd0aCAmJiAhcmVzdWx0OyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXRjaCA9IGNsZWFuVXJsLm1hdGNoKHRoaXMuVVJMX1BBVFRFUk5TW2ldKTtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2g/LlsxXSAmJiB0aGlzLlZJREVPX0lEX1JFR0VYLnRlc3QobWF0Y2hbMV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENhY2hlIHJlc3VsdCB3aXRoIHNpbXBsZSBMUlUgZXZpY3Rpb25cbiAgICAgICAgaWYgKHRoaXMuVVJMX0NBQ0hFLnNpemUgPiAxMDApIHtcbiAgICAgICAgICAgIHRoaXMuVVJMX0NBQ0hFLmNsZWFyKCk7IC8vIFNpbXBsZSBMUlUgYnkgY2xlYXJpbmcgd2hlbiBmdWxsXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5VUkxfQ0FDSEUuc2V0KHVybCwgcmVzdWx0KTtcblxuICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gZXh0cmFjdCB2aWRlbyBJRCBmcm9tIFVSTDonLCB1cmwpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBZb3VUdWJlIFVSTCBmb3JtYXRcbiAgICAgKi9cbiAgICBzdGF0aWMgaXNWYWxpZFlvdVR1YmVVcmwodXJsOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXh0cmFjdFZpZGVvSWQodXJsKSAhPT0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTYW5pdGl6ZSBmaWxlbmFtZSBmb3IgZmlsZSBzeXN0ZW0gY29tcGF0aWJpbGl0eVxuICAgICAqL1xuICAgIHN0YXRpYyBzYW5pdGl6ZUZpbGVuYW1lKGZpbGVuYW1lOiBzdHJpbmcsIG1heExlbmd0aCA9IDEwMCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBmaWxlbmFtZVxuICAgICAgICAgICAgLnJlcGxhY2UoL1s8PjpcIi9cXFxcfD8qXS9nLCAnJylcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXHMrL2csICcgJylcbiAgICAgICAgICAgIC50cmltKClcbiAgICAgICAgICAgIC5zdWJzdHJpbmcoMCwgbWF4TGVuZ3RoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBBUEkga2V5IGZvcm1hdFxuICAgICAqL1xuICAgIHN0YXRpYyBpc1ZhbGlkQVBJS2V5KGtleTogc3RyaW5nLCBwcm92aWRlcjogJ2dlbWluaScgfCAnZ3JvcScpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCFrZXkgfHwgdHlwZW9mIGtleSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN3aXRjaCAocHJvdmlkZXIpIHtcbiAgICAgICAgICAgIGNhc2UgJ2dlbWluaSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGtleS5zdGFydHNXaXRoKCdBSXphJykgJiYga2V5Lmxlbmd0aCA+IDEwO1xuICAgICAgICAgICAgY2FzZSAnZ3JvcSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGtleS5zdGFydHNXaXRoKCdnc2tfJykgJiYga2V5Lmxlbmd0aCA+IDEwO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBzZXR0aW5ncyBjb25maWd1cmF0aW9uXG4gICAgICovXG4gICAgc3RhdGljIHZhbGlkYXRlU2V0dGluZ3Moc2V0dGluZ3M6IGFueSk6IHsgaXNWYWxpZDogYm9vbGVhbjsgZXJyb3JzOiBzdHJpbmdbXSB9IHtcbiAgICAgICAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICAgIGNvbnN0IHVzaW5nRW52ID0gQm9vbGVhbihzZXR0aW5ncy51c2VFbnZpcm9ubWVudFZhcmlhYmxlcyk7XG4gICAgICAgIGNvbnN0IGhhc0RpcmVjdEtleSA9IHRoaXMuaXNOb25FbXB0eVN0cmluZyhzZXR0aW5ncy5nZW1pbmlBcGlLZXkpIHx8IHRoaXMuaXNOb25FbXB0eVN0cmluZyhzZXR0aW5ncy5ncm9xQXBpS2V5KTtcblxuICAgICAgICBpZiAoIWhhc0RpcmVjdEtleSAmJiAhdXNpbmdFbnYpIHtcbiAgICAgICAgICAgIGVycm9ycy5wdXNoKE1FU1NBR0VTLkVSUk9SUy5NSVNTSU5HX0FQSV9LRVlTKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmlzTm9uRW1wdHlTdHJpbmcoc2V0dGluZ3MuZ2VtaW5pQXBpS2V5KSAmJiAhdGhpcy5pc1ZhbGlkQVBJS2V5KHNldHRpbmdzLmdlbWluaUFwaUtleSwgJ2dlbWluaScpKSB7XG4gICAgICAgICAgICBlcnJvcnMucHVzaCgnSW52YWxpZCBHZW1pbmkgQVBJIGtleSBmb3JtYXQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmlzTm9uRW1wdHlTdHJpbmcoc2V0dGluZ3MuZ3JvcUFwaUtleSkgJiYgIXRoaXMuaXNWYWxpZEFQSUtleShzZXR0aW5ncy5ncm9xQXBpS2V5LCAnZ3JvcScpKSB7XG4gICAgICAgICAgICBlcnJvcnMucHVzaCgnSW52YWxpZCBHcm9xIEFQSSBrZXkgZm9ybWF0Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodXNpbmdFbnYgJiYgIXRoaXMuaXNOb25FbXB0eVN0cmluZyhzZXR0aW5ncy5lbnZpcm9ubWVudFByZWZpeCkpIHtcbiAgICAgICAgICAgIGVycm9ycy5wdXNoKCdFbnZpcm9ubWVudCB2YXJpYWJsZSBwcmVmaXggaXMgcmVxdWlyZWQgd2hlbiB1c2luZyBlbnZpcm9ubWVudCB2YXJpYWJsZXMnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghc2V0dGluZ3Mub3V0cHV0UGF0aCB8fCB0eXBlb2Ygc2V0dGluZ3Mub3V0cHV0UGF0aCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGVycm9ycy5wdXNoKCdPdXRwdXQgcGF0aCBpcyByZXF1aXJlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgICAgICAgICBlcnJvcnNcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBmaWxlIHBhdGhcbiAgICAgKi9cbiAgICBzdGF0aWMgaXNWYWxpZFBhdGgocGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgcGF0aCA9PT0gJ3N0cmluZycgJiYgcGF0aC50cmltKCkubGVuZ3RoID4gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSB0aGF0IGEgc3RyaW5nIGlzIG5vdCBlbXB0eVxuICAgICAqL1xuICAgIHN0YXRpYyBpc05vbkVtcHR5U3RyaW5nKHZhbHVlOiBhbnkpOiB2YWx1ZSBpcyBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiB2YWx1ZS50cmltKCkubGVuZ3RoID4gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcnVuY2F0ZSB0ZXh0IHRvIHNwZWNpZmllZCBsZW5ndGggd2l0aCBlbGxpcHNpc1xuICAgICAqL1xuICAgIHN0YXRpYyB0cnVuY2F0ZVRleHQodGV4dDogc3RyaW5nLCBtYXhMZW5ndGg6IG51bWJlcik6IHN0cmluZyB7XG4gICAgICAgIGlmICh0ZXh0Lmxlbmd0aCA8PSBtYXhMZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0ZXh0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0ZXh0LnN1YnN0cmluZygwLCBtYXhMZW5ndGggLSAzKSArICcuLi4nO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFuIEhUTUwgZW50aXRpZXMgYW5kIGVzY2FwZSBzZXF1ZW5jZXMgZnJvbSB0ZXh0XG4gICAgICovXG4gICAgc3RhdGljIGNsZWFuVGV4dCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGV4dFxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcXFxuL2csICdcXG4nKVxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcXFxcIi9nLCAnXCInKVxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcXFwnL2csIFwiJ1wiKVxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcXFx1KFswLTlhLWZBLUZdezR9KS9nLCAobWF0Y2gsIGNvZGUpID0+IFxuICAgICAgICAgICAgICAgIFN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQoY29kZSwgMTYpKVxuICAgICAgICAgICAgKTtcbiAgICB9XG59XG4iLCAiLyoqXG4gKiBDZW50cmFsaXplZCBlcnJvciBoYW5kbGluZyB0byBlbGltaW5hdGUgY29kZSBkdXBsaWNhdGlvblxuICovXG5cbmltcG9ydCB7IE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEVycm9ySGFuZGxlckludGVyZmFjZSB9IGZyb20gJy4uL2ludGVyZmFjZXMvdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgRXJyb3JIYW5kbGVyIGltcGxlbWVudHMgRXJyb3JIYW5kbGVySW50ZXJmYWNlIHtcbiAgICAvKipcbiAgICAgKiBIYW5kbGUgZXJyb3JzIHdpdGggY29uc2lzdGVudCBsb2dnaW5nIGFuZCB1c2VyIGZlZWRiYWNrXG4gICAgICovXG4gICAgc3RhdGljIGhhbmRsZShlcnJvcjogRXJyb3IsIGNvbnRleHQ6IHN0cmluZywgc2hvd05vdGljZSA9IHRydWUpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gYCR7Y29udGV4dH06ICR7ZXJyb3IubWVzc2FnZX1gO1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yTWVzc2FnZSwgZXJyb3IpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHNob3dOb3RpY2UpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGFuIG9wZXJhdGlvbiB3aXRoIGF1dG9tYXRpYyBlcnJvciBoYW5kbGluZ1xuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyB3aXRoRXJyb3JIYW5kbGluZzxUPihcbiAgICAgICAgb3BlcmF0aW9uOiAoKSA9PiBQcm9taXNlPFQ+LFxuICAgICAgICBjb250ZXh0OiBzdHJpbmcsXG4gICAgICAgIHNob3dOb3RpY2UgPSB0cnVlXG4gICAgKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IG9wZXJhdGlvbigpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGUoZXJyb3IgYXMgRXJyb3IsIGNvbnRleHQsIHNob3dOb3RpY2UpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlIGEgc3luY2hyb25vdXMgb3BlcmF0aW9uIHdpdGggZXJyb3IgaGFuZGxpbmdcbiAgICAgKi9cbiAgICBzdGF0aWMgd2l0aFN5bmNFcnJvckhhbmRsaW5nPFQ+KFxuICAgICAgICBvcGVyYXRpb246ICgpID0+IFQsXG4gICAgICAgIGNvbnRleHQ6IHN0cmluZyxcbiAgICAgICAgc2hvd05vdGljZSA9IHRydWVcbiAgICApOiBUIHwgbnVsbCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gb3BlcmF0aW9uKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZShlcnJvciBhcyBFcnJvciwgY29udGV4dCwgc2hvd05vdGljZSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIHN0YW5kYXJkaXplZCBlcnJvciBmb3IgQVBJIHJlc3BvbnNlc1xuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGVBUElFcnJvcihcbiAgICAgICAgcHJvdmlkZXI6IHN0cmluZyxcbiAgICAgICAgc3RhdHVzOiBudW1iZXIsXG4gICAgICAgIHN0YXR1c1RleHQ6IHN0cmluZyxcbiAgICAgICAgZGV0YWlscz86IHN0cmluZ1xuICAgICk6IEVycm9yIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGAke3Byb3ZpZGVyfSBBUEkgZXJyb3I6ICR7c3RhdHVzfSAke3N0YXR1c1RleHR9JHtkZXRhaWxzID8gYC4gJHtkZXRhaWxzfWAgOiAnJ31gO1xuICAgICAgICByZXR1cm4gbmV3IEVycm9yKG1lc3NhZ2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBBUEkgcmVzcG9uc2UgZXJyb3JzIHdpdGggY29uc2lzdGVudCBmb3JtYXRcbiAgICAgKi9cbiAgICBzdGF0aWMgYXN5bmMgaGFuZGxlQVBJRXJyb3IoXG4gICAgICAgIHJlc3BvbnNlOiBSZXNwb25zZSxcbiAgICAgICAgcHJvdmlkZXI6IHN0cmluZyxcbiAgICAgICAgZmFsbGJhY2tNZXNzYWdlPzogc3RyaW5nXG4gICAgKTogUHJvbWlzZTxuZXZlcj4ge1xuICAgICAgICBsZXQgZXJyb3JEZXRhaWxzID0gZmFsbGJhY2tNZXNzYWdlIHx8ICcnO1xuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgIGVycm9yRGV0YWlscyA9IGVycm9yRGF0YS5lcnJvcj8ubWVzc2FnZSB8fCBlcnJvckRhdGEubWVzc2FnZSB8fCBmYWxsYmFja01lc3NhZ2UgfHwgJyc7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgLy8gSWdub3JlIEpTT04gcGFyc2luZyBlcnJvcnNcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhyb3cgdGhpcy5jcmVhdGVBUElFcnJvcihwcm92aWRlciwgcmVzcG9uc2Uuc3RhdHVzLCByZXNwb25zZS5zdGF0dXNUZXh0LCBlcnJvckRldGFpbHMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIHJlcXVpcmVkIGNvbmZpZ3VyYXRpb24gYW5kIHRocm93IGRlc2NyaXB0aXZlIGVycm9yc1xuICAgICAqL1xuICAgIHN0YXRpYyB2YWxpZGF0ZUNvbmZpZ3VyYXRpb24oY29uZmlnOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCByZXF1aXJlZEZpZWxkczogc3RyaW5nW10pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbWlzc2luZyA9IHJlcXVpcmVkRmllbGRzLmZpbHRlcihmaWVsZCA9PiAhY29uZmlnW2ZpZWxkXSk7XG4gICAgICAgIFxuICAgICAgICBpZiAobWlzc2luZy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgcmVxdWlyZWQgY29uZmlndXJhdGlvbjogJHttaXNzaW5nLmpvaW4oJywgJyl9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSB1c2VyLWZyaWVuZGx5IGVycm9yIG1lc3NhZ2UgZm9yIGNvbW1vbiBzY2VuYXJpb3NcbiAgICAgKi9cbiAgICBzdGF0aWMgY3JlYXRlVXNlckZyaWVuZGx5RXJyb3IoZXJyb3I6IEVycm9yLCBvcGVyYXRpb246IHN0cmluZyk6IEVycm9yIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGBGYWlsZWQgdG8gJHtvcGVyYXRpb259OiAke2Vycm9yLm1lc3NhZ2V9YDtcbiAgICAgICAgcmV0dXJuIG5ldyBFcnJvcihtZXNzYWdlKTtcbiAgICB9XG5cbiAgICAvLyBJbnN0YW5jZSBtZXRob2RzIGltcGxlbWVudGluZyBpbnRlcmZhY2VcbiAgICBoYW5kbGUoZXJyb3I6IEVycm9yLCBjb250ZXh0OiBzdHJpbmcsIHNob3dOb3RpY2UgPSB0cnVlKTogdm9pZCB7XG4gICAgICAgIEVycm9ySGFuZGxlci5oYW5kbGUoZXJyb3IsIGNvbnRleHQsIHNob3dOb3RpY2UpO1xuICAgIH1cblxuICAgIGFzeW5jIHdpdGhFcnJvckhhbmRsaW5nPFQ+KFxuICAgICAgICBvcGVyYXRpb246ICgpID0+IFByb21pc2U8VD4sXG4gICAgICAgIGNvbnRleHQ6IHN0cmluZ1xuICAgICk6IFByb21pc2U8VCB8IG51bGw+IHtcbiAgICAgICAgcmV0dXJuIEVycm9ySGFuZGxlci53aXRoRXJyb3JIYW5kbGluZyhvcGVyYXRpb24sIGNvbnRleHQpO1xuICAgIH1cbn1cbiIsICIvKipcbiAqIFNhdmUgQ29uZmlybWF0aW9uIE1vZGFsXG4gKiBTaG93cyBhIHBlcnNpc3RlbnQgY29uZmlybWF0aW9uIGRpYWxvZyB3aGVuIGEgZmlsZSBoYXMgYmVlbiBzYXZlZFxuICovXG5cbmltcG9ydCB7IEFwcCwgTW9kYWwsIFRGaWxlLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgY2xhc3MgU2F2ZUNvbmZpcm1hdGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHByaXZhdGUgZmlsZTogVEZpbGU7XG4gICAgcHJpdmF0ZSBvbkNvbmZpcm06IChzaG91bGRPcGVuOiBib29sZWFuKSA9PiB2b2lkO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBvbkNvbmZpcm06IChzaG91bGRPcGVuOiBib29sZWFuKSA9PiB2b2lkKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMuZmlsZSA9IGZpbGU7XG4gICAgICAgIHRoaXMub25Db25maXJtID0gb25Db25maXJtO1xuICAgIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBFWEFDVCBzcGVjaWZpY2F0aW9uIGZyb20gdGFza3NfMS5tZCBTdGVwIDVcbiAgICAgICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdOb3RlIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5LiBPcGVuIG5vdz8nIH0pO1xuXG4gICAgICAgICAgICAvLyBBZGQgYnV0dG9ucyBjb250YWluZXJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ3NhdmUtY29uZmlybWF0aW9uLWJ1dHRvbnMnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIGJ1dHRvbnMgYXMgcGVyIHNwZWNpZmljYXRpb246IFwiT3BlbiBOb3RlXCIgfCBcIkRpc21pc3NcIlxuICAgICAgICAgICAgbmV3IFNldHRpbmcoYnV0dG9uQ29udGFpbmVyKVxuICAgICAgICAgICAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnT3BlbiBOb3RlJylcbiAgICAgICAgICAgICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25Db25maXJtKHRydWUpOyAvLyBVc2VyIHdhbnRzIHRvIG9wZW4gdGhlIGZpbGVcbiAgICAgICAgICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdEaXNtaXNzJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNvbmZpcm0oZmFsc2UpOyAvLyBVc2VyIGRpc21pc3Nlc1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIC8vIEZvY3VzIHRoZSBPcGVuIE5vdGUgYnV0dG9uIGZvciBiZXR0ZXIgVVhcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9wZW5CdXR0b24gPSBidXR0b25Db250YWluZXIucXVlcnlTZWxlY3RvcignYnV0dG9uJyk7XG4gICAgICAgICAgICAgICAgaWYgKG9wZW5CdXR0b24pIHtcbiAgICAgICAgICAgICAgICAgICAgKG9wZW5CdXR0b24gYXMgSFRNTEVsZW1lbnQpLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignW1NhdmVDb25maXJtYXRpb25Nb2RhbF0gRXJyb3IgaW4gb25PcGVuOicsIGVycm9yKTtcbiAgICAgICAgICAgIC8vIEZhbGxiYWNrIGNvbnRlbnRcbiAgICAgICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdGaWxlIFNhdmVkJyB9KTtcbiAgICAgICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgncCcsIHsgdGV4dDogYEZpbGUgXCIke3RoaXMuZmlsZS5uYW1lfVwiIGhhcyBiZWVuIHNhdmVkIHN1Y2Nlc3NmdWxseS5gIH0pO1xuICAgICAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdPSycgfSkub25jbGljayA9ICgpID0+IHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBodW1hbi1yZWFkYWJsZSBmaWxlIHNpemVcbiAgICAgKi9cbiAgICBwcml2YXRlIGdldEZpbGVTaXplKCk6IHN0cmluZyB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzdGF0ID0gdGhpcy5hcHAudmF1bHQuYWRhcHRlci5zdGF0KHRoaXMuZmlsZS5wYXRoKTtcbiAgICAgICAgICAgIGlmIChzdGF0ICYmIHR5cGVvZiBzdGF0ID09PSAnb2JqZWN0JyAmJiAnc2l6ZScgaW4gc3RhdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJ5dGVzID0gKHN0YXQgYXMgYW55KS5zaXplO1xuICAgICAgICAgICAgICAgIGlmIChieXRlcyA8IDEwMjQpIHJldHVybiBgJHtieXRlc30gYnl0ZXNgO1xuICAgICAgICAgICAgICAgIGlmIChieXRlcyA8IDEwMjQgKiAxMDI0KSByZXR1cm4gYCR7KGJ5dGVzIC8gMTAyNCkudG9GaXhlZCgxKX0gS0JgO1xuICAgICAgICAgICAgICAgIHJldHVybiBgJHsoYnl0ZXMgLyAoMTAyNCAqIDEwMjQpKS50b0ZpeGVkKDEpfSBNQmA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBGaWxlIHNpemUgbm90IGF2YWlsYWJsZVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICBvbkNsb3NlKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGN1c3RvbSBzdHlsZXMgZm9yIHRoZSBtb2RhbFxuICAgICAqL1xuICAgIHByaXZhdGUgYWRkU3R5bGVzKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBDU1MgY2xhc3NlcyBmb3Igc3R5bGluZ1xuICAgICAgICBjb250ZW50RWwuYWRkQ2xhc3MoJ3l0cC1zYXZlLWNvbmZpcm1hdGlvbi1tb2RhbCcpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGlubGluZSBzdHlsZXMgaWYgbmVlZGVkXG4gICAgICAgIGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgICAgICAgc3R5bGUudGV4dENvbnRlbnQgPSBgXG4gICAgICAgICAgICAueXRwLXNhdmUtY29uZmlybWF0aW9uLW1vZGFsIHtcbiAgICAgICAgICAgICAgICBtaW4td2lkdGg6IDQ1MHB4O1xuICAgICAgICAgICAgICAgIG1heC13aWR0aDogNjUwcHg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC5zYXZlLWNvbmZpcm1hdGlvbi1tZXNzYWdlIHtcbiAgICAgICAgICAgICAgICBtYXJnaW46IDIwcHggMCAzMHB4IDA7XG4gICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogbGVmdDtcbiAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMS42O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAuc2F2ZS1jb25maXJtYXRpb24tZmlsZW5hbWUge1xuICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMS4xZW07XG4gICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDtcbiAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1hY2NlbnQpO1xuICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLnNhdmUtY29uZmlybWF0aW9uLWxvY2F0aW9uLWNvbnRhaW5lcixcbiAgICAgICAgICAgIC5zYXZlLWNvbmZpcm1hdGlvbi1zaXplLWNvbnRhaW5lciB7XG4gICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTBweDtcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAgICAgICAgZ2FwOiA4cHg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC5zYXZlLWNvbmZpcm1hdGlvbi1sb2NhdGlvbiB7XG4gICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6IHZhcigtLWZvbnQtbW9ub3NwYWNlKTtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSk7XG4gICAgICAgICAgICAgICAgcGFkZGluZzogNHB4IDhweDtcbiAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiAwLjllbTtcbiAgICAgICAgICAgICAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbXV0ZWQpO1xuICAgICAgICAgICAgICAgIGZsZXg6IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC5zYXZlLWNvbmZpcm1hdGlvbi1zaXplIHtcbiAgICAgICAgICAgICAgICBmb250LWZhbWlseTogdmFyKC0tZm9udC1tb25vc3BhY2UpO1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgcGFkZGluZzogNHB4IDhweDtcbiAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiAwLjllbTtcbiAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1vbi1hY2NlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAuc2F2ZS1jb25maXJtYXRpb24tYnV0dG9ucyB7XG4gICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgICAgICAgIG1hcmdpbi10b3A6IDIwcHg7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgICAgICAgICBnYXA6IDE1cHg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC5zYXZlLWNvbmZpcm1hdGlvbi1idXR0b25zIC5zZXR0aW5nLWl0ZW0ge1xuICAgICAgICAgICAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgICAgICAgICAgICBwYWRkaW5nOiAwO1xuICAgICAgICAgICAgICAgIG1hcmdpbjogMDtcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgICAgIGdhcDogMTBweDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLnNhdmUtY29uZmlybWF0aW9uLWJ1dHRvbnMgYnV0dG9uIHtcbiAgICAgICAgICAgICAgICBtaW4td2lkdGg6IDEwMHB4O1xuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDhweCAyMHB4O1xuICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMWVtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAuc2F2ZS1jb25maXJtYXRpb24tYnV0dG9ucyBidXR0b246Zmlyc3QtY2hpbGQge1xuICAgICAgICAgICAgICAgIC8qIE9wZW4gRmlsZSBidXR0b24gLSBwcmltYXJ5IGFjdGlvbiAqL1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtb24tYWNjZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLnNhdmUtY29uZmlybWF0aW9uLWJ1dHRvbnMgYnV0dG9uOmxhc3QtY2hpbGQge1xuICAgICAgICAgICAgICAgIC8qIE9LIGJ1dHRvbiAtIHNlY29uZGFyeSBhY3Rpb24gKi9cbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG4gICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtbm9ybWFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgYDtcbiAgICAgICAgXG4gICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuICAgICAgICBcbiAgICAgICAgLy8gU3RvcmUgcmVmZXJlbmNlIHRvIGNsZWFuIHVwIGxhdGVyXG4gICAgICAgIHRoaXMubW9kYWxFbD8uc2V0QXR0cmlidXRlKCdkYXRhLXN0eWxlLWlkJywgJ3l0cC1zYXZlLWNvbmZpcm1hdGlvbi1zdHlsZScpO1xuICAgIH1cbn1cbiIsICIvKipcbiAqIFlvdVR1YmUgVVJMIGlucHV0IG1vZGFsIGNvbXBvbmVudFxuICovXG5cbmltcG9ydCB7IEFwcCwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQmFzZU1vZGFsIH0gZnJvbSAnLi9iYXNlLW1vZGFsJztcbmltcG9ydCB7IE1FU1NBR0VTIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL21lc3NhZ2VzJztcbmltcG9ydCB7IFBST1ZJREVSX01PREVMX09QVElPTlMsIEFJX01PREVMUyB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9hcGknO1xuaW1wb3J0IHsgVmFsaWRhdGlvblV0aWxzIH0gZnJvbSAnLi4vLi4vdXRpbHMvdmFsaWRhdGlvbic7XG5pbXBvcnQgeyBFcnJvckhhbmRsZXIgfSBmcm9tICcuLi8uLi91dGlscy9lcnJvci1oYW5kbGVyJztcbmltcG9ydCB7IE91dHB1dEZvcm1hdCB9IGZyb20gJy4uLy4uL2ludGVyZmFjZXMvdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFlvdVR1YmVVcmxNb2RhbE9wdGlvbnMge1xuICAgIG9uUHJvY2VzczogKHVybDogc3RyaW5nLCBmb3JtYXQ6IE91dHB1dEZvcm1hdCwgcHJvdmlkZXI/OiBzdHJpbmcsIG1vZGVsPzogc3RyaW5nLCBjdXN0b21Qcm9tcHQ/OiBzdHJpbmcpID0+IFByb21pc2U8c3RyaW5nPjsgLy8gUmV0dXJuIGZpbGUgcGF0aFxuICAgIG9uT3BlbkZpbGU/OiAoZmlsZVBhdGg6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPjtcbiAgICBpbml0aWFsVXJsPzogc3RyaW5nO1xuICAgIHByb3ZpZGVycz86IHN0cmluZ1tdOyAvLyBhdmFpbGFibGUgcHJvdmlkZXIgbmFtZXNcbiAgICBtb2RlbE9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT47IC8vIG1hcHBpbmcgcHJvdmlkZXJOYW1lIC0+IG1vZGVsc1xuICAgIGRlZmF1bHRQcm92aWRlcj86IHN0cmluZztcbiAgICBkZWZhdWx0TW9kZWw/OiBzdHJpbmc7XG4gICAgZmV0Y2hNb2RlbHM/OiAoKSA9PiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPj47XG59XG5cbnR5cGUgU3RlcFN0YXRlID0gJ3BlbmRpbmcnIHwgJ2FjdGl2ZScgfCAnY29tcGxldGUnIHwgJ2Vycm9yJztcblxuZXhwb3J0IGNsYXNzIFlvdVR1YmVVcmxNb2RhbCBleHRlbmRzIEJhc2VNb2RhbCB7XG4gICAgcHJpdmF0ZSB1cmwgPSAnJztcbiAgICBwcml2YXRlIGZvcm1hdDogT3V0cHV0Rm9ybWF0ID0gJ2V4ZWN1dGl2ZS1zdW1tYXJ5JztcbiAgICBwcml2YXRlIGhlYWRlckVsPzogSFRNTEhlYWRpbmdFbGVtZW50O1xuICAgIHByaXZhdGUgdXJsSW5wdXQ/OiBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHByaXZhdGUgcGFzdGVCdXR0b24/OiBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICBwcml2YXRlIGNsZWFyQnV0dG9uPzogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBwcm9jZXNzQnV0dG9uPzogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBvcGVuQnV0dG9uPzogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSB0aHVtYm5haWxFbD86IEhUTUxJbWFnZUVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBtZXRhZGF0YUNvbnRhaW5lcj86IEhUTUxEaXZFbGVtZW50O1xuICAgIHByaXZhdGUgZmV0Y2hJblByb2dyZXNzID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBwcm92aWRlclNlbGVjdD86IEhUTUxTZWxlY3RFbGVtZW50O1xuICAgIHByaXZhdGUgbW9kZWxTZWxlY3Q/OiBIVE1MU2VsZWN0RWxlbWVudDtcbiAgICBwcml2YXRlIHJlZnJlc2hTcGlubmVyPzogSFRNTFNwYW5FbGVtZW50O1xuICAgIHByaXZhdGUgc2VsZWN0ZWRQcm92aWRlcj86IHN0cmluZztcbiAgICBwcml2YXRlIHNlbGVjdGVkTW9kZWw/OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBwcm9ncmVzc0NvbnRhaW5lcj86IEhUTUxEaXZFbGVtZW50O1xuICAgIHByaXZhdGUgcHJvZ3Jlc3NCYXI/OiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIHByb2dyZXNzVGV4dD86IEhUTUxEaXZFbGVtZW50O1xuICAgIHByaXZhdGUgdmFsaWRhdGlvbk1lc3NhZ2U/OiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIHByb2dyZXNzU3RlcHM6IHsgbGFiZWw6IHN0cmluZzsgZWxlbWVudDogSFRNTExJRWxlbWVudCB9W10gPSBbXTtcbiAgICBwcml2YXRlIGN1cnJlbnRTdGVwSW5kZXggPSAwO1xuICAgIHByaXZhdGUgaXNQcm9jZXNzaW5nID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBwcm9jZXNzZWRGaWxlUGF0aD86IHN0cmluZztcbiAgICBwcml2YXRlIGN1c3RvbVByb21wdElucHV0PzogSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICBwcml2YXRlIGN1c3RvbVByb21wdENvbnRhaW5lcj86IEhUTUxEaXZFbGVtZW50O1xuICAgIFxuICAgIC8vIFBlcmZvcm1hbmNlIG9wdGltaXphdGlvbjogZGVib3VuY2VkIHZhbGlkYXRpb25cbiAgICBwcml2YXRlIHZhbGlkYXRpb25UaW1lcj86IG51bWJlcjtcbiAgICBwcml2YXRlIGxhc3RWYWxpZFVybD86IHN0cmluZztcbiAgICBwcml2YXRlIGxhc3RWYWxpZFJlc3VsdD86IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgb3B0aW9uczogWW91VHViZVVybE1vZGFsT3B0aW9uc1xuICAgICkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLnVybCA9IG9wdGlvbnMuaW5pdGlhbFVybCB8fCAnJztcbiAgICB9XG5cbiAgICBvbk9wZW4oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3JlYXRlTW9kYWxDb250ZW50KCk7XG4gICAgICAgIHRoaXMuc2V0dXBFdmVudEhhbmRsZXJzKCk7XG4gICAgICAgIC8vIElmIGFuIGluaXRpYWwgVVJMIHdhcyBwcm92aWRlZCwgdmFsaWRhdGUgYW5kIGZvY3VzIHRoZSBhcHByb3ByaWF0ZSBjb250cm9sXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaW5pdGlhbFVybCkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVQcm9jZXNzQnV0dG9uU3RhdGUoKTtcbiAgICAgICAgICAgIGNvbnN0IGlzVmFsaWQgPSBWYWxpZGF0aW9uVXRpbHMuaXNWYWxpZFlvdVR1YmVVcmwoKHRoaXMub3B0aW9ucy5pbml0aWFsVXJsIHx8ICcnKS50cmltKCkpO1xuICAgICAgICAgICAgaWYgKGlzVmFsaWQgJiYgdGhpcy5wcm9jZXNzQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuZm9jdXNVcmxJbnB1dCgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBtb2RhbCBjb250ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVNb2RhbENvbnRlbnQoKTogdm9pZCB7XG4gICAgdGhpcy5oZWFkZXJFbCA9IHRoaXMuY3JlYXRlSGVhZGVyKE1FU1NBR0VTLk1PREFMUy5QUk9DRVNTX1ZJREVPKTtcbiAgICAgICAgdGhpcy5jcmVhdGVVcmxJbnB1dFNlY3Rpb24oKTtcbiAgICAgICAgdGhpcy5jcmVhdGVGb3JtYXRTZWxlY3Rpb25TZWN0aW9uKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlUHJvdmlkZXJTZWxlY3Rpb25TZWN0aW9uKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlUHJvZ3Jlc3NTZWN0aW9uKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlQWN0aW9uQnV0dG9ucygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlUHJvdmlkZXJTZWxlY3Rpb25TZWN0aW9uKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JztcbiAgICAgICAgY29uc3QgbGFiZWwgPSBjb250YWluZXIuY3JlYXRlRWwoJ2xhYmVsJywgeyB0ZXh0OiAnQUkgUHJvdmlkZXIgJiBNb2RlbDonIH0pO1xuICAgICAgICBsYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsICd5dGMtcHJvdmlkZXItc2VsZWN0Jyk7XG5cbiAgICAgICAgY29uc3Qgcm93ID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICByb3cuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgcm93LnN0eWxlLmdhcCA9ICc4cHgnO1xuICAgICAgICByb3cuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xuXG4gICAgICAgIC8vIFByb3ZpZGVyIHNlbGVjdCB3aXRoIGFjY2Vzc2liaWxpdHlcbiAgICAgICAgdGhpcy5wcm92aWRlclNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlbGVjdCcpO1xuICAgICAgICB0aGlzLnByb3ZpZGVyU2VsZWN0LmlkID0gJ3l0Yy1wcm92aWRlci1zZWxlY3QnO1xuICAgICAgICB0aGlzLnByb3ZpZGVyU2VsZWN0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdBSSBQcm92aWRlcicpO1xuICAgICAgICB0aGlzLnByb3ZpZGVyU2VsZWN0LnN0eWxlLmZsZXggPSAnMSc7XG4gICAgICAgIHRoaXMucHJvdmlkZXJTZWxlY3Quc3R5bGUucGFkZGluZyA9ICc2cHgnO1xuICAgICAgICB0aGlzLnByb3ZpZGVyU2VsZWN0LnN0eWxlLmJvcmRlclJhZGl1cyA9ICc2cHgnO1xuICAgICAgICB0aGlzLnByb3ZpZGVyU2VsZWN0LnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgcm93LmFwcGVuZENoaWxkKHRoaXMucHJvdmlkZXJTZWxlY3QpO1xuXG4gICAgICAgIC8vIE1vZGVsIHNlbGVjdCB3aXRoIGFjY2Vzc2liaWxpdHlcbiAgICAgICAgdGhpcy5tb2RlbFNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlbGVjdCcpO1xuICAgICAgICB0aGlzLm1vZGVsU2VsZWN0LmlkID0gJ3l0Yy1tb2RlbC1zZWxlY3QnO1xuICAgICAgICB0aGlzLm1vZGVsU2VsZWN0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdBSSBNb2RlbCcpO1xuICAgICAgICB0aGlzLm1vZGVsU2VsZWN0LnN0eWxlLndpZHRoID0gJzIyMHB4JztcbiAgICAgICAgdGhpcy5tb2RlbFNlbGVjdC5zdHlsZS5wYWRkaW5nID0gJzZweCc7XG4gICAgICAgIHRoaXMubW9kZWxTZWxlY3Quc3R5bGUuYm9yZGVyUmFkaXVzID0gJzZweCc7XG4gICAgICAgIHRoaXMubW9kZWxTZWxlY3Quc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknO1xuICAgICAgICByb3cuYXBwZW5kQ2hpbGQodGhpcy5tb2RlbFNlbGVjdCk7XG5cbiAgICAgICAgLy8gUG9wdWxhdGUgcHJvdmlkZXJzIGlmIHByb3ZpZGVkIHZpYSBvcHRpb25zXG4gICAgICAgIGNvbnN0IHByb3ZpZGVycyA9IHRoaXMub3B0aW9ucy5wcm92aWRlcnMgfHwgW107XG4gICAgICAgIGNvbnN0IG1vZGVsT3B0aW9ucyA9IHRoaXMub3B0aW9ucy5tb2RlbE9wdGlvbnMgfHwge307XG5cbiAgICAgICAgLy8gQWRkIGFuIGV4cGxpY2l0ICdBdXRvIChmYWxsYmFjayBvcmRlciknIG9wdGlvblxuICAgICAgICBjb25zdCBhdXRvT3B0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgICAgIGF1dG9PcHQudmFsdWUgPSAnJztcbiAgICAgICAgYXV0b09wdC50ZXh0ID0gJ0F1dG8gKGZhbGxiYWNrKSc7XG4gICAgICAgIHRoaXMucHJvdmlkZXJTZWxlY3QuYXBwZW5kQ2hpbGQoYXV0b09wdCk7XG5cbiAgICAgICAgcHJvdmlkZXJzLmZvckVhY2goKHApID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG9wdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgICAgICAgICAgb3B0LnZhbHVlID0gcDtcbiAgICAgICAgICAgIG9wdC50ZXh0ID0gcDtcbiAgICAgICAgICAgIHRoaXMucHJvdmlkZXJTZWxlY3QhLmFwcGVuZENoaWxkKG9wdCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFJlZnJlc2ggbW9kZWxzIGJ1dHRvblxuICAgICAgICBjb25zdCByZWZyZXNoQnRuID0gdGhpcy5jcmVhdGVJbmxpbmVCdXR0b24ocm93LCAnUmVmcmVzaCBtb2RlbHMnLCAoKSA9PiB7XG4gICAgICAgICAgICB2b2lkIHRoaXMuaGFuZGxlUmVmcmVzaE1vZGVscygpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBJbmxpbmUgc3Bpbm5lciBuZXh0IHRvIHJlZnJlc2ggYnV0dG9uXG4gICAgICAgIHRoaXMucmVmcmVzaFNwaW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIHRoaXMucmVmcmVzaFNwaW5uZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgdGhpcy5yZWZyZXNoU3Bpbm5lci5zdHlsZS5tYXJnaW5MZWZ0ID0gJzhweCc7XG4gICAgICAgIHRoaXMucmVmcmVzaFNwaW5uZXIuc3R5bGUud2lkdGggPSAnMTZweCc7XG4gICAgICAgIHRoaXMucmVmcmVzaFNwaW5uZXIuc3R5bGUuaGVpZ2h0ID0gJzE2cHgnO1xuICAgICAgICB0aGlzLnJlZnJlc2hTcGlubmVyLnN0eWxlLmJvcmRlciA9ICcycHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgdGhpcy5yZWZyZXNoU3Bpbm5lci5zdHlsZS5ib3JkZXJUb3AgPSAnMnB4IHNvbGlkIHZhcigtLWludGVyYWN0aXZlLWFjY2VudCknO1xuICAgICAgICB0aGlzLnJlZnJlc2hTcGlubmVyLnN0eWxlLmJvcmRlclJhZGl1cyA9ICc1MCUnO1xuICAgICAgICB0aGlzLnJlZnJlc2hTcGlubmVyLnN0eWxlLmFuaW1hdGlvbiA9ICd5dHAtc3BpbiAxcyBsaW5lYXIgaW5maW5pdGUnO1xuICAgICAgICByb3cuYXBwZW5kQ2hpbGQodGhpcy5yZWZyZXNoU3Bpbm5lcik7XG5cbiAgICAgICAgLy8gV2lyZSBjaGFuZ2UgaGFuZGxlclxuICAgICAgICB0aGlzLnByb3ZpZGVyU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQcm92aWRlciA9IHRoaXMucHJvdmlkZXJTZWxlY3QhLnZhbHVlIHx8IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMucG9wdWxhdGVNb2RlbHNGb3JQcm92aWRlcih0aGlzLnNlbGVjdGVkUHJvdmlkZXIgfHwgJycsIG1vZGVsT3B0aW9ucywgdGhpcy5vcHRpb25zLmRlZmF1bHRNb2RlbCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFNldCBkZWZhdWx0c1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRlZmF1bHRQcm92aWRlcikge1xuICAgICAgICAgICAgdGhpcy5wcm92aWRlclNlbGVjdC52YWx1ZSA9IHRoaXMub3B0aW9ucy5kZWZhdWx0UHJvdmlkZXI7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkUHJvdmlkZXIgPSB0aGlzLm9wdGlvbnMuZGVmYXVsdFByb3ZpZGVyO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUG9wdWxhdGUgbW9kZWxzIGZvciBpbml0aWFsIHByb3ZpZGVyIHNlbGVjdGlvbiAob3IgZW1wdHkpXG4gICAgICAgIHRoaXMucG9wdWxhdGVNb2RlbHNGb3JQcm92aWRlcih0aGlzLnNlbGVjdGVkUHJvdmlkZXIgfHwgJycsIG1vZGVsT3B0aW9ucywgdGhpcy5vcHRpb25zLmRlZmF1bHRNb2RlbCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVSZWZyZXNoTW9kZWxzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5mZXRjaE1vZGVscykge1xuICAgICAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZSgnTW9kZWwgcmVmcmVzaCBub3QgYXZhaWxhYmxlLicsICdlcnJvcicpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZSgnUmVmcmVzaGluZyBtb2RlbCBsaXN0c1x1MjAyNicsICdpbmZvJyk7XG4gICAgICAgIC8vIHNob3cgc3Bpbm5lclxuICAgICAgICBpZiAodGhpcy5yZWZyZXNoU3Bpbm5lcikgdGhpcy5yZWZyZXNoU3Bpbm5lci5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7XG4gICAgICAgIC8vIGRpc2FibGUgcmVmcmVzaCB0byBhdm9pZCBkb3VibGUgY2xpY2tzXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBtYXAgPSBhd2FpdCB0aGlzLm9wdGlvbnMuZmV0Y2hNb2RlbHMoKTtcbiAgICAgICAgICAgIC8vIHVwZGF0ZSBwcm92aWRlciBsaXN0IGlmIGNoYW5nZWRcbiAgICAgICAgICAgIGNvbnN0IHByb3ZpZGVycyA9IE9iamVjdC5rZXlzKG1hcCk7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm92aWRlclNlbGVjdCkge1xuICAgICAgICAgICAgICAgIC8vIHByZXNlcnZlIGN1cnJlbnQgc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IHRoaXMucHJvdmlkZXJTZWxlY3QudmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm92aWRlclNlbGVjdC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgICAgICBjb25zdCBhdXRvT3B0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgICAgICAgICAgICAgYXV0b09wdC52YWx1ZSA9ICcnO1xuICAgICAgICAgICAgICAgIGF1dG9PcHQudGV4dCA9ICdBdXRvIChmYWxsYmFjayknO1xuICAgICAgICAgICAgICAgIHRoaXMucHJvdmlkZXJTZWxlY3QuYXBwZW5kQ2hpbGQoYXV0b09wdCk7XG4gICAgICAgICAgICAgICAgcHJvdmlkZXJzLmZvckVhY2gocCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgICAgICAgICAgICAgICAgICBvcHQudmFsdWUgPSBwO1xuICAgICAgICAgICAgICAgICAgICBvcHQudGV4dCA9IHA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvdmlkZXJTZWxlY3QhLmFwcGVuZENoaWxkKG9wdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQgJiYgQXJyYXkuZnJvbSh0aGlzLnByb3ZpZGVyU2VsZWN0Lm9wdGlvbnMpLnNvbWUobyA9PiBvLnZhbHVlID09PSBjdXJyZW50KSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3ZpZGVyU2VsZWN0LnZhbHVlID0gY3VycmVudDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFByb3ZpZGVyID0gY3VycmVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHVwZGF0ZSBtb2RlbE9wdGlvbnMgYW5kIHJlcG9wdWxhdGUgZm9yIHNlbGVjdGVkIHByb3ZpZGVyXG4gICAgICAgICAgICBjb25zdCBtb2RlbE9wdGlvbnMgPSBtYXA7XG4gICAgICAgICAgICB0aGlzLnBvcHVsYXRlTW9kZWxzRm9yUHJvdmlkZXIodGhpcy5zZWxlY3RlZFByb3ZpZGVyIHx8ICcnLCBtb2RlbE9wdGlvbnMsIHRoaXMub3B0aW9ucy5kZWZhdWx0TW9kZWwpO1xuICAgICAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZSgnTW9kZWwgbGlzdHMgcmVmcmVzaGVkLicsICdzdWNjZXNzJyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLnNldFZhbGlkYXRpb25NZXNzYWdlKCdGYWlsZWQgdG8gcmVmcmVzaCBtb2RlbHMuIFVzaW5nIGNhY2hlZCBvcHRpb25zLicsICdlcnJvcicpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgaWYgKHRoaXMucmVmcmVzaFNwaW5uZXIpIHRoaXMucmVmcmVzaFNwaW5uZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgcG9wdWxhdGVNb2RlbHNGb3JQcm92aWRlcihwcm92aWRlck5hbWU6IHN0cmluZywgbW9kZWxPcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4sIGRlZmF1bHRNb2RlbD86IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMubW9kZWxTZWxlY3QpIHJldHVybjtcbiAgICAgICAgLy8gQ2xlYXIgZXhpc3RpbmdcbiAgICAgICAgdGhpcy5tb2RlbFNlbGVjdC5pbm5lckhUTUwgPSAnJztcblxuICAgICAgICBjb25zdCBtb2RlbHMgPSBtb2RlbE9wdGlvbnNbcHJvdmlkZXJOYW1lXSB8fCBbXTtcbiAgICAgICAgaWYgKG1vZGVscy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIC8vIEFkZCBhIHNpbmdsZSBvcHRpb24gaW5kaWNhdGluZyBwcm92aWRlciBkZWZhdWx0XG4gICAgICAgICAgICBjb25zdCBvcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAgICAgICAgIG9wdC52YWx1ZSA9ICcnO1xuICAgICAgICAgICAgb3B0LnRleHQgPSAnRGVmYXVsdCBtb2RlbCc7XG4gICAgICAgICAgICB0aGlzLm1vZGVsU2VsZWN0LmFwcGVuZENoaWxkKG9wdCk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkTW9kZWwgPSAnJztcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIG1vZGVscy5mb3JFYWNoKChtKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBvcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAgICAgICAgIG9wdC52YWx1ZSA9IG07XG4gICAgICAgICAgICAvLyBJZiB3ZSBoYXZlIG1ldGFkYXRhIGluIFBST1ZJREVSX01PREVMX09QVElPTlMsIHNob3cgYSBzbWFsbCBiYWRnZVxuICAgICAgICAgICAgbGV0IGxhYmVsID0gbTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvdmlkZXJNb2RlbHMgPSBQUk9WSURFUl9NT0RFTF9PUFRJT05TW3Byb3ZpZGVyTmFtZV0gfHwgW10gYXMgYW55W107XG4gICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBwcm92aWRlck1vZGVscy5maW5kKHBtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IHR5cGVvZiBwbSA9PT0gJ3N0cmluZycgPyBwbSA6IChwbSAmJiBwbS5uYW1lID8gcG0ubmFtZSA6ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhuYW1lKS50b0xvd2VyQ2FzZSgpID09PSBTdHJpbmcobSkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICB9KSBhcyBhbnkgfCB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoLnN1cHBvcnRzQXVkaW9WaWRlbykge1xuICAgICAgICAgICAgICAgICAgICBsYWJlbCA9IGAke219ICBcdUQ4M0NcdURGQTVgOyAvLyBzbWFsbCBjYW1lcmEgZW1vamkgaW5kaWNhdGVzIG11bHRpbW9kYWwtY2FwYWJsZVxuICAgICAgICAgICAgICAgICAgICBvcHQudGl0bGUgPSAnU3VwcG9ydHMgbXVsdGltb2RhbCBhdWRpby92aWRlbyB0b2tlbnMnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBhbmQgZmFsbCBiYWNrIHRvIHBsYWluIGxhYmVsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcHQudGV4dCA9IGxhYmVsO1xuICAgICAgICAgICAgdGhpcy5tb2RlbFNlbGVjdCEuYXBwZW5kQ2hpbGQob3B0KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGRlZmF1bHRNb2RlbCAmJiBtb2RlbHMuaW5jbHVkZXMoZGVmYXVsdE1vZGVsKSkge1xuICAgICAgICAgICAgdGhpcy5tb2RlbFNlbGVjdC52YWx1ZSA9IGRlZmF1bHRNb2RlbDtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRNb2RlbCA9IGRlZmF1bHRNb2RlbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWxTZWxlY3Quc2VsZWN0ZWRJbmRleCA9IDA7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkTW9kZWwgPSB0aGlzLm1vZGVsU2VsZWN0LnZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5tb2RlbFNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkTW9kZWwgPSB0aGlzLm1vZGVsU2VsZWN0IS52YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIFVSTCBpbnB1dCBzZWN0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVVcmxJbnB1dFNlY3Rpb24oKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBsYWJlbCA9IGNvbnRhaW5lci5jcmVhdGVFbCgnbGFiZWwnLCB7IHRleHQ6ICdZb3VUdWJlIFVSTDonIH0pO1xuICAgICAgICBsYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsICd5dGMtdXJsLWlucHV0Jyk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBpbnB1dFJvdyA9IGNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgaW5wdXRSb3cuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgaW5wdXRSb3cuc3R5bGUuZ2FwID0gJzhweCc7XG4gICAgICAgIGlucHV0Um93LnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJztcbiAgICAgICAgXG4gICAgICAgIHRoaXMudXJsSW5wdXQgPSB0aGlzLmNyZWF0ZUlucHV0KFxuICAgICAgICAgICAgaW5wdXRSb3csXG4gICAgICAgICAgICAndXJsJyxcbiAgICAgICAgICAgIE1FU1NBR0VTLlBMQUNFSE9MREVSUy5ZT1VUVUJFX1VSTCArICcgKFByZXNzIEVudGVyIHRvIHByb2Nlc3MpJ1xuICAgICAgICApO1xuICAgICAgICB0aGlzLnVybElucHV0LmlkID0gJ3l0Yy11cmwtaW5wdXQnO1xuICAgICAgICB0aGlzLnVybElucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdZb3VUdWJlIFVSTCcpO1xuICAgICAgICB0aGlzLnVybElucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS1kZXNjcmliZWRieScsICd5dGMtdXJsLWhpbnQnKTtcbiAgICAgICAgdGhpcy51cmxJbnB1dC5zdHlsZS5mbGV4ID0gJzEnO1xuICAgICAgICB0aGlzLnVybElucHV0LnN0eWxlLnRyYW5zaXRpb24gPSAnYm9yZGVyLWNvbG9yIDAuMnMgZWFzZSwgYm94LXNoYWRvdyAwLjJzIGVhc2UnO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5wYXN0ZUJ1dHRvbiA9IHRoaXMuY3JlYXRlSW5saW5lQnV0dG9uKGlucHV0Um93LCAnUGFzdGUnLCAoKSA9PiB7XG4gICAgICAgICAgICB2b2lkIHRoaXMuaGFuZGxlUGFzdGVGcm9tQ2xpcGJvYXJkKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBhc3RlQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdQYXN0ZSBZb3VUdWJlIFVSTCBmcm9tIGNsaXBib2FyZCcpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5jbGVhckJ1dHRvbiA9IHRoaXMuY3JlYXRlSW5saW5lQnV0dG9uKGlucHV0Um93LCAnQ2xlYXInLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUNsZWFyVXJsKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNsZWFyQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdDbGVhciBZb3VUdWJlIFVSTCBpbnB1dCcpO1xuICAgICAgICBcbiAgICAgICAgLy8gU2V0IGluaXRpYWwgdmFsdWUgaWYgcHJvdmlkZWRcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5pbml0aWFsVXJsKSB7XG4gICAgICAgICAgICB0aGlzLnVybElucHV0LnZhbHVlID0gdGhpcy5vcHRpb25zLmluaXRpYWxVcmw7XG4gICAgICAgICAgICB0aGlzLnVybCA9IHRoaXMub3B0aW9ucy5pbml0aWFsVXJsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVXBkYXRlIFVSTCBzdGF0ZSBvbiBpbnB1dFxuICAgICAgICB0aGlzLnVybElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMudXJsID0gKGUudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVQcm9jZXNzQnV0dG9uU3RhdGUoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUXVpY2tBY3Rpb25zU3RhdGUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy52YWxpZGF0aW9uTWVzc2FnZSA9IGNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy52YWxpZGF0aW9uTWVzc2FnZS5pZCA9ICd5dGMtdXJsLWhpbnQnO1xuICAgICAgICB0aGlzLnZhbGlkYXRpb25NZXNzYWdlLnN0eWxlLm1hcmdpblRvcCA9ICc2cHgnO1xuICAgICAgICB0aGlzLnZhbGlkYXRpb25NZXNzYWdlLnN0eWxlLmZvbnRTaXplID0gJzAuODVyZW0nO1xuICAgICAgICB0aGlzLnZhbGlkYXRpb25NZXNzYWdlLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbXV0ZWQpJztcbiAgICAgICAgdGhpcy52YWxpZGF0aW9uTWVzc2FnZS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnc3RhdHVzJyk7XG4gICAgICAgIHRoaXMuc2V0VmFsaWRhdGlvbk1lc3NhZ2UoJ1Bhc3RlIGEgWW91VHViZSBsaW5rIHRvIGJlZ2luIHByb2Nlc3NpbmcuJywgJ2luZm8nKTtcblxuICAgIC8vIFByZXZpZXcgY29udGFpbmVyICh0aHVtYm5haWwgKyBtZXRhZGF0YSlcbiAgICBjb25zdCBwcmV2aWV3ID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgIHByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICBwcmV2aWV3LnN0eWxlLmdhcCA9ICcxMHB4JztcbiAgICBwcmV2aWV3LnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJztcbiAgICBwcmV2aWV3LnN0eWxlLm1hcmdpblRvcCA9ICc4cHgnO1xuXG4gICAgdGhpcy50aHVtYm5haWxFbCA9IHByZXZpZXcuY3JlYXRlRWwoJ2ltZycpO1xuICAgIHRoaXMudGh1bWJuYWlsRWwuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ1ZpZGVvIHRodW1ibmFpbCcpO1xuICAgIHRoaXMudGh1bWJuYWlsRWwuc3R5bGUud2lkdGggPSAnMTIwcHgnO1xuICAgIHRoaXMudGh1bWJuYWlsRWwuc3R5bGUuaGVpZ2h0ID0gJzY4cHgnO1xuICAgIHRoaXMudGh1bWJuYWlsRWwuc3R5bGUub2JqZWN0Rml0ID0gJ2NvdmVyJztcbiAgICB0aGlzLnRodW1ibmFpbEVsLnN0eWxlLmJvcmRlclJhZGl1cyA9ICc0cHgnO1xuICAgIHRoaXMudGh1bWJuYWlsRWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblxuICAgIHRoaXMubWV0YWRhdGFDb250YWluZXIgPSBwcmV2aWV3LmNyZWF0ZURpdigpO1xuICAgIHRoaXMubWV0YWRhdGFDb250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ1ZpZGVvIG1ldGFkYXRhJyk7XG4gICAgdGhpcy5tZXRhZGF0YUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIHRoaXMubWV0YWRhdGFDb250YWluZXIuc3R5bGUuZm9udFNpemUgPSAnMC45cmVtJztcbiAgICB0aGlzLm1ldGFkYXRhQ29udGFpbmVyLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbm9ybWFsKSc7XG4gICAgdGhpcy5tZXRhZGF0YUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICd5dC1wcmV2aWV3LXRpdGxlJyB9KTtcbiAgICB0aGlzLm1ldGFkYXRhQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ3l0LXByZXZpZXctY2hhbm5lbCcgfSk7XG5cbiAgICAgICAgdGhpcy5zZXRVcmxJbnB1dFN0YXRlKCdpZGxlJyk7XG4gICAgICAgIHRoaXMudXBkYXRlUXVpY2tBY3Rpb25zU3RhdGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgZm9ybWF0IHNlbGVjdGlvbiBzZWN0aW9uIHdpdGggcmFkaW8gYnV0dG9uc1xuICAgICAqL1xuICAgIHByaXZhdGUgY3JlYXRlRm9ybWF0U2VsZWN0aW9uU2VjdGlvbigpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IGxhYmVsID0gY29udGFpbmVyLmNyZWF0ZUVsKCdsYWJlbCcsIHsgdGV4dDogJ091dHB1dCBGb3JtYXQ6JyB9KTtcbiAgICAgICAgbGFiZWwuaWQgPSAnZm9ybWF0LWdyb3VwLWxhYmVsJztcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHJhZGlvQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICByYWRpb0NvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnZ3JvdXAnKTtcbiAgICAgICAgcmFkaW9Db250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsbGVkYnknLCAnZm9ybWF0LWdyb3VwLWxhYmVsJyk7XG4gICAgICAgIHJhZGlvQ29udGFpbmVyLnN0eWxlLm1hcmdpblRvcCA9ICc4cHgnO1xuICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICByYWRpb0NvbnRhaW5lci5zdHlsZS5nYXAgPSAnMjBweCc7XG4gICAgICAgIHJhZGlvQ29udGFpbmVyLnN0eWxlLmZsZXhXcmFwID0gJ3dyYXAnO1xuICAgICAgICBcbiAgICAgICAgLy8gRXhlY3V0aXZlIHJhZGlvIGJ1dHRvblxuICAgICAgICBjb25zdCBleGVjdXRpdmVDb250YWluZXIgPSByYWRpb0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgZXhlY3V0aXZlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG4gICAgICAgIGV4ZWN1dGl2ZUNvbnRhaW5lci5zdHlsZS5hbGlnbkl0ZW1zID0gJ2NlbnRlcic7XG4gICAgICAgIGV4ZWN1dGl2ZUNvbnRhaW5lci5zdHlsZS5nYXAgPSAnOHB4JztcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGV4ZWN1dGl2ZVJhZGlvID0gZXhlY3V0aXZlQ29udGFpbmVyLmNyZWF0ZUVsKCdpbnB1dCcpO1xuICAgICAgICBleGVjdXRpdmVSYWRpby50eXBlID0gJ3JhZGlvJztcbiAgICAgICAgZXhlY3V0aXZlUmFkaW8ubmFtZSA9ICdvdXRwdXRGb3JtYXQnO1xuICAgICAgICBleGVjdXRpdmVSYWRpby52YWx1ZSA9ICdleGVjdXRpdmUtc3VtbWFyeSc7XG4gICAgICAgIGV4ZWN1dGl2ZVJhZGlvLmlkID0gJ2V4ZWN1dGl2ZS1yYWRpbyc7XG4gICAgICAgIGV4ZWN1dGl2ZVJhZGlvLmNoZWNrZWQgPSB0aGlzLmZvcm1hdCA9PT0gJ2V4ZWN1dGl2ZS1zdW1tYXJ5JztcbiAgICAgICAgZXhlY3V0aXZlUmFkaW8uc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ0V4ZWN1dGl2ZSBTdW1tYXJ5IGZvcm1hdCcpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZXhlY3V0aXZlTGFiZWwgPSBleGVjdXRpdmVDb250YWluZXIuY3JlYXRlRWwoJ2xhYmVsJyk7XG4gICAgICAgIGV4ZWN1dGl2ZUxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ2V4ZWN1dGl2ZS1yYWRpbycpO1xuICAgICAgICBleGVjdXRpdmVMYWJlbC50ZXh0Q29udGVudCA9ICdFeGVjdXRpdmUnO1xuICAgICAgICBleGVjdXRpdmVMYWJlbC5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgICAgIFxuICAgICAgICAvLyBUdXRvcmlhbCByYWRpbyBidXR0b25cbiAgICAgICAgY29uc3QgdHV0b3JpYWxDb250YWluZXIgPSByYWRpb0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgdHV0b3JpYWxDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgdHV0b3JpYWxDb250YWluZXIuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xuICAgICAgICB0dXRvcmlhbENvbnRhaW5lci5zdHlsZS5nYXAgPSAnOHB4JztcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHR1dG9yaWFsUmFkaW8gPSB0dXRvcmlhbENvbnRhaW5lci5jcmVhdGVFbCgnaW5wdXQnKTtcbiAgICAgICAgdHV0b3JpYWxSYWRpby50eXBlID0gJ3JhZGlvJztcbiAgICAgICAgdHV0b3JpYWxSYWRpby5uYW1lID0gJ291dHB1dEZvcm1hdCc7XG4gICAgICAgIHR1dG9yaWFsUmFkaW8udmFsdWUgPSAnZGV0YWlsZWQtZ3VpZGUnO1xuICAgICAgICB0dXRvcmlhbFJhZGlvLmlkID0gJ3R1dG9yaWFsLXJhZGlvJztcbiAgICAgICAgdHV0b3JpYWxSYWRpby5jaGVja2VkID0gdGhpcy5mb3JtYXQgPT09ICdkZXRhaWxlZC1ndWlkZSc7XG4gICAgICAgIHR1dG9yaWFsUmFkaW8uc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ0RldGFpbGVkIEd1aWRlIGZvcm1hdCcpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgdHV0b3JpYWxMYWJlbCA9IHR1dG9yaWFsQ29udGFpbmVyLmNyZWF0ZUVsKCdsYWJlbCcpO1xuICAgICAgICB0dXRvcmlhbExhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ3R1dG9yaWFsLXJhZGlvJyk7XG4gICAgICAgIHR1dG9yaWFsTGFiZWwudGV4dENvbnRlbnQgPSAnVHV0b3JpYWwnO1xuICAgICAgICB0dXRvcmlhbExhYmVsLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lcnNcbiAgICAgICAgZXhlY3V0aXZlUmFkaW8uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHtcbiAgICAgICAgICAgIGlmICgoZS50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkuY2hlY2tlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9ybWF0ID0gJ2V4ZWN1dGl2ZS1zdW1tYXJ5JztcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXN0b21Qcm9tcHRDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgdHV0b3JpYWxSYWRpby5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKChlLnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50KS5jaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtYXQgPSAnZGV0YWlsZWQtZ3VpZGUnO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1c3RvbVByb21wdENvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1c3RvbVByb21wdENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQnJpZWYgcmFkaW8gYnV0dG9uXG4gICAgICAgIGNvbnN0IGJyaWVmQ29udGFpbmVyID0gcmFkaW9Db250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGJyaWVmQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG4gICAgICAgIGJyaWVmQ29udGFpbmVyLnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJztcbiAgICAgICAgYnJpZWZDb250YWluZXIuc3R5bGUuZ2FwID0gJzhweCc7XG5cbiAgICAgICAgY29uc3QgYnJpZWZSYWRpbyA9IGJyaWVmQ29udGFpbmVyLmNyZWF0ZUVsKCdpbnB1dCcpO1xuICAgICAgICBicmllZlJhZGlvLnR5cGUgPSAncmFkaW8nO1xuICAgICAgICBicmllZlJhZGlvLm5hbWUgPSAnb3V0cHV0Rm9ybWF0JztcbiAgICAgICAgYnJpZWZSYWRpby52YWx1ZSA9ICdicmllZic7XG4gICAgICAgIGJyaWVmUmFkaW8uaWQgPSAnYnJpZWYtcmFkaW8nO1xuICAgICAgICBicmllZlJhZGlvLmNoZWNrZWQgPSB0aGlzLmZvcm1hdCA9PT0gJ2JyaWVmJztcbiAgICAgICAgYnJpZWZSYWRpby5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnQnJpZWYgZm9ybWF0Jyk7XG5cbiAgICAgICAgY29uc3QgYnJpZWZMYWJlbCA9IGJyaWVmQ29udGFpbmVyLmNyZWF0ZUVsKCdsYWJlbCcpO1xuICAgICAgICBicmllZkxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ2JyaWVmLXJhZGlvJyk7XG4gICAgICAgIGJyaWVmTGFiZWwudGV4dENvbnRlbnQgPSAnQnJpZWYnO1xuICAgICAgICBicmllZkxhYmVsLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcblxuICAgICAgICBicmllZlJhZGlvLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoKGUudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLmNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdCA9ICdicmllZic7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VzdG9tUHJvbXB0Q29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDdXN0b20gcmFkaW8gYnV0dG9uXG4gICAgICAgIGNvbnN0IGN1c3RvbUNvbnRhaW5lciA9IHJhZGlvQ29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBjdXN0b21Db250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgY3VzdG9tQ29udGFpbmVyLnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJztcbiAgICAgICAgY3VzdG9tQ29udGFpbmVyLnN0eWxlLmdhcCA9ICc4cHgnO1xuXG4gICAgICAgIGNvbnN0IGN1c3RvbVJhZGlvID0gY3VzdG9tQ29udGFpbmVyLmNyZWF0ZUVsKCdpbnB1dCcpO1xuICAgICAgICBjdXN0b21SYWRpby50eXBlID0gJ3JhZGlvJztcbiAgICAgICAgY3VzdG9tUmFkaW8ubmFtZSA9ICdvdXRwdXRGb3JtYXQnO1xuICAgICAgICBjdXN0b21SYWRpby52YWx1ZSA9ICdjdXN0b20nO1xuICAgICAgICBjdXN0b21SYWRpby5pZCA9ICdjdXN0b20tcmFkaW8nO1xuICAgICAgICBjdXN0b21SYWRpby5jaGVja2VkID0gdGhpcy5mb3JtYXQgPT09ICdjdXN0b20nO1xuICAgICAgICBjdXN0b21SYWRpby5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnQ3VzdG9tIHByb21wdCBmb3JtYXQnKTtcblxuICAgICAgICBjb25zdCBjdXN0b21MYWJlbCA9IGN1c3RvbUNvbnRhaW5lci5jcmVhdGVFbCgnbGFiZWwnKTtcbiAgICAgICAgY3VzdG9tTGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAnY3VzdG9tLXJhZGlvJyk7XG4gICAgICAgIGN1c3RvbUxhYmVsLnRleHRDb250ZW50ID0gJ0N1c3RvbSc7XG4gICAgICAgIGN1c3RvbUxhYmVsLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcblxuICAgICAgICBjdXN0b21SYWRpby5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKChlLnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50KS5jaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtYXQgPSAnY3VzdG9tJztcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXN0b21Qcm9tcHRDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0SW5wdXQ/LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDcmVhdGUgY3VzdG9tIHByb21wdCB0ZXh0YXJlYSBjb250YWluZXIgKGluaXRpYWxseSBoaWRkZW4pXG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0Q29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLmN1c3RvbVByb21wdENvbnRhaW5lci5zdHlsZS5tYXJnaW5Ub3AgPSAnMTJweCc7XG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0Q29udGFpbmVyLnN0eWxlLnBhZGRpbmcgPSAnMTJweCc7XG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0Q29udGFpbmVyLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWhvdmVyKSc7XG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0Q29udGFpbmVyLnN0eWxlLmJvcmRlclJhZGl1cyA9ICc0cHgnO1xuICAgICAgICB0aGlzLmN1c3RvbVByb21wdENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY3VzdG9tUHJvbXB0TGFiZWwgPSB0aGlzLmN1c3RvbVByb21wdENvbnRhaW5lci5jcmVhdGVFbCgnbGFiZWwnLCB7XG4gICAgICAgICAgICB0ZXh0OiAnQ3VzdG9tIFByb21wdCAodGhpcyBzZXNzaW9uIG9ubHkpOidcbiAgICAgICAgfSk7XG4gICAgICAgIGN1c3RvbVByb21wdExhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ2N1c3RvbS1wcm9tcHQtaW5wdXQnKTtcbiAgICAgICAgY3VzdG9tUHJvbXB0TGFiZWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIGN1c3RvbVByb21wdExhYmVsLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICc2cHgnO1xuICAgICAgICBjdXN0b21Qcm9tcHRMYWJlbC5zdHlsZS5mb250V2VpZ2h0ID0gJzYwMCc7XG4gICAgICAgIGN1c3RvbVByb21wdExhYmVsLnN0eWxlLmZvbnRTaXplID0gJzAuOTVyZW0nO1xuXG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0SW5wdXQgPSB0aGlzLmN1c3RvbVByb21wdENvbnRhaW5lci5jcmVhdGVFbCgndGV4dGFyZWEnKTtcbiAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRJbnB1dC5pZCA9ICdjdXN0b20tcHJvbXB0LWlucHV0JztcbiAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRJbnB1dC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnQ3VzdG9tIEFJIHByb21wdCcpO1xuICAgICAgICB0aGlzLmN1c3RvbVByb21wdElucHV0LnNldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInLCAnRW50ZXIgeW91ciBjdXN0b20gcHJvbXB0IGhlcmUuIEF2YWlsYWJsZSBwbGFjZWhvbGRlcnM6IF9fVklERU9fVElUTEVfXywgX19WSURFT19ERVNDUklQVElPTl9fLCBfX1ZJREVPX1VSTF9fJyk7XG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0SW5wdXQuc3R5bGUud2lkdGggPSAnMTAwJSc7XG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0SW5wdXQuc3R5bGUuaGVpZ2h0ID0gJzEwMHB4JztcbiAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRJbnB1dC5zdHlsZS5wYWRkaW5nID0gJzhweCc7XG4gICAgICAgIHRoaXMuY3VzdG9tUHJvbXB0SW5wdXQuc3R5bGUuZm9udEZhbWlseSA9ICdtb25vc3BhY2UnO1xuICAgICAgICB0aGlzLmN1c3RvbVByb21wdElucHV0LnN0eWxlLmZvbnRTaXplID0gJzEycHgnO1xuICAgICAgICB0aGlzLmN1c3RvbVByb21wdElucHV0LnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRJbnB1dC5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNHB4JztcbiAgICAgICAgdGhpcy5jdXN0b21Qcm9tcHRJbnB1dC5zdHlsZS5yZXNpemUgPSAndmVydGljYWwnO1xuICAgICAgICB0aGlzLmN1c3RvbVByb21wdElucHV0LnN0eWxlLm1hcmdpbkJvdHRvbSA9ICc2cHgnO1xuXG4gICAgICAgIGNvbnN0IGhlbHBUZXh0ID0gdGhpcy5jdXN0b21Qcm9tcHRDb250YWluZXIuY3JlYXRlRWwoJ3NtYWxsJyk7XG4gICAgICAgIGhlbHBUZXh0LnRleHRDb250ZW50ID0gJ1BsYWNlaG9sZGVyczogX19WSURFT19USVRMRV9fLCBfX1ZJREVPX0RFU0NSSVBUSU9OX18sIF9fVklERU9fVVJMX18sIF9fVklERU9fSURfXywgX19FTUJFRF9VUkxfXywgX19EQVRFX18sIF9fVElNRVNUQU1QX18nO1xuICAgICAgICBoZWxwVGV4dC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgaGVscFRleHQuc3R5bGUubWFyZ2luVG9wID0gJzRweCc7XG4gICAgICAgIGhlbHBUZXh0LnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbXV0ZWQpJztcbiAgICAgICAgaGVscFRleHQuc3R5bGUuZm9udFNpemUgPSAnMTFweCc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHByb2dyZXNzIHNlY3Rpb25cbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZVByb2dyZXNzU2VjdGlvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wcm9ncmVzc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLnByb2dyZXNzQ29udGFpbmVyLnNldEF0dHJpYnV0ZSgncm9sZScsICdyZWdpb24nKTtcbiAgICAgICAgdGhpcy5wcm9ncmVzc0NvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnUHJvY2Vzc2luZyBwcm9ncmVzcycpO1xuICAgICAgICB0aGlzLnByb2dyZXNzQ29udGFpbmVyLnNldEF0dHJpYnV0ZSgnYXJpYS1saXZlJywgJ3BvbGl0ZScpO1xuICAgICAgICB0aGlzLnByb2dyZXNzQ29udGFpbmVyLnN0eWxlLm1hcmdpblRvcCA9ICcxNnB4JztcbiAgICAgICAgdGhpcy5wcm9ncmVzc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICBcbiAgICAgICAgLy8gUHJvZ3Jlc3MgdGV4dFxuICAgICAgICB0aGlzLnByb2dyZXNzVGV4dCA9IHRoaXMucHJvZ3Jlc3NDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NUZXh0LmlkID0gJ3Byb2dyZXNzLXRleHQnO1xuICAgICAgICB0aGlzLnByb2dyZXNzVGV4dC5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnOHB4JztcbiAgICAgICAgdGhpcy5wcm9ncmVzc1RleHQuc3R5bGUuZm9udFdlaWdodCA9ICc1MDAnO1xuICAgICAgICB0aGlzLnByb2dyZXNzVGV4dC5zdHlsZS5jb2xvciA9ICd2YXIoLS10ZXh0LWFjY2VudCknO1xuICAgICAgICB0aGlzLnByb2dyZXNzVGV4dC50ZXh0Q29udGVudCA9ICdQcm9jZXNzaW5nIHZpZGVvLi4uJztcbiAgICAgICAgXG4gICAgICAgIC8vIFByb2dyZXNzIGJhciBjb250YWluZXJcbiAgICAgICAgY29uc3QgcHJvZ3Jlc3NCYXJDb250YWluZXIgPSB0aGlzLnByb2dyZXNzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBwcm9ncmVzc0JhckNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAncHJvZ3Jlc3NiYXInKTtcbiAgICAgICAgcHJvZ3Jlc3NCYXJDb250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbm93JywgJzAnKTtcbiAgICAgICAgcHJvZ3Jlc3NCYXJDb250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWluJywgJzAnKTtcbiAgICAgICAgcHJvZ3Jlc3NCYXJDb250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWF4JywgJzEwMCcpO1xuICAgICAgICBwcm9ncmVzc0JhckNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScsICdwcm9ncmVzcy10ZXh0Jyk7XG4gICAgICAgIHByb2dyZXNzQmFyQ29udGFpbmVyLnN0eWxlLndpZHRoID0gJzEwMCUnO1xuICAgICAgICBwcm9ncmVzc0JhckNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSAnNnB4JztcbiAgICAgICAgcHJvZ3Jlc3NCYXJDb250YWluZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XG4gICAgICAgIHByb2dyZXNzQmFyQ29udGFpbmVyLnN0eWxlLmJvcmRlclJhZGl1cyA9ICczcHgnO1xuICAgICAgICBwcm9ncmVzc0JhckNvbnRhaW5lci5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuICAgICAgICBcbiAgICAgICAgLy8gUHJvZ3Jlc3MgYmFyXG4gICAgICAgIHRoaXMucHJvZ3Jlc3NCYXIgPSBwcm9ncmVzc0JhckNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5wcm9ncmVzc0Jhci5zdHlsZS5oZWlnaHQgPSAnMTAwJSc7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NCYXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLXRleHQtYWNjZW50KSc7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NCYXIuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzNweCc7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAnMCUnO1xuICAgICAgICB0aGlzLnByb2dyZXNzQmFyLnN0eWxlLnRyYW5zaXRpb24gPSAnd2lkdGggMC4zcyBlYXNlJztcblxuICAgICAgICBjb25zdCBzdGVwTGlzdCA9IHRoaXMucHJvZ3Jlc3NDb250YWluZXIuY3JlYXRlRWwoJ29sJyk7XG4gICAgICAgIHN0ZXBMaXN0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdQcm9jZXNzaW5nIHN0ZXBzJyk7XG4gICAgICAgIHN0ZXBMaXN0LnN0eWxlLm1hcmdpblRvcCA9ICcxMnB4JztcbiAgICAgICAgc3RlcExpc3Quc3R5bGUucGFkZGluZ0xlZnQgPSAnMjBweCc7XG4gICAgICAgIHN0ZXBMaXN0LnN0eWxlLmZvbnRTaXplID0gJzAuOXJlbSc7XG4gICAgICAgIHN0ZXBMaXN0LnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbm9ybWFsKSc7XG5cbiAgICAgICAgY29uc3QgbGFiZWxzID0gW1xuICAgICAgICAgICAgJ1ZhbGlkYXRlIFVSTCcsXG4gICAgICAgICAgICAnRmV0Y2ggdmlkZW8gaW5mbycsXG4gICAgICAgICAgICAnUnVuIEFJIGFuYWx5c2lzJyxcbiAgICAgICAgICAgICdTYXZlIG5vdGUnXG4gICAgICAgIF07XG5cbiAgICAgICAgdGhpcy5wcm9ncmVzc1N0ZXBzID0gbGFiZWxzLm1hcCgobGFiZWwpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBzdGVwTGlzdC5jcmVhdGVFbCgnbGknKTtcbiAgICAgICAgICAgIGl0ZW0uc2V0QXR0cmlidXRlKCdyb2xlJywgJ3N0YXR1cycpO1xuICAgICAgICAgICAgaXRlbS5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnNHB4JztcbiAgICAgICAgICAgIGl0ZW0udGV4dENvbnRlbnQgPSBgXHUyNUNCICR7bGFiZWx9YDtcbiAgICAgICAgICAgIHJldHVybiB7IGxhYmVsLCBlbGVtZW50OiBpdGVtIH07XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhY3Rpb24gYnV0dG9ucyB3aXRoIGFjY2Vzc2liaWxpdHlcbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZUFjdGlvbkJ1dHRvbnMoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY3JlYXRlQnV0dG9uQ29udGFpbmVyKCk7XG5cbiAgICAgICAgLy8gQ2FuY2VsIGJ1dHRvblxuICAgICAgICBjb25zdCBjYW5jZWxCdG4gPSB0aGlzLmNyZWF0ZUJ1dHRvbihcbiAgICAgICAgICAgIGNvbnRhaW5lcixcbiAgICAgICAgICAgIE1FU1NBR0VTLk1PREFMUy5DQU5DRUwsXG4gICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgICgpID0+IHRoaXMuY2xvc2UoKVxuICAgICAgICApO1xuICAgICAgICBjYW5jZWxCdG4uc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ0NhbmNlbCB2aWRlbyBwcm9jZXNzaW5nJyk7XG5cbiAgICAgICAgLy8gUHJvY2VzcyBidXR0b25cbiAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uID0gdGhpcy5jcmVhdGVCdXR0b24oXG4gICAgICAgICAgICBjb250YWluZXIsXG4gICAgICAgICAgICBNRVNTQUdFUy5NT0RBTFMuUFJPQ0VTUyxcbiAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICAoKSA9PiB0aGlzLmhhbmRsZVByb2Nlc3MoKVxuICAgICAgICApO1xuICAgICAgICB0aGlzLnByb2Nlc3NCdXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ1Byb2Nlc3MgWW91VHViZSB2aWRlbycpO1xuXG4gICAgICAgIC8vIE9wZW4gYnV0dG9uIChoaWRkZW4gaW5pdGlhbGx5KVxuICAgICAgICB0aGlzLm9wZW5CdXR0b24gPSB0aGlzLmNyZWF0ZUJ1dHRvbihcbiAgICAgICAgICAgIGNvbnRhaW5lcixcbiAgICAgICAgICAgICdPcGVuIE5vdGUnLFxuICAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICAgICgpID0+IHRoaXMuaGFuZGxlT3BlbkZpbGUoKVxuICAgICAgICApO1xuICAgICAgICB0aGlzLm9wZW5CdXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ09wZW4gdGhlIHByb2Nlc3NlZCBub3RlJyk7XG4gICAgICAgIHRoaXMub3BlbkJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXG4gICAgICAgIHRoaXMudXBkYXRlUHJvY2Vzc0J1dHRvblN0YXRlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHVwIGV2ZW50IGhhbmRsZXJzXG4gICAgICovXG4gICAgcHJpdmF0ZSBzZXR1cEV2ZW50SGFuZGxlcnMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2V0dXBLZXlIYW5kbGVycyhcbiAgICAgICAgICAgICgpID0+IHRoaXMuaGFuZGxlUHJvY2VzcygpLFxuICAgICAgICAgICAgKCkgPT4gdGhpcy5jbG9zZSgpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRm9jdXMgb24gVVJMIGlucHV0XG4gICAgICovXG4gICAgcHJpdmF0ZSBmb2N1c1VybElucHV0KCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy51cmxJbnB1dCkge1xuICAgICAgICAgICAgdGhpcy5mb2N1c0VsZW1lbnQodGhpcy51cmxJbnB1dCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgcHJvY2VzcyBidXR0b24gZW5hYmxlZCBzdGF0ZSAob3B0aW1pemVkIHdpdGggZGVib3VuY2luZyBhbmQgbWVtb2l6YXRpb24pXG4gICAgICovXG4gICAgcHJpdmF0ZSB1cGRhdGVQcm9jZXNzQnV0dG9uU3RhdGUoKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5wcm9jZXNzQnV0dG9uKSByZXR1cm47XG5cbiAgICAgICAgaWYgKHRoaXMuaXNQcm9jZXNzaW5nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB0cmltbWVkVXJsID0gdGhpcy51cmwudHJpbSgpO1xuXG4gICAgICAgIGlmICh0aGlzLnByb2Nlc3NCdXR0b24gJiYgdGhpcy5wcm9jZXNzQnV0dG9uLnRleHRDb250ZW50ICE9PSBNRVNTQUdFUy5NT0RBTFMuUFJPQ0VTUyAmJiB0cmltbWVkVXJsLmxlbmd0aCA+PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NCdXR0b24udGV4dENvbnRlbnQgPSBNRVNTQUdFUy5NT0RBTFMuUFJPQ0VTUztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gTWVtb2l6ZSB2YWxpZGF0aW9uIHJlc3VsdCBmb3Igc2FtZSBVUkwgKGF2b2lkIHJlcGVhdGVkIGV4cGVuc2l2ZSB2YWxpZGF0aW9uKVxuICAgICAgICBpZiAodHJpbW1lZFVybCA9PT0gdGhpcy5sYXN0VmFsaWRVcmwpIHtcbiAgICAgICAgICAgIGNvbnN0IGlzVmFsaWQgPSB0aGlzLmxhc3RWYWxpZFJlc3VsdCE7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NCdXR0b24uZGlzYWJsZWQgPSAhaXNWYWxpZDtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0J1dHRvbi5zdHlsZS5vcGFjaXR5ID0gaXNWYWxpZCA/ICcxJyA6ICcwLjUnO1xuICAgICAgICAgICAgaWYgKHRyaW1tZWRVcmwubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZSgnUGFzdGUgYSBZb3VUdWJlIGxpbmsgdG8gYmVnaW4gcHJvY2Vzc2luZy4nLCAnaW5mbycpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VXJsSW5wdXRTdGF0ZSgnaWRsZScpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFZhbGlkYXRpb25NZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICBpc1ZhbGlkID8gJ1JlYWR5IHRvIHByb2Nlc3MgdGhpcyB2aWRlby4nIDogJ0VudGVyIGEgdmFsaWQgWW91VHViZSB2aWRlbyBVUkwuJyxcbiAgICAgICAgICAgICAgICAgICAgaXNWYWxpZCA/ICdzdWNjZXNzJyA6ICdlcnJvcidcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VXJsSW5wdXRTdGF0ZShpc1ZhbGlkID8gJ3ZhbGlkJyA6ICdpbnZhbGlkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVF1aWNrQWN0aW9uc1N0YXRlKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERlYm91bmNlZCB2YWxpZGF0aW9uIGZvciBiZXR0ZXIgVVggYW5kIHBlcmZvcm1hbmNlXG4gICAgICAgIGlmICh0aGlzLnZhbGlkYXRpb25UaW1lcikge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudmFsaWRhdGlvblRpbWVyKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy52YWxpZGF0aW9uVGltZXIgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpc1ZhbGlkID0gVmFsaWRhdGlvblV0aWxzLmlzVmFsaWRZb3VUdWJlVXJsKHRyaW1tZWRVcmwpO1xuICAgICAgICAgICAgdGhpcy5sYXN0VmFsaWRVcmwgPSB0cmltbWVkVXJsO1xuICAgICAgICAgICAgdGhpcy5sYXN0VmFsaWRSZXN1bHQgPSBpc1ZhbGlkO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NCdXR0b24hLmRpc2FibGVkID0gIWlzVmFsaWQ7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NCdXR0b24hLnN0eWxlLm9wYWNpdHkgPSBpc1ZhbGlkID8gJzEnIDogJzAuNSc7XG5cbiAgICAgICAgICAgIGlmICh0cmltbWVkVXJsLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VmFsaWRhdGlvbk1lc3NhZ2UoJ1Bhc3RlIGEgWW91VHViZSBsaW5rIHRvIGJlZ2luIHByb2Nlc3NpbmcuJywgJ2luZm8nKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFVybElucHV0U3RhdGUoJ2lkbGUnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZShcbiAgICAgICAgICAgICAgICAgICAgaXNWYWxpZCA/ICdSZWFkeSB0byBwcm9jZXNzIHRoaXMgdmlkZW8uJyA6ICdFbnRlciBhIHZhbGlkIFlvdVR1YmUgdmlkZW8gVVJMLicsXG4gICAgICAgICAgICAgICAgICAgIGlzVmFsaWQgPyAnc3VjY2VzcycgOiAnZXJyb3InXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFVybElucHV0U3RhdGUoaXNWYWxpZCA/ICd2YWxpZCcgOiAnaW52YWxpZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy51cGRhdGVRdWlja0FjdGlvbnNTdGF0ZSgpO1xuICAgICAgICAgICAgICAgIC8vIElmIFVSTCBpcyB2YWxpZCwgZmV0Y2ggYSBsaWdodHdlaWdodCBwcmV2aWV3ICh0aHVtYm5haWwgKyB0aXRsZSlcbiAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZCkge1xuICAgICAgICAgICAgICAgICAgICB2b2lkIHRoaXMubWF5YmVGZXRjaFByZXZpZXcodHJpbW1lZFVybCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhclByZXZpZXcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH0sIDMwMCk7IC8vIDMwMG1zIGRlYm91bmNlXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgVVJMIGlucHV0IChzaW1wbGlmaWVkIC0gdXNlZCBieSBkZWJvdW5jZWQgaGFuZGxlcilcbiAgICAgKi9cbiAgICBwcml2YXRlIGlzVXJsVmFsaWQoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBWYWxpZGF0aW9uVXRpbHMuaXNWYWxpZFlvdVR1YmVVcmwodGhpcy51cmwudHJpbSgpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgcHJvY2VzcyBidXR0b24gY2xpY2tcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZVByb2Nlc3MoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHRyaW1tZWRVcmwgPSB0aGlzLnVybC50cmltKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXRyaW1tZWRVcmwpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoTUVTU0FHRVMuRVJST1JTLkVOVEVSX1VSTCk7XG4gICAgICAgICAgICB0aGlzLmZvY3VzVXJsSW5wdXQoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5pc1VybFZhbGlkKCkpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoTUVTU0FHRVMuRVJST1JTLklOVkFMSURfVVJMKTtcbiAgICAgICAgICAgIHRoaXMuZm9jdXNVcmxJbnB1dCgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIElmIHVzZXIgZXhwbGljaXRseSBzZWxlY3RlZCBHb29nbGUgR2VtaW5pIGFuZCBjaG9zZSBhIG1vZGVsIHRoYXRcbiAgICAgICAgICAgIC8vIGRvZXMgbm90IHN1cHBvcnQgbXVsdGltb2RhbCBhdWRpby92aWRlbyB0b2tlbnMsIGJ1dCB0aGUgVVJMIGlzIGFcbiAgICAgICAgICAgIC8vIFlvdVR1YmUgdmlkZW8sIHN1Z2dlc3Qgc3dpdGNoaW5nIHRvIGEgbXVsdGltb2RhbC1jYXBhYmxlIG1vZGVsLlxuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRQcm92aWRlciA9PT0gJ0dvb2dsZSBHZW1pbmknICYmIHRoaXMuc2VsZWN0ZWRNb2RlbCAmJiB0aGlzLmlzVXJsVmFsaWQoKSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGVscyA9IFBST1ZJREVSX01PREVMX09QVElPTlNbJ0dvb2dsZSBHZW1pbmknXSB8fCBbXSBhcyBhbnlbXTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBtb2RlbHMuZmluZChtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSB0eXBlb2YgbSA9PT0gJ3N0cmluZycgPyBtIDogKG0gJiYgbS5uYW1lID8gbS5uYW1lIDogJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhuYW1lKS50b0xvd2VyQ2FzZSgpID09PSBTdHJpbmcodGhpcy5zZWxlY3RlZE1vZGVsIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KSBhcyBhbnkgfCB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3VwcG9ydHNBdWRpb1ZpZGVvID0gISEobWF0Y2ggJiYgbWF0Y2guc3VwcG9ydHNBdWRpb1ZpZGVvKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzdXBwb3J0c0F1ZGlvVmlkZW8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlY29tbWVuZCBhIG11bHRpbW9kYWwtY2FwYWJsZSBtb2RlbCAocHJlZmVyIGNvbmZpZ3VyZWQgZGVmYXVsdClcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlY29tbWVuZGVkID0gKG1vZGVscy5maW5kKG0gPT4gKG0gJiYgbS5zdXBwb3J0c0F1ZGlvVmlkZW8pKSB8fCB7IG5hbWU6IEFJX01PREVMUy5HRU1JTkkgfSkubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVzZSBjdXN0b20gc3R5bGVkIGNvbmZpcm1hdGlvbiBtb2RhbCBpbnN0ZWFkIG9mIG5hdGl2ZSBjb25maXJtKClcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNob3VsZFN3aXRjaCA9IGF3YWl0IHRoaXMuc2hvd0NvbmZpcm1hdGlvbk1vZGFsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdNdWx0aW1vZGFsIE1vZGVsIFJlY29tbWVuZGVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgVGhlIHNlbGVjdGVkIG1vZGVsICgke3RoaXMuc2VsZWN0ZWRNb2RlbH0pIG1heSBub3Qgc3VwcG9ydCBtdWx0aW1vZGFsIGFuYWx5c2lzLlxcblxcbldvdWxkIHlvdSBsaWtlIHRvIHN3aXRjaCB0byBhIG11bHRpbW9kYWwtY2FwYWJsZSBtb2RlbCAoJHtyZWNvbW1lbmRlZH0pIGZvciBiZXR0ZXIgdmlkZW8gYW5hbHlzaXM/YCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnU3dpdGNoIHRvIE11bHRpbW9kYWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdLZWVwIEN1cnJlbnQgTW9kZWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNob3VsZFN3aXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVuc3VyZSB0aGUgcmVjb21tZW5kZWQgbW9kZWwgZXhpc3RzIGluIHRoZSBjdXJyZW50IG1vZGVsU2VsZWN0OyBpZiBub3QsIGFkZCBpdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGVsU2VsZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0cyA9IEFycmF5LmZyb20odGhpcy5tb2RlbFNlbGVjdC5vcHRpb25zKS5zb21lKG8gPT4gby52YWx1ZSA9PT0gcmVjb21tZW5kZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWV4aXN0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3B0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHQudmFsdWUgPSByZWNvbW1lbmRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdC50ZXh0ID0gcmVjb21tZW5kZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZGVsU2VsZWN0LmFwcGVuZENoaWxkKG9wdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2RlbFNlbGVjdC52YWx1ZSA9IHJlY29tbWVuZGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTW9kZWwgPSByZWNvbW1lbmRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTW9kZWwgPSByZWNvbW1lbmRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTm9uLWZhdGFsOiBmYWxsIGJhY2sgdG8gZGVmYXVsdCBiZWhhdmlvclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1tZb3VUdWJlVXJsTW9kYWxdIG1vZGVsIHJlY29tbWVuZGF0aW9uIGZhaWxlZCcsIGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zaG93UHJvY2Vzc2luZ1N0YXRlKCk7XG4gICAgICAgICAgICB0aGlzLnNldFN0ZXBTdGF0ZSgwLCAnYWN0aXZlJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFN0YXJ0IHByb2Nlc3Npbmcgd2l0aCBwcm9ncmVzcyB1cGRhdGVzXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVByb2dyZXNzKDIwLCAnVmFsaWRhdGluZyBZb3VUdWJlIFVSTC4uLicpO1xuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwMCkpO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGVwU3RhdGUoMCwgJ2NvbXBsZXRlJyk7XG4gICAgICAgICAgICB0aGlzLnNldFN0ZXBTdGF0ZSgxLCAnYWN0aXZlJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUHJvZ3Jlc3MoNDAsICdFeHRyYWN0aW5nIHZpZGVvIGRhdGEuLi4nKTtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RlcFN0YXRlKDEsICdjb21wbGV0ZScpO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGVwU3RhdGUoMiwgJ2FjdGl2ZScpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVByb2dyZXNzKDYwLCAnQW5hbHl6aW5nIHZpZGVvIGNvbnRlbnQuLi4nKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2FsbCB0aGUgYWN0dWFsIHByb2Nlc3NpbmcgZnVuY3Rpb24gKHBhc3MgcHJvdmlkZXIvbW9kZWwgc2VsZWN0aW9uKVxuICAgICAgICAgICAgY29uc3QgY3VzdG9tUHJvbXB0ID0gdGhpcy5mb3JtYXQgPT09ICdjdXN0b20nID8gdGhpcy5jdXN0b21Qcm9tcHRJbnB1dD8udmFsdWUgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGF3YWl0IHRoaXMub3B0aW9ucy5vblByb2Nlc3MoXG4gICAgICAgICAgICAgICAgdHJpbW1lZFVybCxcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdCxcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE1vZGVsLFxuICAgICAgICAgICAgICAgIGN1c3RvbVByb21wdFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RlcFN0YXRlKDIsICdjb21wbGV0ZScpO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGVwU3RhdGUoMywgJ2FjdGl2ZScpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVByb2dyZXNzKDgwLCAnR2VuZXJhdGluZyBub3RlLi4uJyk7XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMzAwKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUHJvZ3Jlc3MoMTAwLCAnQ29tcGxldGUhJyk7XG4gICAgICAgICAgICB0aGlzLnNldFN0ZXBTdGF0ZSgzLCAnY29tcGxldGUnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIGZpbGUgcGF0aCBhbmQgc2hvdyBjb21wbGV0aW9uIHN0YXRlXG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NlZEZpbGVQYXRoID0gZmlsZVBhdGg7XG4gICAgICAgICAgICB0aGlzLnNob3dDb21wbGV0aW9uU3RhdGUoKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5mbGFnQWN0aXZlU3RlcEFzRXJyb3IoKTtcbiAgICAgICAgICAgIHRoaXMuc2hvd0Vycm9yU3RhdGUoZXJyb3IgYXMgRXJyb3IpO1xuICAgICAgICAgICAgRXJyb3JIYW5kbGVyLmhhbmRsZShlcnJvciBhcyBFcnJvciwgJ1lvdVR1YmUgVVJMIHByb2Nlc3NpbmcnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBvcGVuIGZpbGUgYnV0dG9uIGNsaWNrXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVPcGVuRmlsZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMucHJvY2Vzc2VkRmlsZVBhdGggJiYgdGhpcy5vcHRpb25zLm9uT3BlbkZpbGUpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5vcHRpb25zLm9uT3BlbkZpbGUodGhpcy5wcm9jZXNzZWRGaWxlUGF0aCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBFcnJvckhhbmRsZXIuaGFuZGxlKGVycm9yIGFzIEVycm9yLCAnT3BlbmluZyBmaWxlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaG93IHByb2Nlc3Npbmcgc3RhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIHNob3dQcm9jZXNzaW5nU3RhdGUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuaXNQcm9jZXNzaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZSgnUHJvY2Vzc2luZyB2aWRlby4gVGhpcyBtYXkgdGFrZSBhIG1vbWVudC4uLicsICdpbmZvJyk7XG4gICAgICAgIHRoaXMucmVzZXRQcm9ncmVzc1N0ZXBzKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBTaG93IHByb2dyZXNzIHNlY3Rpb25cbiAgICAgICAgaWYgKHRoaXMucHJvZ3Jlc3NDb250YWluZXIpIHtcbiAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERpc2FibGUgaW5wdXRzIGFuZCBwcm9jZXNzIGJ1dHRvblxuICAgICAgICBpZiAodGhpcy51cmxJbnB1dCkge1xuICAgICAgICAgICAgdGhpcy51cmxJbnB1dC5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJvY2Vzc0J1dHRvbikge1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0J1dHRvbi50ZXh0Q29udGVudCA9ICdQcm9jZXNzaW5nLi4uJztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vcGVuQnV0dG9uKSB7XG4gICAgICAgICAgICB0aGlzLm9wZW5CdXR0b24uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2V0VXJsSW5wdXRTdGF0ZSgnaWRsZScpO1xuICAgICAgICB0aGlzLnVwZGF0ZVF1aWNrQWN0aW9uc1N0YXRlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2hvdyBjb21wbGV0aW9uIHN0YXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBzaG93Q29tcGxldGlvblN0YXRlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmlzUHJvY2Vzc2luZyA9IGZhbHNlO1xuXG4gICAgICAgIGlmICh0aGlzLnByb2dyZXNzQ29udGFpbmVyKSB7XG4gICAgICAgICAgICB0aGlzLnByb2dyZXNzQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy51cmxJbnB1dCkge1xuICAgICAgICAgICAgdGhpcy51cmxJbnB1dC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnByb2Nlc3NCdXR0b24pIHtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0J1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uLnRleHRDb250ZW50ID0gJ1Byb2Nlc3MgQW5vdGhlcic7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NCdXR0b24uc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snO1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uLnN0eWxlLm9wYWNpdHkgPSAnMSc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub3BlbkJ1dHRvbikge1xuICAgICAgICAgICAgdGhpcy5vcGVuQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmhlYWRlckVsKSB7XG4gICAgICAgICAgICB0aGlzLmhlYWRlckVsLnRleHRDb250ZW50ID0gJ1x1MjcwNSBWaWRlbyBQcm9jZXNzZWQgU3VjY2Vzc2Z1bGx5ISc7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNldFZhbGlkYXRpb25NZXNzYWdlKFwiTm90ZSBzYXZlZCB0byB0b2RheSdzIGZvbGRlci4gWW91IGNhbiBvcGVuIGl0IG5vdyBvciBwcm9jZXNzIGFub3RoZXIgdmlkZW8uXCIsICdzdWNjZXNzJyk7XG4gICAgICAgIHRoaXMuZm9jdXNVcmxJbnB1dCgpO1xuICAgICAgICB0aGlzLnVwZGF0ZVF1aWNrQWN0aW9uc1N0YXRlKCk7XG4gICAgICAgIHRoaXMuc2V0VXJsSW5wdXRTdGF0ZSh0aGlzLnVybC50cmltKCkubGVuZ3RoID4gMCA/ICd2YWxpZCcgOiAnaWRsZScpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3cgZXJyb3Igc3RhdGVcbiAgICAgKi9cbiAgICBwcml2YXRlIHNob3dFcnJvclN0YXRlKGVycm9yOiBFcnJvcik6IHZvaWQge1xuICAgICAgICB0aGlzLmlzUHJvY2Vzc2luZyA9IGZhbHNlO1xuICAgICAgICBcbiAgICAgICAgaWYgKHRoaXMucHJvZ3Jlc3NDb250YWluZXIpIHtcbiAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnVybElucHV0KSB7XG4gICAgICAgICAgICB0aGlzLnVybElucHV0LmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucHJvY2Vzc0J1dHRvbikge1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NCdXR0b24udGV4dENvbnRlbnQgPSBNRVNTQUdFUy5NT0RBTFMuUFJPQ0VTUztcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0J1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub3BlbkJ1dHRvbikge1xuICAgICAgICAgICAgdGhpcy5vcGVuQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5oZWFkZXJFbCkge1xuICAgICAgICAgICAgdGhpcy5oZWFkZXJFbC50ZXh0Q29udGVudCA9ICdcdTI3NEMgUHJvY2Vzc2luZyBGYWlsZWQnO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZShlcnJvci5tZXNzYWdlLCAnZXJyb3InKTtcbiAgICAgICAgdGhpcy51cGRhdGVRdWlja0FjdGlvbnNTdGF0ZSgpO1xuICAgICAgICB0aGlzLnNldFVybElucHV0U3RhdGUodGhpcy51cmwudHJpbSgpLmxlbmd0aCA+IDAgPyAnaW52YWxpZCcgOiAnaWRsZScpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBwcm9ncmVzcyBiYXIgYW5kIHRleHRcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZVByb2dyZXNzKHBlcmNlbnQ6IG51bWJlciwgdGV4dDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnByb2dyZXNzQmFyKSB7XG4gICAgICAgICAgICB0aGlzLnByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gYCR7cGVyY2VudH0lYDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcm9ncmVzc1RleHQpIHtcbiAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3NUZXh0LnRleHRDb250ZW50ID0gdGV4dDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCBpbml0aWFsIFVSTCB2YWx1ZVxuICAgICAqL1xuICAgIHNldFVybCh1cmw6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLnVybCA9IHVybDtcbiAgICAgICAgaWYgKHRoaXMudXJsSW5wdXQpIHtcbiAgICAgICAgICAgIHRoaXMudXJsSW5wdXQudmFsdWUgPSB1cmw7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVByb2Nlc3NCdXR0b25TdGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVRdWlja0FjdGlvbnNTdGF0ZSgpO1xuICAgICAgICAgICAgY29uc3QgdHJpbW1lZCA9IHVybC50cmltKCk7XG4gICAgICAgICAgICBpZiAodHJpbW1lZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFVybElucHV0U3RhdGUoJ2lkbGUnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRVcmxJbnB1dFN0YXRlKFZhbGlkYXRpb25VdGlscy5pc1ZhbGlkWW91VHViZVVybCh0cmltbWVkKSA/ICd2YWxpZCcgOiAnaW52YWxpZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYW4gdXAgcmVzb3VyY2VzIHdoZW4gbW9kYWwgaXMgY2xvc2VkXG4gICAgICovXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcbiAgICAgICAgLy8gQ2xlYW4gdXAgdmFsaWRhdGlvbiB0aW1lclxuICAgICAgICBpZiAodGhpcy52YWxpZGF0aW9uVGltZXIpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnZhbGlkYXRpb25UaW1lcik7XG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRpb25UaW1lciA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ2FsbCBwYXJlbnQgY2xlYW51cFxuICAgICAgICBzdXBlci5vbkNsb3NlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGN1cnJlbnQgVVJMIHZhbHVlXG4gICAgICovXG4gICAgZ2V0VXJsKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLnVybDtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlc2V0UHJvZ3Jlc3NTdGVwcygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jdXJyZW50U3RlcEluZGV4ID0gMDtcbiAgICAgICAgaWYgKHRoaXMucHJvZ3Jlc3NTdGVwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucHJvZ3Jlc3NTdGVwcy5mb3JFYWNoKChzdGVwKSA9PiB7XG4gICAgICAgICAgICBzdGVwLmVsZW1lbnQudGV4dENvbnRlbnQgPSBgXHUyNUNCICR7c3RlcC5sYWJlbH1gO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldFN0ZXBTdGF0ZShpbmRleDogbnVtYmVyLCBzdGF0ZTogU3RlcFN0YXRlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMucHJvZ3Jlc3NTdGVwc1tpbmRleF07XG4gICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwcmVmaXggPSB0aGlzLmdldFN0ZXBQcmVmaXgoc3RhdGUpO1xuICAgICAgICB0YXJnZXQuZWxlbWVudC50ZXh0Q29udGVudCA9IGAke3ByZWZpeH0gJHt0YXJnZXQubGFiZWx9YDtcblxuICAgICAgICBpZiAoc3RhdGUgPT09ICdhY3RpdmUnKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTdGVwSW5kZXggPSBpbmRleDtcbiAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gJ2NvbXBsZXRlJyAmJiB0aGlzLmN1cnJlbnRTdGVwSW5kZXggPT09IGluZGV4KSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTdGVwSW5kZXggPSBNYXRoLm1pbihpbmRleCArIDEsIHRoaXMucHJvZ3Jlc3NTdGVwcy5sZW5ndGggLSAxKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgZmxhZ0FjdGl2ZVN0ZXBBc0Vycm9yKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5wcm9ncmVzc1N0ZXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXRTdGVwU3RhdGUodGhpcy5jdXJyZW50U3RlcEluZGV4LCAnZXJyb3InKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldFN0ZXBQcmVmaXgoc3RhdGU6IFN0ZXBTdGF0ZSk6IHN0cmluZyB7XG4gICAgICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ2FjdGl2ZSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICdcdTI1Q0YnO1xuICAgICAgICAgICAgY2FzZSAnY29tcGxldGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiAnXHUyNzE0JztcbiAgICAgICAgICAgIGNhc2UgJ2Vycm9yJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1x1MjZBMCc7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAnXHUyNUNCJztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlSW5saW5lQnV0dG9uKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGxhYmVsOiBzdHJpbmcsIG9uQ2xpY2s6ICgpID0+IHZvaWQpOiBIVE1MQnV0dG9uRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IGNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiBsYWJlbCB9KTtcbiAgICAgICAgYnV0dG9uLnN0eWxlLnBhZGRpbmcgPSAnNnB4IDEycHgnO1xuICAgICAgICBidXR0b24uc3R5bGUuZm9udFNpemUgPSAnMC44NXJlbSc7XG4gICAgICAgIGJ1dHRvbi5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNnB4JztcbiAgICAgICAgYnV0dG9uLnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgYnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpJztcbiAgICAgICAgYnV0dG9uLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbm9ybWFsKSc7XG4gICAgICAgIGJ1dHRvbi5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgICAgIGJ1dHRvbi5zdHlsZS50cmFuc2l0aW9uID0gJ2JhY2tncm91bmQtY29sb3IgMC4ycyBlYXNlJztcbiAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiB7XG4gICAgICAgICAgICBidXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3ZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItaG92ZXIpJztcbiAgICAgICAgfSk7XG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuICAgICAgICAgICAgYnV0dG9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpJztcbiAgICAgICAgfSk7XG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xpY2spO1xuICAgICAgICByZXR1cm4gYnV0dG9uO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlUGFzdGVGcm9tQ2xpcGJvYXJkKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5pc1Byb2Nlc3NpbmcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghbmF2aWdhdG9yLmNsaXBib2FyZCB8fCAhbmF2aWdhdG9yLmNsaXBib2FyZC5yZWFkVGV4dCkge1xuICAgICAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZSgnQ2xpcGJvYXJkIGFjY2VzcyBpcyBub3QgYXZhaWxhYmxlIGluIHRoaXMgZW52aXJvbm1lbnQuJywgJ2Vycm9yJyk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdDbGlwYm9hcmQgYWNjZXNzIGlzIG5vdCBhdmFpbGFibGUuJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IG5hdmlnYXRvci5jbGlwYm9hcmQucmVhZFRleHQoKTtcbiAgICAgICAgICAgIGlmICghdGV4dCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VmFsaWRhdGlvbk1lc3NhZ2UoJ0NsaXBib2FyZCBpcyBlbXB0eS4gQ29weSBhIFlvdVR1YmUgVVJMIGZpcnN0LicsICdpbmZvJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCB0cmltbWVkID0gdGV4dC50cmltKCk7XG4gICAgICAgICAgICB0aGlzLnVybCA9IHRyaW1tZWQ7XG4gICAgICAgICAgICBpZiAodGhpcy51cmxJbnB1dCkge1xuICAgICAgICAgICAgICAgIHRoaXMudXJsSW5wdXQudmFsdWUgPSB0cmltbWVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5sYXN0VmFsaWRVcmwgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVByb2Nlc3NCdXR0b25TdGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVRdWlja0FjdGlvbnNTdGF0ZSgpO1xuXG4gICAgICAgICAgICBjb25zdCBpc1ZhbGlkID0gVmFsaWRhdGlvblV0aWxzLmlzVmFsaWRZb3VUdWJlVXJsKHRyaW1tZWQpO1xuICAgICAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZShcbiAgICAgICAgICAgICAgICBpc1ZhbGlkID8gJ1JlYWR5IHRvIHByb2Nlc3MgdGhpcyB2aWRlby4nIDogJ0VudGVyIGEgdmFsaWQgWW91VHViZSB2aWRlbyBVUkwuJyxcbiAgICAgICAgICAgICAgICBpc1ZhbGlkID8gJ3N1Y2Nlc3MnIDogJ2Vycm9yJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMuc2V0VXJsSW5wdXRTdGF0ZShpc1ZhbGlkID8gJ3ZhbGlkJyA6ICdpbnZhbGlkJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9jZXNzQnV0dG9uICYmICF0aGlzLmlzUHJvY2Vzc2luZyAmJiBpc1ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uLmZvY3VzKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNVcmxJbnB1dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgRXJyb3JIYW5kbGVyLmhhbmRsZShlcnJvciBhcyBFcnJvciwgJ1JlYWRpbmcgY2xpcGJvYXJkJywgZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZSgnQ291bGQgbm90IHJlYWQgZnJvbSBjbGlwYm9hcmQuIFBhc3RlIG1hbnVhbGx5IGluc3RlYWQuJywgJ2Vycm9yJyk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdDb3VsZCBub3QgcmVhZCBmcm9tIGNsaXBib2FyZC4nKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlQ2xlYXJVcmwoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmlzUHJvY2Vzc2luZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy51cmwgPSAnJztcbiAgICAgICAgaWYgKHRoaXMudXJsSW5wdXQpIHtcbiAgICAgICAgICAgIHRoaXMudXJsSW5wdXQudmFsdWUgPSAnJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxhc3RWYWxpZFVybCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy51cGRhdGVQcm9jZXNzQnV0dG9uU3RhdGUoKTtcbiAgICAgICAgdGhpcy51cGRhdGVRdWlja0FjdGlvbnNTdGF0ZSgpO1xuICAgICAgICB0aGlzLnNldFZhbGlkYXRpb25NZXNzYWdlKCdQYXN0ZSBhIFlvdVR1YmUgbGluayB0byBiZWdpbiBwcm9jZXNzaW5nLicsICdpbmZvJyk7XG4gICAgICAgIHRoaXMuc2V0VXJsSW5wdXRTdGF0ZSgnaWRsZScpO1xuICAgICAgICB0aGlzLmZvY3VzVXJsSW5wdXQoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZVF1aWNrQWN0aW9uc1N0YXRlKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBoYXNVcmwgPSB0aGlzLnVybC50cmltKCkubGVuZ3RoID4gMDtcbiAgICAgICAgaWYgKHRoaXMuY2xlYXJCdXR0b24pIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJCdXR0b24uZGlzYWJsZWQgPSAhaGFzVXJsIHx8IHRoaXMuaXNQcm9jZXNzaW5nO1xuICAgICAgICAgICAgdGhpcy5jbGVhckJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gdGhpcy5jbGVhckJ1dHRvbi5kaXNhYmxlZCA/ICcwLjUnIDogJzEnO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBhc3RlQnV0dG9uKSB7XG4gICAgICAgICAgICB0aGlzLnBhc3RlQnV0dG9uLmRpc2FibGVkID0gdGhpcy5pc1Byb2Nlc3Npbmc7XG4gICAgICAgICAgICB0aGlzLnBhc3RlQnV0dG9uLnN0eWxlLm9wYWNpdHkgPSB0aGlzLnBhc3RlQnV0dG9uLmRpc2FibGVkID8gJzAuNScgOiAnMSc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHNldFVybElucHV0U3RhdGUoc3RhdGU6ICdpZGxlJyB8ICd2YWxpZCcgfCAnaW52YWxpZCcpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnVybElucHV0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgYm9yZGVyQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgbGV0IGJveFNoYWRvdyA9ICdub25lJztcblxuICAgICAgICBpZiAoc3RhdGUgPT09ICd2YWxpZCcpIHtcbiAgICAgICAgICAgIGJvcmRlckNvbG9yID0gJ3ZhcigtLXRleHQtYWNjZW50KSc7XG4gICAgICAgICAgICBib3hTaGFkb3cgPSAnMCAwIDAgMXB4IHZhcigtLXRleHQtYWNjZW50KSc7XG4gICAgICAgIH0gZWxzZSBpZiAoc3RhdGUgPT09ICdpbnZhbGlkJykge1xuICAgICAgICAgICAgYm9yZGVyQ29sb3IgPSAndmFyKC0tdGV4dC1lcnJvciknO1xuICAgICAgICAgICAgYm94U2hhZG93ID0gJzAgMCAwIDFweCB2YXIoLS10ZXh0LWVycm9yKSc7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnVybElucHV0LnN0eWxlLmJvcmRlckNvbG9yID0gYm9yZGVyQ29sb3I7XG4gICAgICAgIHRoaXMudXJsSW5wdXQuc3R5bGUuYm94U2hhZG93ID0gYm94U2hhZG93O1xuICAgIH1cblxuICAgIHByaXZhdGUgc2V0VmFsaWRhdGlvbk1lc3NhZ2UobWVzc2FnZTogc3RyaW5nLCB0eXBlOiAnaW5mbycgfCAnZXJyb3InIHwgJ3N1Y2Nlc3MnKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy52YWxpZGF0aW9uTWVzc2FnZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy52YWxpZGF0aW9uTWVzc2FnZS50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG5cbiAgICAgICAgbGV0IGNvbG9yID0gJ3ZhcigtLXRleHQtbXV0ZWQpJztcbiAgICAgICAgaWYgKHR5cGUgPT09ICdlcnJvcicpIHtcbiAgICAgICAgICAgIGNvbG9yID0gJ3ZhcigtLXRleHQtZXJyb3IpJztcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnc3VjY2VzcycpIHtcbiAgICAgICAgICAgIGNvbG9yID0gJ3ZhcigtLXRleHQtYWNjZW50KSc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb2xvciA9ICd2YXIoLS10ZXh0LW11dGVkKSc7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnZhbGlkYXRpb25NZXNzYWdlLnN0eWxlLmNvbG9yID0gY29sb3I7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJ5IHRvIGZldGNoIGEgbGlnaHR3ZWlnaHQgcHJldmlldyBmb3IgdGhlIHByb3ZpZGVkIFlvdVR1YmUgVVJMIHVzaW5nIG9FbWJlZC5cbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIG1heWJlRmV0Y2hQcmV2aWV3KHVybDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICh0aGlzLmZldGNoSW5Qcm9ncmVzcykgcmV0dXJuO1xuICAgICAgICBpZiAoIXVybCkgcmV0dXJuO1xuICAgICAgICBpZiAodGhpcy5sYXN0VmFsaWRVcmwgPT09IHVybCAmJiB0aGlzLnRodW1ibmFpbEVsICYmIHRoaXMudGh1bWJuYWlsRWwuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJykge1xuICAgICAgICAgICAgcmV0dXJuOyAvLyBhbHJlYWR5IGZldGNoZWQgZm9yIHRoaXMgVVJMXG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNldEZldGNoaW5nU3RhdGUodHJ1ZSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBtZXRhID0gYXdhaXQgdGhpcy5mZXRjaFZpZGVvUHJldmlldyh1cmwpO1xuICAgICAgICAgICAgaWYgKG1ldGEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dQcmV2aWV3KG1ldGEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyUHJldmlldygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLy8gc2lsZW50bHkgY2xlYXIgcHJldmlldyBvbiBmYWlsdXJlLCBrZWVwIFVYIHJlc3BvbnNpdmVcbiAgICAgICAgICAgIHRoaXMuY2xlYXJQcmV2aWV3KCk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLnNldEZldGNoaW5nU3RhdGUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRGZXRjaGluZ1N0YXRlKGlzRmV0Y2hpbmc6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5mZXRjaEluUHJvZ3Jlc3MgPSBpc0ZldGNoaW5nO1xuICAgICAgICBpZiAodGhpcy5wcm9jZXNzQnV0dG9uKSB7XG4gICAgICAgICAgICAvLyBkaXNhYmxlIHByb2Nlc3Npbmcgd2hpbGUgZmV0Y2hpbmcgcHJldmlld1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzQnV0dG9uLmRpc2FibGVkID0gaXNGZXRjaGluZyB8fCAhKHRoaXMubGFzdFZhbGlkUmVzdWx0ID8/IGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0J1dHRvbi5zdHlsZS5vcGFjaXR5ID0gdGhpcy5wcm9jZXNzQnV0dG9uLmRpc2FibGVkID8gJzAuNScgOiAnMSc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmFsaWRhdGlvbk1lc3NhZ2UpIHtcbiAgICAgICAgICAgIGlmIChpc0ZldGNoaW5nKSB0aGlzLnNldFZhbGlkYXRpb25NZXNzYWdlKCdGZXRjaGluZyBwcmV2aWV3Li4uJywgJ2luZm8nKTtcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMubGFzdFZhbGlkUmVzdWx0KSB0aGlzLnNldFZhbGlkYXRpb25NZXNzYWdlKCdSZWFkeSB0byBwcm9jZXNzIHRoaXMgdmlkZW8uJywgJ3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgIGVsc2UgdGhpcy5zZXRWYWxpZGF0aW9uTWVzc2FnZSgnRW50ZXIgYSB2YWxpZCBZb3VUdWJlIHZpZGVvIFVSTC4nLCAnZXJyb3InKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZmV0Y2hWaWRlb1ByZXZpZXcodXJsOiBzdHJpbmcpOiBQcm9taXNlPHsgdGl0bGU6IHN0cmluZzsgYXV0aG9yOiBzdHJpbmc7IHRodW1ibmFpbDogc3RyaW5nIH0gfCBudWxsPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBvZW1iZWQgPSBgaHR0cHM6Ly93d3cueW91dHViZS5jb20vb2VtYmVkP3VybD0ke2VuY29kZVVSSUNvbXBvbmVudCh1cmwpfSZmb3JtYXQ9anNvbmA7XG4gICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChvZW1iZWQpO1xuICAgICAgICAgICAgaWYgKCFyZXMub2spIHJldHVybiBudWxsO1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlIHx8ICcnLFxuICAgICAgICAgICAgICAgIGF1dGhvcjogZGF0YS5hdXRob3JfbmFtZSB8fCAnJyxcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6IGRhdGEudGh1bWJuYWlsX3VybCB8fCAnJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG93UHJldmlldyhtZXRhOiB7IHRpdGxlOiBzdHJpbmc7IGF1dGhvcjogc3RyaW5nOyB0aHVtYm5haWw6IHN0cmluZyB9KTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy50aHVtYm5haWxFbCB8fCAhdGhpcy5tZXRhZGF0YUNvbnRhaW5lcikgcmV0dXJuO1xuICAgICAgICBpZiAobWV0YS50aHVtYm5haWwpIHtcbiAgICAgICAgICAgIHRoaXMudGh1bWJuYWlsRWwuc3JjID0gbWV0YS50aHVtYm5haWw7XG4gICAgICAgICAgICB0aGlzLnRodW1ibmFpbEVsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50aHVtYm5haWxFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcG9wdWxhdGUgbWV0YWRhdGEgZmllbGRzIChzdHJ1Y3R1cmUgY3JlYXRlZCBlYXJsaWVyKVxuICAgICAgICBjb25zdCB0aXRsZUVsID0gdGhpcy5tZXRhZGF0YUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcueXQtcHJldmlldy10aXRsZScpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICBjb25zdCBjaGFubmVsRWwgPSB0aGlzLm1ldGFkYXRhQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy55dC1wcmV2aWV3LWNoYW5uZWwnKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgaWYgKHRpdGxlRWwpIHtcbiAgICAgICAgICAgIHRpdGxlRWwudGV4dENvbnRlbnQgPSBtZXRhLnRpdGxlO1xuICAgICAgICAgICAgdGl0bGVFbC5zdHlsZS5mb250V2VpZ2h0ID0gJzYwMCc7XG4gICAgICAgICAgICB0aXRsZUVsLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICc0cHgnO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGFubmVsRWwpIHtcbiAgICAgICAgICAgIGNoYW5uZWxFbC50ZXh0Q29udGVudCA9IG1ldGEuYXV0aG9yO1xuICAgICAgICAgICAgY2hhbm5lbEVsLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbXV0ZWQpJztcbiAgICAgICAgICAgIGNoYW5uZWxFbC5zdHlsZS5mb250U2l6ZSA9ICcwLjg1cmVtJztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubWV0YWRhdGFDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjbGVhclByZXZpZXcoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnRodW1ibmFpbEVsKSB7XG4gICAgICAgICAgICB0aGlzLnRodW1ibmFpbEVsLnNyYyA9ICcnO1xuICAgICAgICAgICAgdGhpcy50aHVtYm5haWxFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1ldGFkYXRhQ29udGFpbmVyKSB7XG4gICAgICAgICAgICBjb25zdCB0aXRsZUVsID0gdGhpcy5tZXRhZGF0YUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcueXQtcHJldmlldy10aXRsZScpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICAgICAgY29uc3QgY2hhbm5lbEVsID0gdGhpcy5tZXRhZGF0YUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcueXQtcHJldmlldy1jaGFubmVsJykgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgICAgICBpZiAodGl0bGVFbCkgdGl0bGVFbC50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgICAgICAgaWYgKGNoYW5uZWxFbCkgY2hhbm5lbEVsLnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgICAgICB0aGlzLm1ldGFkYXRhQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiLyoqXG4gKiBQbHVnaW4gc2V0dGluZ3MgdGFiIGNvbXBvbmVudFxuICogRGVzaWduZWQgdG8gcHJldmVudCBjb25mbGljdHMgd2l0aCBvdGhlciBwbHVnaW4gc2V0dGluZ3NcbiAqL1xuXG5pbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBZb3VUdWJlUGx1Z2luU2V0dGluZ3MsIE91dHB1dEZvcm1hdCwgUGVyZm9ybWFuY2VNb2RlIH0gZnJvbSAnLi4vLi4vaW50ZXJmYWNlcy90eXBlcyc7XG5pbXBvcnQgeyBNRVNTQUdFUyB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9tZXNzYWdlcyc7XG5pbXBvcnQgeyBWYWxpZGF0aW9uVXRpbHMgfSBmcm9tICcuLi8uLi91dGlscy92YWxpZGF0aW9uJztcbmltcG9ydCB7IEVycm9ySGFuZGxlciB9IGZyb20gJy4uLy4uL3V0aWxzL2Vycm9yLWhhbmRsZXInO1xuaW1wb3J0IHsgU2VjdXJlQ29uZmlnU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3NlY3VyZS1jb25maWcnO1xuaW1wb3J0IHsgUEVSRk9STUFOQ0VfUFJFU0VUUywgUGVyZm9ybWFuY2VPcHRpbWl6ZXIgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvcGVyZm9ybWFuY2UnO1xuXG4vLyBVbmlxdWUgQ1NTIGNsYXNzZXMgdG8gcHJldmVudCBjb25mbGljdHNcbmNvbnN0IFNFVFRJTkdTX0NTU19DTEFTU0VTID0ge1xuICAgIGNvbnRhaW5lcjogJ3l0Yy1zZXR0aW5ncy1jb250YWluZXInLFxuICAgIHNlY3Rpb246ICd5dGMtc2V0dGluZ3Mtc2VjdGlvbicsXG4gICAgaGVhZGVyOiAneXRjLXNldHRpbmdzLWhlYWRlcicsXG4gICAgdmFsaWRhdGlvbjogJ3l0Yy1zZXR0aW5ncy12YWxpZGF0aW9uJ1xufSBhcyBjb25zdDtcblxuZXhwb3J0IGludGVyZmFjZSBTZXR0aW5nc1RhYk9wdGlvbnMge1xuICAgIHBsdWdpbjogYW55OyAvLyBQbHVnaW4gaW5zdGFuY2VcbiAgICBvblNldHRpbmdzQ2hhbmdlOiAoc2V0dGluZ3M6IFlvdVR1YmVQbHVnaW5TZXR0aW5ncykgPT4gUHJvbWlzZTx2b2lkPjtcbn1cblxuZXhwb3J0IGNsYXNzIFlvdVR1YmVTZXR0aW5nc1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHByaXZhdGUgc2V0dGluZ3M6IFlvdVR1YmVQbHVnaW5TZXR0aW5ncztcbiAgICBwcml2YXRlIHZhbGlkYXRpb25FcnJvcnM6IHN0cmluZ1tdID0gW107XG4gICAgcHJpdmF0ZSBzZWN1cmVDb25maWc6IFNlY3VyZUNvbmZpZ1NlcnZpY2U7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgb3B0aW9uczogU2V0dGluZ3NUYWJPcHRpb25zXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgb3B0aW9ucy5wbHVnaW4pO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0geyAuLi5vcHRpb25zLnBsdWdpbi5zZXR0aW5ncyB9O1xuICAgICAgICB0aGlzLnNlY3VyZUNvbmZpZyA9IG5ldyBTZWN1cmVDb25maWdTZXJ2aWNlKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdW5pcXVlIENTUyBjbGFzcyBmb3IgY29uZmxpY3QgcHJldmVudGlvblxuICAgICAgICBjb250YWluZXJFbC5hZGRDbGFzcyhTRVRUSU5HU19DU1NfQ0xBU1NFUy5jb250YWluZXIpO1xuICAgICAgICBjb250YWluZXJFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcGx1Z2luJywgJ3lvdXR1YmUtY2xpcHBlcicpO1xuXG4gICAgICAgIHRoaXMuY3JlYXRlSGVhZGVyKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlQVBJU2V0dGluZ3MoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVQZXJmb3JtYW5jZVNldHRpbmdzKCk7XG4gICAgICAgIHRoaXMuY3JlYXRlU2VjdXJpdHlTZXR0aW5ncygpO1xuICAgICAgICB0aGlzLmNyZWF0ZUZpbGVTZXR0aW5ncygpO1xuICAgICAgICB0aGlzLmNyZWF0ZVZhbGlkYXRpb25TdGF0dXMoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVVc2FnZUluc3RydWN0aW9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBoZWFkZXIgd2l0aCB2ZXJzaW9uIGluZm9ybWF0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVIZWFkZXIoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGhlYWRlckVsID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoU0VUVElOR1NfQ1NTX0NMQVNTRVMuaGVhZGVyKTtcbiAgICAgICAgaGVhZGVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnWW91VHViZUNsaXBwZXIgU2V0dGluZ3MnIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gVmVyc2lvbiBpbmZvXG4gICAgICAgIGNvbnN0IHZlcnNpb25FbCA9IGhlYWRlckVsLmNyZWF0ZURpdigneXRjLXZlcnNpb24taW5mbycpO1xuICAgICAgICB2ZXJzaW9uRWwuY3JlYXRlRWwoJ3NwYW4nLCB7IFxuICAgICAgICAgICAgdGV4dDogJ3YxLjIuMCAtIFByb2R1Y3Rpb24gUmVhZHknLFxuICAgICAgICAgICAgY2xzOiAneXRjLXZlcnNpb24tYmFkZ2UnXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gUXVpY2sgc3RhdHVzIGNoZWNrXG4gICAgICAgIGNvbnN0IHN0YXR1c0VsID0gaGVhZGVyRWwuY3JlYXRlRGl2KCd5dGMtc3RhdHVzLWluZm8nKTtcbiAgICAgICAgY29uc3QgaGFzVmFsaWRDb25maWcgPSB0aGlzLnZhbGlkYXRlQ29uZmlndXJhdGlvbigpO1xuICAgICAgICBzdGF0dXNFbC5jcmVhdGVFbCgnc3BhbicsIHtcbiAgICAgICAgICAgIHRleHQ6IGhhc1ZhbGlkQ29uZmlnID8gJ1x1MjcwNSBSZWFkeSB0byB1c2UnIDogJ1x1MjZBMFx1RkUwRiBDb25maWd1cmF0aW9uIG5lZWRlZCcsXG4gICAgICAgICAgICBjbHM6IGhhc1ZhbGlkQ29uZmlnID8gJ3l0Yy1zdGF0dXMtZ29vZCcgOiAneXRjLXN0YXR1cy13YXJuaW5nJ1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIERvY3VtZW50YXRpb24gbGlua1xuICAgICAgICBjb25zdCBkb2NzRWwgPSBoZWFkZXJFbC5jcmVhdGVEaXYoJ3l0Yy1kb2NzLWxpbmsnKTtcbiAgICAgICAgZG9jc0VsLmNyZWF0ZUVsKCdhJywge1xuICAgICAgICAgICAgdGV4dDogJ1x1RDgzRFx1RENENiBWaWV3IERvY3VtZW50YXRpb24nLFxuICAgICAgICAgICAgaHJlZjogJyMnLFxuICAgICAgICAgICAgY2xzOiAneXRjLWRvY3MtYnV0dG9uJ1xuICAgICAgICB9KS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLnNob3dEb2N1bWVudGF0aW9uKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIGVudGlyZSBjb25maWd1cmF0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUNvbmZpZ3VyYXRpb24oKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGhhc0FwaUtleSA9IHRoaXMuc2V0dGluZ3MuZ2VtaW5pQXBpS2V5Py50cmltKCkgfHwgdGhpcy5zZXR0aW5ncy5ncm9xQXBpS2V5Py50cmltKCk7XG4gICAgICAgIGNvbnN0IGhhc1ZhbGlkUGF0aCA9IFZhbGlkYXRpb25VdGlscy5pc1ZhbGlkUGF0aCh0aGlzLnNldHRpbmdzLm91dHB1dFBhdGgpO1xuICAgICAgICByZXR1cm4gQm9vbGVhbihoYXNBcGlLZXkgJiYgaGFzVmFsaWRQYXRoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaG93IGlubGluZSBkb2N1bWVudGF0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBzaG93RG9jdW1lbnRhdGlvbigpOiB2b2lkIHtcbiAgICAgICAgd2luZG93Lm9wZW4oJ2h0dHBzOi8vZ2l0aHViLmNvbS95b3V0dWJlLWNsaXBwZXIvb2JzaWRpYW4tcGx1Z2luI3JlYWRtZScsICdfYmxhbmsnKTtcbiAgICB9ICAgIC8qKlxuICAgICAqIENyZWF0ZSBBUEkgY29uZmlndXJhdGlvbiBzZXR0aW5nc1xuICAgICAqL1xuICAgIHByaXZhdGUgY3JlYXRlQVBJU2V0dGluZ3MoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIFxuICAgICAgICAvLyBBUEkgS2V5cyBzZWN0aW9uXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ0FQSSBDb25maWd1cmF0aW9uJyB9KTtcblxuICAgICAgICAvLyBTZWN1cml0eSBOb3RpY2VcbiAgICAgICAgY29uc3Qgc2VjdXJpdHlOb3RpY2UgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoJ3l0Yy1zZWN1cml0eS1ub3RpY2UnKTtcbiAgICAgICAgc2VjdXJpdHlOb3RpY2Uuc3R5bGUucGFkZGluZyA9ICcxMnB4JztcbiAgICAgICAgc2VjdXJpdHlOb3RpY2Uuc3R5bGUubWFyZ2luQm90dG9tID0gJzE2cHgnO1xuICAgICAgICBzZWN1cml0eU5vdGljZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ob3ZlciknO1xuICAgICAgICBzZWN1cml0eU5vdGljZS5zdHlsZS5ib3JkZXJMZWZ0ID0gJzRweCBzb2xpZCB2YXIoLS10ZXh0LWFjY2VudCknO1xuICAgICAgICBzZWN1cml0eU5vdGljZS5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNHB4JztcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG5vdGljZVRpdGxlID0gc2VjdXJpdHlOb3RpY2UuY3JlYXRlRWwoJ3N0cm9uZycpO1xuICAgICAgICBub3RpY2VUaXRsZS50ZXh0Q29udGVudCA9ICdcdUQ4M0RcdUREMTIgU2VjdXJpdHkgTm90aWNlOiAnO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgbm90aWNlVGV4dCA9IHNlY3VyaXR5Tm90aWNlLmNyZWF0ZUVsKCdzcGFuJyk7XG4gICAgICAgIG5vdGljZVRleHQudGV4dENvbnRlbnQgPSAnQVBJIGtleXMgYXJlIGVuY3J5cHRlZCBhbmQgc3RvcmVkIHNlY3VyZWx5IGJ5IE9ic2lkaWFuLiBOZXZlciBzaGFyZSB5b3VyIGtleXMgb3IgY29tbWl0IHRoZW0gdG8gdmVyc2lvbiBjb250cm9sLic7XG4gICAgICAgIG5vdGljZVRleHQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIG5vdGljZVRleHQuc3R5bGUubWFyZ2luVG9wID0gJzRweCc7XG4gICAgICAgIG5vdGljZVRleHQuc3R5bGUuZm9udFNpemUgPSAnMC45ZW0nO1xuICAgICAgICBub3RpY2VUZXh0LnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbXV0ZWQpJztcblxuICAgICAgICAvLyBHZW1pbmkgQVBJIEtleSAocGFzc3dvcmQgZmllbGQpXG4gICAgICAgIGNvbnN0IGdlbWluaVNldHRpbmcgPSBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdHZW1pbmkgQVBJIEtleScpXG4gICAgICAgICAgICAuc2V0RGVzYygnWW91ciBHb29nbGUgR2VtaW5pIEFQSSBrZXkgZm9yIGNvbnRlbnQgcHJvY2Vzc2luZyAocGFzc3dvcmQgZmllbGQgLSBzZWN1cmVkKScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHtcbiAgICAgICAgICAgICAgICAvLyBVc2UgcGFzc3dvcmQtbGlrZSBpbnB1dFxuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0RWwgPSB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignc2stLi4uICh5b3VyIGtleSBpcyBlbmNyeXB0ZWQpJylcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3MuZ2VtaW5pQXBpS2V5IHx8ICcnKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZVNldHRpbmcoJ2dlbWluaUFwaUtleScsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmlucHV0RWw7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTWFrZSBpdCBwYXNzd29yZCBmaWVsZFxuICAgICAgICAgICAgICAgIGlucHV0RWwudHlwZSA9ICdwYXNzd29yZCc7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gQWRkIHRvZ2dsZSB0byBzaG93L2hpZGVcbiAgICAgICAgICAgICAgICBpbnB1dEVsLnN0eWxlLmZvbnRGYW1pbHkgPSAnbW9ub3NwYWNlJztcbiAgICAgICAgICAgICAgICBpbnB1dEVsLnN0eWxlLmxldHRlclNwYWNpbmcgPSAnMC4xZW0nO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgc2hvdy9oaWRlIHRvZ2dsZSBmb3IgR2VtaW5pIGtleVxuICAgICAgICB0aGlzLmFkZEtleVRvZ2dsZShnZW1pbmlTZXR0aW5nLCB0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgY2xlYXIgYnV0dG9uIGZvciBHZW1pbmkga2V5XG4gICAgICAgIHRoaXMuYWRkS2V5Q2xlYXJCdXR0b24oZ2VtaW5pU2V0dGluZywgJ2dlbWluaUFwaUtleScpO1xuXG4gICAgICAgIC8vIEdyb3EgQVBJIEtleSAocGFzc3dvcmQgZmllbGQpXG4gICAgICAgIGNvbnN0IGdyb3FTZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnR3JvcSBBUEkgS2V5JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdZb3VyIEdyb3EgQVBJIGtleSBmb3IgZmFsbGJhY2sgcHJvY2Vzc2luZyAocGFzc3dvcmQgZmllbGQgLSBzZWN1cmVkKScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHtcbiAgICAgICAgICAgICAgICAvLyBVc2UgcGFzc3dvcmQtbGlrZSBpbnB1dFxuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0RWwgPSB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignZ3NrXy4uLiAoeW91ciBrZXkgaXMgZW5jcnlwdGVkKScpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNldHRpbmdzLmdyb3FBcGlLZXkgfHwgJycpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlU2V0dGluZygnZ3JvcUFwaUtleScsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmlucHV0RWw7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTWFrZSBpdCBwYXNzd29yZCBmaWVsZFxuICAgICAgICAgICAgICAgIGlucHV0RWwudHlwZSA9ICdwYXNzd29yZCc7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gQWRkIHZpc3VhbCBmZWVkYmFja1xuICAgICAgICAgICAgICAgIGlucHV0RWwuc3R5bGUuZm9udEZhbWlseSA9ICdtb25vc3BhY2UnO1xuICAgICAgICAgICAgICAgIGlucHV0RWwuc3R5bGUubGV0dGVyU3BhY2luZyA9ICcwLjFlbSc7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRleHQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBzaG93L2hpZGUgdG9nZ2xlIGZvciBHcm9xIGtleVxuICAgICAgICB0aGlzLmFkZEtleVRvZ2dsZShncm9xU2V0dGluZywgdGhpcy5zZXR0aW5ncy5ncm9xQXBpS2V5KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBjbGVhciBidXR0b24gZm9yIEdyb3Ega2V5XG4gICAgICAgIHRoaXMuYWRkS2V5Q2xlYXJCdXR0b24oZ3JvcVNldHRpbmcsICdncm9xQXBpS2V5Jyk7XG5cbiAgICAgICAgLy8gVGVzdCBDb25uZWN0aXZpdHlcbiAgICAgICAgY29uc3QgdGVzdFNlY3Rpb24gPSBjb250YWluZXJFbC5jcmVhdGVEaXYoJ3l0Yy10ZXN0LWNvbm5lY3Rpb24nKTtcbiAgICAgICAgdGVzdFNlY3Rpb24uc3R5bGUubWFyZ2luVG9wID0gJzE2cHgnO1xuICAgICAgICB0ZXN0U2VjdGlvbi5zdHlsZS5wYWRkaW5nVG9wID0gJzEycHgnO1xuICAgICAgICB0ZXN0U2VjdGlvbi5zdHlsZS5ib3JkZXJUb3AgPSAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyh0ZXN0U2VjdGlvbilcbiAgICAgICAgICAgIC5zZXROYW1lKCdUZXN0IEFQSSBDb25uZWN0aW9uJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdWZXJpZnkgeW91ciBBUEkga2V5cyBhcmUgdmFsaWQnKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1Rlc3QgS2V5cycpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBidG4uc2V0RGlzYWJsZWQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGJ0bi5zZXRCdXR0b25UZXh0KCdUZXN0aW5nLi4uJyk7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnRlc3RBUElLZXlzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBidG4uc2V0QnV0dG9uVGV4dCgnXHUyNzEzIFN1Y2Nlc3MhJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidG4uc2V0QnV0dG9uVGV4dCgnVGVzdCBLZXlzJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnRuLnNldERpc2FibGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDIwMDApO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnRuLnNldEJ1dHRvblRleHQoJ1x1MjcxNyBGYWlsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIEVycm9ySGFuZGxlci5oYW5kbGUoZXJyb3IgYXMgRXJyb3IsICdBUEkga2V5IHRlc3QgZmFpbGVkJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidG4uc2V0QnV0dG9uVGV4dCgnVGVzdCBLZXlzJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnRuLnNldERpc2FibGVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDIwMDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBzaG93L2hpZGUgdG9nZ2xlIGZvciBzZW5zaXRpdmUgQVBJIGtleXNcbiAgICAgKi9cbiAgICBwcml2YXRlIGFkZEtleVRvZ2dsZShzZXR0aW5nOiBTZXR0aW5nLCBrZXlWYWx1ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIC8vIEFsd2F5cyBhZGQgdG9nZ2xlIGJ1dHRvbiwgZXZlbiBpZiBrZXkgaXMgZW1wdHkgKHVzZXIgbWlnaHQgYmUgZW50ZXJpbmcgaXQgbm93KVxuICAgICAgICBjb25zdCB0b2dnbGVCdG4gPSBzZXR0aW5nLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnXHVEODNEXHVEQzQxXHVGRTBGIFNob3cnKVxuICAgICAgICAgICAgLnNldFRvb2x0aXAoJ1RvZ2dsZSBrZXkgdmlzaWJpbGl0eScpXG4gICAgICAgICAgICAub25DbGljaygoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0cyA9IHNldHRpbmcuc2V0dGluZ0VsLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W3R5cGU9XCJwYXNzd29yZFwiXSwgaW5wdXRbdHlwZT1cInRleHRcIl0nKTtcbiAgICAgICAgICAgICAgICBpZiAoaW5wdXRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBpbnB1dHNbMF0gYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgICAgICAgICBjb25zdCBpc1Bhc3N3b3JkID0gaW5wdXQudHlwZSA9PT0gJ3Bhc3N3b3JkJztcblxuICAgICAgICAgICAgICAgIGlucHV0LnR5cGUgPSBpc1Bhc3N3b3JkID8gJ3RleHQnIDogJ3Bhc3N3b3JkJztcbiAgICAgICAgICAgICAgICBidG4uc2V0QnV0dG9uVGV4dChpc1Bhc3N3b3JkID8gJ1x1RDgzRFx1REM0MVx1RkUwRlx1MjAwRFx1RDgzRFx1RERFOFx1RkUwRiBIaWRlJyA6ICdcdUQ4M0RcdURDNDFcdUZFMEYgU2hvdycpO1xuICAgICAgICAgICAgfSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBjbGVhciBidXR0b24gdG8gcmVtb3ZlIEFQSSBrZXlcbiAgICAgKi9cbiAgICBwcml2YXRlIGFkZEtleUNsZWFyQnV0dG9uKHNldHRpbmc6IFNldHRpbmcsIHNldHRpbmdLZXk6ICdnZW1pbmlBcGlLZXknIHwgJ2dyb3FBcGlLZXknKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNsZWFyQnRuID0gc2V0dGluZy5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1x1RDgzRFx1REREMVx1RkUwRiBDbGVhcicpXG4gICAgICAgICAgICAuc2V0VG9vbHRpcCgnUmVtb3ZlIHRoaXMgQVBJIGtleScpXG4gICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gQ29uZmlybSBiZWZvcmUgY2xlYXJpbmdcbiAgICAgICAgICAgICAgICBjb25zdCBrZXlOYW1lID0gc2V0dGluZ0tleSA9PT0gJ2dlbWluaUFwaUtleScgPyAnR2VtaW5pJyA6ICdHcm9xJztcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlybShgQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNsZWFyIHRoZSAke2tleU5hbWV9IEFQSSBrZXk/YCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVTZXR0aW5nKHNldHRpbmdLZXksICcnKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVmcmVzaCB0aGUgZGlzcGxheSB0byBzaG93IGVtcHR5IGZpZWxkXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUZXN0IEFQSSBrZXlzIGZvciB2YWxpZGl0eVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgdGVzdEFQSUtleXMoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5nZW1pbmlBcGlLZXkpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgICAgICAgICAgICAgJ2h0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxYmV0YS9tb2RlbHM/a2V5PScgKyB0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgICAgICBlcnJvcnMucHVzaChgR2VtaW5pIEFQSSBrZXkgaW52YWxpZCAoJHtyZXNwb25zZS5zdGF0dXN9KWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goJ0dlbWluaSBBUEkga2V5IHRlc3QgZmFpbGVkIChuZXR3b3JrIGVycm9yKScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goJ0dlbWluaSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcnMuam9pbignXFxuJykpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHBlcmZvcm1hbmNlIGFuZCBzcGVlZCBzZXR0aW5nc1xuICAgICAqL1xuICAgIHByaXZhdGUgY3JlYXRlUGVyZm9ybWFuY2VTZXR0aW5ncygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdQZXJmb3JtYW5jZSAmIFNwZWVkJyB9KTtcblxuICAgICAgICBjb25zdCBjdXJyZW50TW9kZSA9IHRoaXMuc2V0dGluZ3MucGVyZm9ybWFuY2VNb2RlIHx8ICdiYWxhbmNlZCc7XG4gICAgICAgIGNvbnN0IHByZXNldCA9IFBFUkZPUk1BTkNFX1BSRVNFVFNbY3VycmVudE1vZGVdO1xuXG4gICAgICAgIC8vIFBlcmZvcm1hbmNlIE1vZGUgU2VsZWN0aW9uXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1BlcmZvcm1hbmNlIE1vZGUnKVxuICAgICAgICAgICAgLnNldERlc2MoYEN1cnJlbnQ6ICR7cHJlc2V0Lm5hbWV9IC0gJHtwcmVzZXQuZGVzY3JpcHRpb259YClcbiAgICAgICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2Zhc3QnLCAnXHUyNkExIEZhc3QgLSBNYXhpbXVtIHNwZWVkJylcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdiYWxhbmNlZCcsICdcdTI2OTZcdUZFMEYgQmFsYW5jZWQgLSBTcGVlZCAmIFF1YWxpdHknKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ3F1YWxpdHknLCAnXHVEODNDXHVERkFGIFF1YWxpdHkgLSBNYXhpbXVtIGFuYWx5c2lzJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoY3VycmVudE1vZGUpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogUGVyZm9ybWFuY2VNb2RlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlU2V0dGluZygncGVyZm9ybWFuY2VNb2RlJywgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTsgLy8gUmVmcmVzaCB0byBzaG93IHVwZGF0ZWQgZGVzY3JpcHRpb25cbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gRW5hYmxlIFBhcmFsbGVsIFByb2Nlc3NpbmdcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnUGFyYWxsZWwgUHJvY2Vzc2luZycpXG4gICAgICAgICAgICAuc2V0RGVzYygnUmFjZSBtdWx0aXBsZSBBSSBwcm92aWRlcnMgc2ltdWx0YW5lb3VzbHkgZm9yIGZhc3RlciByZXNwb25zZXMnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3MuZW5hYmxlUGFyYWxsZWxQcm9jZXNzaW5nKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVTZXR0aW5nKCdlbmFibGVQYXJhbGxlbFByb2Nlc3NpbmcnLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vIFByZWZlciBNdWx0aW1vZGFsIEFuYWx5c2lzXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ011bHRpbW9kYWwgQW5hbHlzaXMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1VzZSB2aWRlby1hd2FyZSBtb2RlbHMgdGhhdCBjYW4gYW5hbHl6ZSBib3RoIGF1ZGlvIGFuZCB2aXN1YWwgY29udGVudCcpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5ncy5wcmVmZXJNdWx0aW1vZGFsKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVTZXR0aW5nKCdwcmVmZXJNdWx0aW1vZGFsJywgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAvLyBDdXJyZW50IFBlcmZvcm1hbmNlIFN0YXR1c1xuICAgICAgICBjb25zdCBzdGF0dXNFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdigpO1xuICAgICAgICBzdGF0dXNFbC5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdDdXJyZW50IENvbmZpZ3VyYXRpb24nIH0pO1xuXG4gICAgICAgIGNvbnN0IHN0YXR1c0xpc3RFbCA9IHN0YXR1c0VsLmNyZWF0ZUVsKCd1bCcpO1xuICAgICAgICBjb25zdCBzdGF0dXNJdGVtcyA9IFtcbiAgICAgICAgICAgIGBNb2RlOiAke3ByZXNldC5uYW1lfWAsXG4gICAgICAgICAgICBgUGFyYWxsZWwgUHJvY2Vzc2luZzogJHt0aGlzLnNldHRpbmdzLmVuYWJsZVBhcmFsbGVsUHJvY2Vzc2luZyA/ICdFbmFibGVkJyA6ICdEaXNhYmxlZCd9YCxcbiAgICAgICAgICAgIGBNdWx0aW1vZGFsOiAke3RoaXMuc2V0dGluZ3MucHJlZmVyTXVsdGltb2RhbCA/ICdQcmVmZXJyZWQnIDogJ1N0YW5kYXJkJ31gLFxuICAgICAgICAgICAgYEdlbWluaSBUaW1lb3V0OiAke3RoaXMuc2V0dGluZ3MuY3VzdG9tVGltZW91dHM/LmdlbWluaVRpbWVvdXQgfHwgcHJlc2V0LnRpbWVvdXRzLmdlbWluaVRpbWVvdXR9bXNgLFxuICAgICAgICAgICAgYEdyb3EgVGltZW91dDogJHt0aGlzLnNldHRpbmdzLmN1c3RvbVRpbWVvdXRzPy5ncm9xVGltZW91dCB8fCBwcmVzZXQudGltZW91dHMuZ3JvcVRpbWVvdXR9bXNgXG4gICAgICAgIF07XG5cbiAgICAgICAgc3RhdHVzSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxpID0gc3RhdHVzTGlzdEVsLmNyZWF0ZUVsKCdsaScpO1xuICAgICAgICAgICAgbGkudGV4dENvbnRlbnQgPSBpdGVtO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBQZXJmb3JtYW5jZSBSZWNvbW1lbmRhdGlvbnNcbiAgICAgICAgY29uc3QgcmVjb21tZW5kYXRpb25zID0gUGVyZm9ybWFuY2VPcHRpbWl6ZXIuZ2V0UGVyZm9ybWFuY2VSZWNvbW1lbmRhdGlvbnMoXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLnBlcmZvcm1hbmNlTW9kZSxcbiAgICAgICAgICAgIHVuZGVmaW5lZCwgLy8gdmlkZW8gZHVyYXRpb24gbm90IGF2YWlsYWJsZSBpbiBzZXR0aW5nc1xuICAgICAgICAgICAgJ2RldGFpbGVkLWd1aWRlJyAvLyBkZWZhdWx0IGZvcm1hdFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHJlY0VsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIHJlY0VsLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ1JlY29tbWVuZGF0aW9ucycgfSk7XG4gICAgICAgIGNvbnN0IHJlY1RleHRFbCA9IHJlY0VsLmNyZWF0ZUVsKCdwJyk7XG4gICAgICAgIHJlY1RleHRFbC50ZXh0Q29udGVudCA9IHJlY29tbWVuZGF0aW9ucy5yZWFzb247XG4gICAgICAgIHJlY1RleHRFbC5zdHlsZS5mb250U3R5bGUgPSAnaXRhbGljJztcbiAgICAgICAgcmVjVGV4dEVsLnN0eWxlLmNvbG9yID0gJ3ZhcigtLXRleHQtbXV0ZWQpJztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgc2VjdXJpdHkgY29uZmlndXJhdGlvbiBzZXR0aW5nc1xuICAgICAqL1xuICAgIHByaXZhdGUgY3JlYXRlU2VjdXJpdHlTZXR0aW5ncygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICAgICAgXG4gICAgICAgIC8vIFNlY3VyaXR5IFNldHRpbmdzIHNlY3Rpb25cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnU2VjdXJpdHkgQ29uZmlndXJhdGlvbicgfSk7XG5cbiAgICAgICAgLy8gVXNlIEVudmlyb25tZW50IFZhcmlhYmxlc1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdVc2UgRW52aXJvbm1lbnQgVmFyaWFibGVzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdMb2FkIEFQSSBrZXlzIGZyb20gZW52aXJvbm1lbnQgdmFyaWFibGVzIGluc3RlYWQgb2Ygc3RvcmluZyB0aGVtIGluIGNvbmZpZ3VyYXRpb24nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3MudXNlRW52aXJvbm1lbnRWYXJpYWJsZXMgfHwgZmFsc2UpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZVNldHRpbmcoJ3VzZUVudmlyb25tZW50VmFyaWFibGVzJywgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTsgLy8gUmVmcmVzaCBkaXNwbGF5IHRvIHNob3cvaGlkZSByZWxldmFudCBzZXR0aW5nc1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAvLyBFbnZpcm9ubWVudCBWYXJpYWJsZSBQcmVmaXhcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MudXNlRW52aXJvbm1lbnRWYXJpYWJsZXMpIHtcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdFbnZpcm9ubWVudCBWYXJpYWJsZSBQcmVmaXgnKVxuICAgICAgICAgICAgICAgIC5zZXREZXNjKCdQcmVmaXggZm9yIGVudmlyb25tZW50IHZhcmlhYmxlIG5hbWVzIChlLmcuLCBZVENfR0VNSU5JX0FQSV9LRVkpJylcbiAgICAgICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdZVEMnKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZXR0aW5ncy5lbnZpcm9ubWVudFByZWZpeCB8fCAnWVRDJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVTZXR0aW5nKCdlbnZpcm9ubWVudFByZWZpeCcsIHZhbHVlIHx8ICdZVEMnKTtcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICAvLyBFbnZpcm9ubWVudCBUZW1wbGF0ZVxuICAgICAgICAgICAgY29uc3QgZW52VGVtcGxhdGUgPSB0aGlzLnNlY3VyZUNvbmZpZy5nZXRFbnZpcm9ubWVudFRlbXBsYXRlKCk7XG4gICAgICAgICAgICBjb25zdCBlbnZTZWN0aW9uID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCd5dGMtZW52LXRlbXBsYXRlJyk7XG4gICAgICAgICAgICBlbnZTZWN0aW9uLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0Vudmlyb25tZW50IFZhcmlhYmxlcyBUZW1wbGF0ZScgfSk7XG4gICAgICAgICAgICBlbnZTZWN0aW9uLmNyZWF0ZUVsKCdwJywgeyBcbiAgICAgICAgICAgICAgICB0ZXh0OiAnQ29weSB0aGVzZSBlbnZpcm9ubWVudCB2YXJpYWJsZXMgdG8geW91ciBzaGVsbCBwcm9maWxlOicsXG4gICAgICAgICAgICAgICAgY2xzOiAnc2V0dGluZy1pdGVtLWRlc2NyaXB0aW9uJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHByZUVsID0gZW52U2VjdGlvbi5jcmVhdGVFbCgncHJlJyk7XG4gICAgICAgICAgICBwcmVFbC5jcmVhdGVFbCgnY29kZScsIHsgdGV4dDogZW52VGVtcGxhdGUgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENvcHkgYnV0dG9uXG4gICAgICAgICAgICBuZXcgU2V0dGluZyhlbnZTZWN0aW9uKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdDb3B5IFRlbXBsYXRlJylcbiAgICAgICAgICAgICAgICAuc2V0RGVzYygnQ29weSB0aGUgZW52aXJvbm1lbnQgdmFyaWFibGVzIHRlbXBsYXRlIHRvIGNsaXBib2FyZCcpXG4gICAgICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdDb3B5IHRvIENsaXBib2FyZCcpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGVudlRlbXBsYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRCdXR0b25UZXh0KCdDb3BpZWQhJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IGJ1dHRvbi5zZXRCdXR0b25UZXh0KCdDb3B5IHRvIENsaXBib2FyZCcpLCAyMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2VjdXJpdHkgVmFsaWRhdGlvblxuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy5zZWN1cmVDb25maWcudmFsaWRhdGVTZWN1cml0eUNvbmZpZ3VyYXRpb24oKTtcbiAgICAgICAgaWYgKCF2YWxpZGF0aW9uLmlzU2VjdXJlKSB7XG4gICAgICAgICAgICBjb25zdCB3YXJuaW5nRWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoJ3l0Yy1zZWN1cml0eS13YXJuaW5ncycpO1xuICAgICAgICAgICAgd2FybmluZ0VsLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ1x1MjZBMFx1RkUwRiBTZWN1cml0eSBXYXJuaW5ncycsIGNsczogJ3l0Yy13YXJuaW5nLWhlYWRlcicgfSk7XG4gICAgICAgICAgICB2YWxpZGF0aW9uLndhcm5pbmdzLmZvckVhY2god2FybmluZyA9PiB7XG4gICAgICAgICAgICAgICAgd2FybmluZ0VsLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiB3YXJuaW5nLCBjbHM6ICd5dGMtd2FybmluZy10ZXh0JyB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBmaWxlIGNvbmZpZ3VyYXRpb24gc2V0dGluZ3NcbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZUZpbGVTZXR0aW5ncygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbGUgU2V0dGluZ3Mgc2VjdGlvblxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdGaWxlIENvbmZpZ3VyYXRpb24nIH0pO1xuXG4gICAgICAgIC8vIE91dHB1dCBQYXRoXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ091dHB1dCBQYXRoJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdEaXJlY3RvcnkgcGF0aCB3aGVyZSBwcm9jZXNzZWQgdmlkZW9zIHdpbGwgYmUgc2F2ZWQgKHJlbGF0aXZlIHRvIHZhdWx0IHJvb3QpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihNRVNTQUdFUy5QTEFDRUhPTERFUlMuT1VUUFVUX1BBVEgpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2V0dGluZ3Mub3V0cHV0UGF0aClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlU2V0dGluZygnb3V0cHV0UGF0aCcsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHZhbGlkYXRpb24gc3RhdHVzIGRpc3BsYXlcbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZVZhbGlkYXRpb25TdGF0dXMoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIFxuICAgICAgICBpZiAodGhpcy52YWxpZGF0aW9uRXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yU2VjdGlvbiA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdigpO1xuICAgICAgICAgICAgZXJyb3JTZWN0aW9uLnN0eWxlLm1hcmdpblRvcCA9ICcyMHB4JztcbiAgICAgICAgICAgIGVycm9yU2VjdGlvbi5zdHlsZS5wYWRkaW5nID0gJzEwcHgnO1xuICAgICAgICAgICAgZXJyb3JTZWN0aW9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWVycm9yKSc7XG4gICAgICAgICAgICBlcnJvclNlY3Rpb24uc3R5bGUuYm9yZGVyUmFkaXVzID0gJzRweCc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGVycm9yU2VjdGlvbi5jcmVhdGVFbCgnaDQnLCB7IFxuICAgICAgICAgICAgICAgIHRleHQ6ICdcdTI2QTBcdUZFMEYgQ29uZmlndXJhdGlvbiBJc3N1ZXMnLFxuICAgICAgICAgICAgICAgIGF0dHI6IHsgc3R5bGU6ICdjb2xvcjogdmFyKC0tdGV4dC1lcnJvcik7IG1hcmdpbi10b3A6IDA7JyB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZXJyb3JMaXN0ID0gZXJyb3JTZWN0aW9uLmNyZWF0ZUVsKCd1bCcpO1xuICAgICAgICAgICAgdGhpcy52YWxpZGF0aW9uRXJyb3JzLmZvckVhY2goZXJyb3IgPT4ge1xuICAgICAgICAgICAgICAgIGVycm9yTGlzdC5jcmVhdGVFbCgnbGknLCB7IHRleHQ6IGVycm9yIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBzdWNjZXNzU2VjdGlvbiA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdigpO1xuICAgICAgICAgICAgc3VjY2Vzc1NlY3Rpb24uc3R5bGUubWFyZ2luVG9wID0gJzIwcHgnO1xuICAgICAgICAgICAgc3VjY2Vzc1NlY3Rpb24uc3R5bGUucGFkZGluZyA9ICcxMHB4JztcbiAgICAgICAgICAgIHN1Y2Nlc3NTZWN0aW9uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLXN1Y2Nlc3MpJztcbiAgICAgICAgICAgIHN1Y2Nlc3NTZWN0aW9uLnN0eWxlLmJvcmRlclJhZGl1cyA9ICc0cHgnO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBzdWNjZXNzU2VjdGlvbi5jcmVhdGVFbCgnaDQnLCB7IFxuICAgICAgICAgICAgICAgIHRleHQ6ICdcdTI3MDUgQ29uZmlndXJhdGlvbiBWYWxpZCcsXG4gICAgICAgICAgICAgICAgYXR0cjogeyBzdHlsZTogJ2NvbG9yOiB2YXIoLS10ZXh0LXN1Y2Nlc3MpOyBtYXJnaW4tdG9wOiAwOycgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgdXNhZ2UgaW5zdHJ1Y3Rpb25zXG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVVc2FnZUluc3RydWN0aW9ucygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICAgICAgXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1VzYWdlIEluc3RydWN0aW9ucycgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBpbnN0cnVjdGlvbnMgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgaW5zdHJ1Y3Rpb25zLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxwPjxzdHJvbmc+SG93IHRvIHVzZTo8L3N0cm9uZz48L3A+XG4gICAgICAgICAgICA8b2w+XG4gICAgICAgICAgICAgICAgPGxpPlNldCB5b3VyIEdlbWluaSBvciBHcm9xIEFQSSBrZXkgYWJvdmU8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5Db25maWd1cmUgeW91ciBwcmVmZXJyZWQgb3V0cHV0IGRpcmVjdG9yeTwvbGk+XG4gICAgICAgICAgICAgICAgPGxpPkNsaWNrIHRoZSB2aWRlbyBpY29uIGluIHRoZSByaWJib24gb3IgdXNlIHRoZSBjb21tYW5kIHBhbGV0dGU8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5QYXN0ZSBhIFlvdVR1YmUgVVJMIGFuZCBjbGljayBQcm9jZXNzPC9saT5cbiAgICAgICAgICAgICAgICA8bGk+VGhlIHBsdWdpbiB3aWxsIGFuYWx5emUgdGhlIHZpZGVvIGFuZCBjcmVhdGUgYSBzdHJ1Y3R1cmVkIG5vdGU8L2xpPlxuICAgICAgICAgICAgPC9vbD5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgPHA+PHN0cm9uZz5BUEkgS2V5IEluZm9ybWF0aW9uOjwvc3Ryb25nPjwvcD5cbiAgICAgICAgICAgIDx1bD5cbiAgICAgICAgICAgICAgICA8bGk+PHN0cm9uZz5HZW1pbmkgQVBJOjwvc3Ryb25nPiBHZXQgeW91ciBrZXkgZnJvbSA8YSBocmVmPVwiaHR0cHM6Ly9haXN0dWRpby5nb29nbGUuY29tL2FwcC9hcGlrZXlcIj5Hb29nbGUgQUkgU3R1ZGlvPC9hPjwvbGk+XG4gICAgICAgICAgICAgICAgPGxpPjxzdHJvbmc+R3JvcSBBUEk6PC9zdHJvbmc+IEdldCB5b3VyIGtleSBmcm9tIDxhIGhyZWY9XCJodHRwczovL2NvbnNvbGUuZ3JvcS5jb20va2V5c1wiPkdyb3EgQ29uc29sZTwvYT48L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5BdCBsZWFzdCBvbmUgQVBJIGtleSBpcyByZXF1aXJlZCBmb3IgdGhlIHBsdWdpbiB0byBmdW5jdGlvbjwvbGk+XG4gICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgXG4gICAgICAgICAgICA8cD48c3Ryb25nPk5vdGU6PC9zdHJvbmc+IFRoaXMgcGx1Z2luIHJlcXVpcmVzIGFuIGFjdGl2ZSBpbnRlcm5ldCBjb25uZWN0aW9uIGFuZCBhIHZhbGlkIEFQSSBrZXkuPC9wPlxuICAgICAgICAgICAgPHA+PHN0cm9uZz5MaW1pdGF0aW9uczo8L3N0cm9uZz4gRHVlIHRvIENPUlMgcmVzdHJpY3Rpb25zLCBmdWxsIHRyYW5zY3JpcHQgZXh0cmFjdGlvbiBtYXkgYmUgbGltaXRlZC4gVGhlIHBsdWdpbiB3b3JrcyB3aXRoIGF2YWlsYWJsZSBtZXRhZGF0YSBhbmQgZGVzY3JpcHRpb25zLjwvcD5cbiAgICAgICAgYDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgYSBzZXR0aW5nIHZhbHVlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyB1cGRhdGVTZXR0aW5nKFxuICAgICAgICBrZXk6IGtleW9mIFlvdVR1YmVQbHVnaW5TZXR0aW5ncywgXG4gICAgICAgIHZhbHVlOiBzdHJpbmcgfCBib29sZWFuXG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAodGhpcy5zZXR0aW5ncyBhcyBhbnkpW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMudmFsaWRhdGVBbmRTYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIEVycm9ySGFuZGxlci5oYW5kbGUoZXJyb3IgYXMgRXJyb3IsIGBTZXR0aW5ncyB1cGRhdGUgZm9yICR7a2V5fWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgYW5kIHNhdmUgc2V0dGluZ3NcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHZhbGlkYXRlQW5kU2F2ZVNldHRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCB2YWxpZGF0aW9uID0gVmFsaWRhdGlvblV0aWxzLnZhbGlkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMudmFsaWRhdGlvbkVycm9ycyA9IHZhbGlkYXRpb24uZXJyb3JzO1xuICAgICAgICBcbiAgICAgICAgaWYgKHZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5vcHRpb25zLm9uU2V0dGluZ3NDaGFuZ2UodGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFJlZnJlc2ggZGlzcGxheSB0byBzaG93IHZhbGlkYXRpb24gc3RhdHVzXG4gICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBjdXJyZW50IHNldHRpbmdzXG4gICAgICovXG4gICAgZ2V0U2V0dGluZ3MoKTogWW91VHViZVBsdWdpblNldHRpbmdzIHtcbiAgICAgICAgcmV0dXJuIHsgLi4udGhpcy5zZXR0aW5ncyB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBzZXR0aW5ncyBmcm9tIGV4dGVybmFsIHNvdXJjZVxuICAgICAqL1xuICAgIHVwZGF0ZVNldHRpbmdzKG5ld1NldHRpbmdzOiBZb3VUdWJlUGx1Z2luU2V0dGluZ3MpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHsgLi4ubmV3U2V0dGluZ3MgfTtcbiAgICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgfVxufVxuIiwgIi8qKlxuICogU2VjdXJlIGNvbmZpZ3VyYXRpb24gc2VydmljZSBmb3IgQVBJIGtleSBtYW5hZ2VtZW50XG4gKiBTdXBwb3J0cyBib3RoIGRpcmVjdCBjb25maWd1cmF0aW9uIGFuZCBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbiAqL1xuXG5pbXBvcnQgeyBZb3VUdWJlUGx1Z2luU2V0dGluZ3MgfSBmcm9tICcuLi9pbnRlcmZhY2VzL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIFNlY3VyZUNvbmZpZ1NlcnZpY2Uge1xuICAgIHByaXZhdGUgc2V0dGluZ3M6IFlvdVR1YmVQbHVnaW5TZXR0aW5ncztcblxuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzOiBZb3VUdWJlUGx1Z2luU2V0dGluZ3MpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBBUEkga2V5IHdpdGggZW52aXJvbm1lbnQgdmFyaWFibGUgZmFsbGJhY2tcbiAgICAgKi9cbiAgICBnZXRBcGlLZXkoa2V5VHlwZTogJ2dlbWluaScgfCAnZ3JvcScpOiBzdHJpbmcge1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy51c2VFbnZpcm9ubWVudFZhcmlhYmxlcykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RnJvbUVudmlyb25tZW50KGtleVR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ga2V5VHlwZSA9PT0gJ2dlbWluaScgPyB0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleSA6IHRoaXMuc2V0dGluZ3MuZ3JvcUFwaUtleTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgQVBJIGtleSBmcm9tIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0RnJvbUVudmlyb25tZW50KGtleVR5cGU6ICdnZW1pbmknIHwgJ2dyb3EnKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgcHJlZml4ID0gdGhpcy5zZXR0aW5ncy5lbnZpcm9ubWVudFByZWZpeCB8fCAnWVRDJztcbiAgICAgICAgY29uc3QgZW52VmFyTmFtZSA9IGAke3ByZWZpeH1fJHtrZXlUeXBlLnRvVXBwZXJDYXNlKCl9X0FQSV9LRVlgO1xuICAgICAgICBcbiAgICAgICAgLy8gSW4gYnJvd3NlciBlbnZpcm9ubWVudCwgd2UgY2FuIG9ubHkgYWNjZXNzIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICAgICAgICAvLyB0aGF0IHdlcmUgc2V0IGR1cmluZyBidWlsZCB0aW1lIG9yIHRocm91Z2ggYSBzZWN1cmUgY29uZmlndXJhdGlvbiBzZXJ2aWNlXG4gICAgICAgIHJldHVybiB0aGlzLmdldFNlY3VyZUVudlZhcihlbnZWYXJOYW1lKSB8fCAnJztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZWN1cmUgZW52aXJvbm1lbnQgdmFyaWFibGUgYWNjZXNzXG4gICAgICogTm90ZTogSW4gT2JzaWRpYW4gcGx1Z2lucywgZW52aXJvbm1lbnQgdmFyaWFibGVzIGFyZSBsaW1pdGVkXG4gICAgICogVGhpcyBtZXRob2QgY2FuIGJlIGV4dGVuZGVkIGZvciBzZXJ2ZXItc2lkZSBlbnZpcm9ubWVudHNcbiAgICAgKi9cbiAgICBwcml2YXRlIGdldFNlY3VyZUVudlZhcih2YXJOYW1lOiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgICAgICAvLyBGb3IgT2JzaWRpYW4gcGx1Z2luIGVudmlyb25tZW50LCB3ZSBtaWdodCBuZWVkIHRvIHVzZSBhIGRpZmZlcmVudCBhcHByb2FjaFxuICAgICAgICAvLyBzdWNoIGFzIHJlYWRpbmcgZnJvbSBhIHNlY3VyZSBjb25maWd1cmF0aW9uIGZpbGUgb3Igc2VydmljZVxuICAgICAgICBpZiAodHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHByb2Nlc3MuZW52KSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvY2Vzcy5lbnZbdmFyTmFtZV07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEZvciBicm93c2VyL09ic2lkaWFuIGVudmlyb25tZW50LCBpbXBsZW1lbnQgc2VjdXJlIHN0b3JhZ2UgYWNjZXNzXG4gICAgICAgIHJldHVybiB0aGlzLmdldEZyb21TZWN1cmVTdG9yYWdlKHZhck5hbWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBmcm9tIHNlY3VyZSBzdG9yYWdlIChpbXBsZW1lbnRhdGlvbiBkZXBlbmRzIG9uIGVudmlyb25tZW50KVxuICAgICAqL1xuICAgIHByaXZhdGUgZ2V0RnJvbVNlY3VyZVN0b3JhZ2UodmFyTmFtZTogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgLy8gVGhpcyBjb3VsZCBiZSBpbXBsZW1lbnRlZCB0byByZWFkIGZyb206XG4gICAgICAgIC8vIC0gRW5jcnlwdGVkIGxvY2FsIHN0b3JhZ2VcbiAgICAgICAgLy8gLSBTeXN0ZW0ga2V5Y2hhaW5cbiAgICAgICAgLy8gLSBTZWN1cmUgY29uZmlndXJhdGlvbiBzZXJ2aWNlXG4gICAgICAgIC8vIEZvciBub3csIHJldHVybiB1bmRlZmluZWQgdG8gZmFsbCBiYWNrIHRvIGRpcmVjdCBjb25maWd1cmF0aW9uXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgY29uZmlndXJhdGlvbiBzZWN1cml0eVxuICAgICAqL1xuICAgIHZhbGlkYXRlU2VjdXJpdHlDb25maWd1cmF0aW9uKCk6IHsgaXNTZWN1cmU6IGJvb2xlYW47IHdhcm5pbmdzOiBzdHJpbmdbXSB9IHtcbiAgICAgICAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGxldCBpc1NlY3VyZSA9IHRydWU7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgQVBJIGtleXMgYXJlIHN0b3JlZCBkaXJlY3RseSBhbmQgd2FyblxuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MudXNlRW52aXJvbm1lbnRWYXJpYWJsZXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleSAmJiB0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgd2FybmluZ3MucHVzaCgnR2VtaW5pIEFQSSBrZXkgaXMgc3RvcmVkIGRpcmVjdGx5IGluIGNvbmZpZ3VyYXRpb24uIENvbnNpZGVyIHVzaW5nIGVudmlyb25tZW50IHZhcmlhYmxlcy4nKTtcbiAgICAgICAgICAgICAgICBpc1NlY3VyZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZ3JvcUFwaUtleSAmJiB0aGlzLnNldHRpbmdzLmdyb3FBcGlLZXkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHdhcm5pbmdzLnB1c2goJ0dyb3EgQVBJIGtleSBpcyBzdG9yZWQgZGlyZWN0bHkgaW4gY29uZmlndXJhdGlvbi4gQ29uc2lkZXIgdXNpbmcgZW52aXJvbm1lbnQgdmFyaWFibGVzLicpO1xuICAgICAgICAgICAgICAgIGlzU2VjdXJlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBmb3Igd2VhayBBUEkga2V5c1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5nZW1pbmlBcGlLZXkgPT09ICd5b3VyLWFwaS1rZXktaGVyZScgfHwgdGhpcy5zZXR0aW5ncy5ncm9xQXBpS2V5ID09PSAneW91ci1hcGkta2V5LWhlcmUnKSB7XG4gICAgICAgICAgICB3YXJuaW5ncy5wdXNoKCdEZWZhdWx0IHBsYWNlaG9sZGVyIEFQSSBrZXlzIGRldGVjdGVkLiBQbGVhc2Ugc2V0IHJlYWwgQVBJIGtleXMuJyk7XG4gICAgICAgICAgICBpc1NlY3VyZSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgaXNTZWN1cmUsIHdhcm5pbmdzIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGNvbmZpZ3VyYXRpb24gdGVtcGxhdGUgZm9yIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICAgICAqL1xuICAgIGdldEVudmlyb25tZW50VGVtcGxhdGUoKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgcHJlZml4ID0gdGhpcy5zZXR0aW5ncy5lbnZpcm9ubWVudFByZWZpeCB8fCAnWVRDJztcbiAgICAgICAgcmV0dXJuIGAjIFlvdVR1YmVDbGlwcGVyIEVudmlyb25tZW50IFZhcmlhYmxlc1xuIyBTZXQgdGhlc2UgaW4geW91ciBlbnZpcm9ubWVudCBmb3Igc2VjdXJlIEFQSSBrZXkgbWFuYWdlbWVudFxuXG4jIEdvb2dsZSBHZW1pbmkgQVBJIEtleVxuJHtwcmVmaXh9X0dFTUlOSV9BUElfS0VZPXlvdXJfZ2VtaW5pX2FwaV9rZXlfaGVyZVxuXG4jIEdyb3EgQVBJIEtleSAgXG4ke3ByZWZpeH1fR1JPUV9BUElfS0VZPXlvdXJfZ3JvcV9hcGlfa2V5X2hlcmVcblxuIyBVc2FnZTpcbiMgMS4gU2V0IHRoZXNlIHZhcmlhYmxlcyBpbiB5b3VyIHNoZWxsIHByb2ZpbGUgKC5iYXNocmMsIC56c2hyYywgZXRjLilcbiMgMi4gRW5hYmxlIFwiVXNlIEVudmlyb25tZW50IFZhcmlhYmxlc1wiIGluIHBsdWdpbiBzZXR0aW5nc1xuIyAzLiBSZXN0YXJ0IE9ic2lkaWFuIHRvIHBpY2sgdXAgdGhlIG5ldyBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbmA7XG4gICAgfVxufSIsICIvKipcbiAqIFBlcmZvcm1hbmNlIHByZXNldHMgYW5kIHNwZWVkL3F1YWxpdHkgY29uZmlndXJhdGlvbnNcbiAqL1xuXG5pbXBvcnQgeyBQZXJmb3JtYW5jZVByZXNldCwgTW9kZWxTdHJhdGVneSwgQ3VzdG9tVGltZW91dFNldHRpbmdzIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy90eXBlcyc7XG5cbmV4cG9ydCBjb25zdCBQRVJGT1JNQU5DRV9QUkVTRVRTOiBSZWNvcmQ8c3RyaW5nLCBQZXJmb3JtYW5jZVByZXNldD4gPSB7XG4gICAgZmFzdDoge1xuICAgICAgICBuYW1lOiAnRmFzdCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnTWF4aW11bSBzcGVlZCB3aXRoIG9wdGltaXplZCBtb2RlbHMgYW5kIHBhcmFsbGVsIHByb2Nlc3NpbmcuIEJlc3QgZm9yIHF1aWNrIHN1bW1hcmllcy4nLFxuICAgICAgICB0aW1lb3V0czoge1xuICAgICAgICAgICAgZ2VtaW5pVGltZW91dDogMTUwMDAsXG4gICAgICAgICAgICBncm9xVGltZW91dDogMTAwMDAsXG4gICAgICAgICAgICBtZXRhZGF0YVRpbWVvdXQ6IDUwMDBcbiAgICAgICAgfSxcbiAgICAgICAgZW5hYmxlUGFyYWxsZWw6IHRydWUsXG4gICAgICAgIHByZWZlck11bHRpbW9kYWw6IGZhbHNlLFxuICAgICAgICBtb2RlbFN0cmF0ZWd5OiB7XG4gICAgICAgICAgICBicmllZkZvcm1hdDogJ2xsYW1hLTMuMS04Yi1pbnN0YW50JyxcbiAgICAgICAgICAgIGV4ZWN1dGl2ZVN1bW1hcnk6ICdsbGFtYS0zLjMtNzBiLXZlcnNhdGlsZScsXG4gICAgICAgICAgICBkZXRhaWxlZEd1aWRlOiAnZ2VtaW5pLTIuMC1mbGFzaC1saXRlJyxcbiAgICAgICAgICAgIGZhbGxiYWNrTW9kZWw6ICdsbGFtYS0zLjEtOGItaW5zdGFudCdcbiAgICAgICAgfVxuICAgIH0sXG4gICAgYmFsYW5jZWQ6IHtcbiAgICAgICAgbmFtZTogJ0JhbGFuY2VkJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdCYWxhbmNlZCBzcGVlZCBhbmQgcXVhbGl0eSB3aXRoIG11bHRpbW9kYWwgYW5hbHlzaXMgZm9yIGRldGFpbGVkIGNvbnRlbnQuJyxcbiAgICAgICAgdGltZW91dHM6IHtcbiAgICAgICAgICAgIGdlbWluaVRpbWVvdXQ6IDMwMDAwLFxuICAgICAgICAgICAgZ3JvcVRpbWVvdXQ6IDIwMDAwLFxuICAgICAgICAgICAgbWV0YWRhdGFUaW1lb3V0OiAxMDAwMFxuICAgICAgICB9LFxuICAgICAgICBlbmFibGVQYXJhbGxlbDogdHJ1ZSxcbiAgICAgICAgcHJlZmVyTXVsdGltb2RhbDogdHJ1ZSxcbiAgICAgICAgbW9kZWxTdHJhdGVneToge1xuICAgICAgICAgICAgYnJpZWZGb3JtYXQ6ICdsbGFtYS0zLjEtOGItaW5zdGFudCcsXG4gICAgICAgICAgICBleGVjdXRpdmVTdW1tYXJ5OiAnZ2VtaW5pLTIuMC1mbGFzaC1saXRlJyxcbiAgICAgICAgICAgIGRldGFpbGVkR3VpZGU6ICdnZW1pbmktMi41LWZsYXNoJyxcbiAgICAgICAgICAgIGZhbGxiYWNrTW9kZWw6ICdsbGFtYS0zLjMtNzBiLXZlcnNhdGlsZSdcbiAgICAgICAgfVxuICAgIH0sXG4gICAgcXVhbGl0eToge1xuICAgICAgICBuYW1lOiAnUXVhbGl0eScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnTWF4aW11bSBxdWFsaXR5IHdpdGggY29tcHJlaGVuc2l2ZSBtdWx0aW1vZGFsIGFuYWx5c2lzLiBTbG93ZXIgYnV0IG1vc3QgZGV0YWlsZWQuJyxcbiAgICAgICAgdGltZW91dHM6IHtcbiAgICAgICAgICAgIGdlbWluaVRpbWVvdXQ6IDYwMDAwLFxuICAgICAgICAgICAgZ3JvcVRpbWVvdXQ6IDMwMDAwLFxuICAgICAgICAgICAgbWV0YWRhdGFUaW1lb3V0OiAxNTAwMFxuICAgICAgICB9LFxuICAgICAgICBlbmFibGVQYXJhbGxlbDogZmFsc2UsXG4gICAgICAgIHByZWZlck11bHRpbW9kYWw6IHRydWUsXG4gICAgICAgIG1vZGVsU3RyYXRlZ3k6IHtcbiAgICAgICAgICAgIGJyaWVmRm9ybWF0OiAnZ2VtaW5pLTIuMC1mbGFzaC1saXRlJyxcbiAgICAgICAgICAgIGV4ZWN1dGl2ZVN1bW1hcnk6ICdnZW1pbmktMi41LWZsYXNoJyxcbiAgICAgICAgICAgIGRldGFpbGVkR3VpZGU6ICdnZW1pbmktMi41LXBybycsXG4gICAgICAgICAgICBmYWxsYmFja01vZGVsOiAnZ2VtaW5pLTIuMC1mbGFzaCdcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1RJTUVPVVRTOiBDdXN0b21UaW1lb3V0U2V0dGluZ3MgPSB7XG4gICAgZ2VtaW5pVGltZW91dDogMzAwMDAsXG4gICAgZ3JvcVRpbWVvdXQ6IDIwMDAwLFxuICAgIG1ldGFkYXRhVGltZW91dDogMTAwMDBcbn07XG5cbmV4cG9ydCBjb25zdCBNT0RFTF9DSEFSQUNURVJJU1RJQ1M6IFJlY29yZDxzdHJpbmcsIHtcbiAgICBzcGVlZDogJ2Zhc3QnIHwgJ21lZGl1bScgfCAnc2xvdyc7XG4gICAgcXVhbGl0eTogJ2Jhc2ljJyB8ICdnb29kJyB8ICdleGNlbGxlbnQnO1xuICAgIG11bHRpbW9kYWw6IGJvb2xlYW47XG4gICAgcHJvdmlkZXI6IHN0cmluZztcbiAgICBlc3RpbWF0ZWRMYXRlbmN5OiBudW1iZXI7IC8vIGluIHNlY29uZHNcbiAgICBtYXhUb2tlbnM6IG51bWJlcjtcbn0+ID0ge1xuICAgIC8vIEdyb3EgTW9kZWxzIChTcGVlZCBvcHRpbWl6ZWQpXG4gICAgJ2xsYW1hLTMuMS04Yi1pbnN0YW50Jzoge1xuICAgICAgICBzcGVlZDogJ2Zhc3QnLFxuICAgICAgICBxdWFsaXR5OiAnYmFzaWMnLFxuICAgICAgICBtdWx0aW1vZGFsOiBmYWxzZSxcbiAgICAgICAgcHJvdmlkZXI6ICdHcm9xJyxcbiAgICAgICAgZXN0aW1hdGVkTGF0ZW5jeTogMixcbiAgICAgICAgbWF4VG9rZW5zOiAyMDAwXG4gICAgfSxcbiAgICAnbGxhbWEtMy4zLTcwYi12ZXJzYXRpbGUnOiB7XG4gICAgICAgIHNwZWVkOiAnZmFzdCcsXG4gICAgICAgIHF1YWxpdHk6ICdnb29kJyxcbiAgICAgICAgbXVsdGltb2RhbDogZmFsc2UsXG4gICAgICAgIHByb3ZpZGVyOiAnR3JvcScsXG4gICAgICAgIGVzdGltYXRlZExhdGVuY3k6IDUsXG4gICAgICAgIG1heFRva2VuczogNDAwMFxuICAgIH0sXG4gICAgJ2xsYW1hLTQtbWF2ZXJpY2stMTdiLTEyOGUtaW5zdHJ1Y3QnOiB7XG4gICAgICAgIHNwZWVkOiAnZmFzdCcsXG4gICAgICAgIHF1YWxpdHk6ICdleGNlbGxlbnQnLFxuICAgICAgICBtdWx0aW1vZGFsOiBmYWxzZSxcbiAgICAgICAgcHJvdmlkZXI6ICdHcm9xJyxcbiAgICAgICAgZXN0aW1hdGVkTGF0ZW5jeTogOCxcbiAgICAgICAgbWF4VG9rZW5zOiA0MDAwXG4gICAgfSxcbiAgICAnbGxhbWEtNC1zY291dC0xN2ItMTZlLWluc3RydWN0Jzoge1xuICAgICAgICBzcGVlZDogJ2Zhc3QnLFxuICAgICAgICBxdWFsaXR5OiAnZ29vZCcsXG4gICAgICAgIG11bHRpbW9kYWw6IGZhbHNlLFxuICAgICAgICBwcm92aWRlcjogJ0dyb3EnLFxuICAgICAgICBlc3RpbWF0ZWRMYXRlbmN5OiA2LFxuICAgICAgICBtYXhUb2tlbnM6IDQwMDBcbiAgICB9LFxuXG4gICAgLy8gR2VtaW5pIEZsYXNoIE1vZGVscyAoQmFsYW5jZWQpXG4gICAgJ2dlbWluaS0yLjAtZmxhc2gnOiB7XG4gICAgICAgIHNwZWVkOiAnbWVkaXVtJyxcbiAgICAgICAgcXVhbGl0eTogJ2dvb2QnLFxuICAgICAgICBtdWx0aW1vZGFsOiB0cnVlLFxuICAgICAgICBwcm92aWRlcjogJ0dvb2dsZSBHZW1pbmknLFxuICAgICAgICBlc3RpbWF0ZWRMYXRlbmN5OiAxMCxcbiAgICAgICAgbWF4VG9rZW5zOiA0MDAwXG4gICAgfSxcbiAgICAnZ2VtaW5pLTIuMC1mbGFzaC1saXRlJzoge1xuICAgICAgICBzcGVlZDogJ2Zhc3QnLFxuICAgICAgICBxdWFsaXR5OiAnZ29vZCcsXG4gICAgICAgIG11bHRpbW9kYWw6IHRydWUsXG4gICAgICAgIHByb3ZpZGVyOiAnR29vZ2xlIEdlbWluaScsXG4gICAgICAgIGVzdGltYXRlZExhdGVuY3k6IDYsXG4gICAgICAgIG1heFRva2VuczogMzAwMFxuICAgIH0sXG4gICAgJ2dlbWluaS0yLjUtZmxhc2gnOiB7XG4gICAgICAgIHNwZWVkOiAnbWVkaXVtJyxcbiAgICAgICAgcXVhbGl0eTogJ2V4Y2VsbGVudCcsXG4gICAgICAgIG11bHRpbW9kYWw6IHRydWUsXG4gICAgICAgIHByb3ZpZGVyOiAnR29vZ2xlIEdlbWluaScsXG4gICAgICAgIGVzdGltYXRlZExhdGVuY3k6IDEyLFxuICAgICAgICBtYXhUb2tlbnM6IDQwMDBcbiAgICB9LFxuICAgICdnZW1pbmktMi41LWZsYXNoLWxpdGUnOiB7XG4gICAgICAgIHNwZWVkOiAnZmFzdCcsXG4gICAgICAgIHF1YWxpdHk6ICdnb29kJyxcbiAgICAgICAgbXVsdGltb2RhbDogdHJ1ZSxcbiAgICAgICAgcHJvdmlkZXI6ICdHb29nbGUgR2VtaW5pJyxcbiAgICAgICAgZXN0aW1hdGVkTGF0ZW5jeTogOCxcbiAgICAgICAgbWF4VG9rZW5zOiAzMDAwXG4gICAgfSxcblxuICAgIC8vIEdlbWluaSBQcm8gTW9kZWxzIChRdWFsaXR5IG9wdGltaXplZClcbiAgICAnZ2VtaW5pLTEuNS1wcm8nOiB7XG4gICAgICAgIHNwZWVkOiAnc2xvdycsXG4gICAgICAgIHF1YWxpdHk6ICdleGNlbGxlbnQnLFxuICAgICAgICBtdWx0aW1vZGFsOiB0cnVlLFxuICAgICAgICBwcm92aWRlcjogJ0dvb2dsZSBHZW1pbmknLFxuICAgICAgICBlc3RpbWF0ZWRMYXRlbmN5OiAyMCxcbiAgICAgICAgbWF4VG9rZW5zOiA0MDAwXG4gICAgfSxcbiAgICAnZ2VtaW5pLTIuMC1wcm8nOiB7XG4gICAgICAgIHNwZWVkOiAnc2xvdycsXG4gICAgICAgIHF1YWxpdHk6ICdleGNlbGxlbnQnLFxuICAgICAgICBtdWx0aW1vZGFsOiB0cnVlLFxuICAgICAgICBwcm92aWRlcjogJ0dvb2dsZSBHZW1pbmknLFxuICAgICAgICBlc3RpbWF0ZWRMYXRlbmN5OiAyNSxcbiAgICAgICAgbWF4VG9rZW5zOiA0MDAwXG4gICAgfSxcbiAgICAnZ2VtaW5pLTIuNS1wcm8nOiB7XG4gICAgICAgIHNwZWVkOiAnc2xvdycsXG4gICAgICAgIHF1YWxpdHk6ICdleGNlbGxlbnQnLFxuICAgICAgICBtdWx0aW1vZGFsOiB0cnVlLFxuICAgICAgICBwcm92aWRlcjogJ0dvb2dsZSBHZW1pbmknLFxuICAgICAgICBlc3RpbWF0ZWRMYXRlbmN5OiAzMCxcbiAgICAgICAgbWF4VG9rZW5zOiA0MDAwXG4gICAgfSxcbiAgICAnZ2VtaW5pLTIuNS1wcm8tdHRzJzoge1xuICAgICAgICBzcGVlZDogJ3Nsb3cnLFxuICAgICAgICBxdWFsaXR5OiAnZXhjZWxsZW50JyxcbiAgICAgICAgbXVsdGltb2RhbDogdHJ1ZSxcbiAgICAgICAgcHJvdmlkZXI6ICdHb29nbGUgR2VtaW5pJyxcbiAgICAgICAgZXN0aW1hdGVkTGF0ZW5jeTogMzUsXG4gICAgICAgIG1heFRva2VuczogNDAwMFxuICAgIH1cbn07XG5cbmV4cG9ydCBjbGFzcyBQZXJmb3JtYW5jZU9wdGltaXplciB7XG4gICAgc3RhdGljIGdldE9wdGltYWxNb2RlbChcbiAgICAgICAgZm9ybWF0OiBzdHJpbmcsXG4gICAgICAgIHZpZGVvRHVyYXRpb24/OiBudW1iZXIsXG4gICAgICAgIHBlcmZvcm1hbmNlTW9kZTogc3RyaW5nID0gJ2JhbGFuY2VkJyxcbiAgICAgICAgYXZhaWxhYmxlTW9kZWxzOiBzdHJpbmdbXSA9IFtdXG4gICAgKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgcHJlc2V0ID0gUEVSRk9STUFOQ0VfUFJFU0VUU1twZXJmb3JtYW5jZU1vZGVdIHx8IFBFUkZPUk1BTkNFX1BSRVNFVFMuYmFsYW5jZWQ7XG4gICAgICAgIGNvbnN0IHN0cmF0ZWd5ID0gcHJlc2V0Lm1vZGVsU3RyYXRlZ3k7XG5cbiAgICAgICAgLy8gU2VsZWN0IG1vZGVsIGJhc2VkIG9uIGZvcm1hdFxuICAgICAgICBsZXQgc2VsZWN0ZWRNb2RlbCA9IHN0cmF0ZWd5LmZhbGxiYWNrTW9kZWw7XG5cbiAgICAgICAgc3dpdGNoIChmb3JtYXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ2JyaWVmJzpcbiAgICAgICAgICAgICAgICBzZWxlY3RlZE1vZGVsID0gc3RyYXRlZ3kuYnJpZWZGb3JtYXQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdleGVjdXRpdmUtc3VtbWFyeSc6XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRNb2RlbCA9IHN0cmF0ZWd5LmV4ZWN1dGl2ZVN1bW1hcnk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdkZXRhaWxlZC1ndWlkZSc6XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRNb2RlbCA9IHN0cmF0ZWd5LmRldGFpbGVkR3VpZGU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3IgdmVyeSBzaG9ydCB2aWRlb3MgaW4gZmFzdCBtb2RlLCBwcmlvcml0aXplIHNwZWVkXG4gICAgICAgIGlmICh2aWRlb0R1cmF0aW9uICYmIHZpZGVvRHVyYXRpb24gPCAzMDAgJiYgcGVyZm9ybWFuY2VNb2RlID09PSAnZmFzdCcpIHtcbiAgICAgICAgICAgIHJldHVybiAnbGxhbWEtMy4xLThiLWluc3RhbnQnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgc2VsZWN0ZWQgbW9kZWwgaXMgYXZhaWxhYmxlXG4gICAgICAgIGlmIChhdmFpbGFibGVNb2RlbHMuaW5jbHVkZXMoc2VsZWN0ZWRNb2RlbCkpIHtcbiAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZE1vZGVsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRmluZCBiZXN0IGF2YWlsYWJsZSBhbHRlcm5hdGl2ZVxuICAgICAgICBjb25zdCBjaGFyYWN0ZXJpc3RpY3MgPSBNT0RFTF9DSEFSQUNURVJJU1RJQ1Nbc2VsZWN0ZWRNb2RlbF07XG4gICAgICAgIGlmIChjaGFyYWN0ZXJpc3RpY3MpIHtcbiAgICAgICAgICAgIGNvbnN0IGFsdGVybmF0aXZlcyA9IGF2YWlsYWJsZU1vZGVscy5maWx0ZXIobW9kZWwgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFsdCA9IE1PREVMX0NIQVJBQ1RFUklTVElDU1ttb2RlbF07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFsdCAmJlxuICAgICAgICAgICAgICAgICAgICAgICBhbHQucHJvdmlkZXIgPT09IGNoYXJhY3RlcmlzdGljcy5wcm92aWRlciAmJlxuICAgICAgICAgICAgICAgICAgICAgICBhbHQubXVsdGltb2RhbCA9PT0gY2hhcmFjdGVyaXN0aWNzLm11bHRpbW9kYWw7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKGFsdGVybmF0aXZlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgLy8gUmV0dXJuIGZhc3Rlc3QgYWx0ZXJuYXRpdmVcbiAgICAgICAgICAgICAgICByZXR1cm4gYWx0ZXJuYXRpdmVzLnNvcnQoKGEsIGIpID0+XG4gICAgICAgICAgICAgICAgICAgIE1PREVMX0NIQVJBQ1RFUklTVElDU1thXS5lc3RpbWF0ZWRMYXRlbmN5IC0gTU9ERUxfQ0hBUkFDVEVSSVNUSUNTW2JdLmVzdGltYXRlZExhdGVuY3lcbiAgICAgICAgICAgICAgICApWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN0cmF0ZWd5LmZhbGxiYWNrTW9kZWw7XG4gICAgfVxuXG4gICAgc3RhdGljIGVzdGltYXRlUHJvY2Vzc2luZ1RpbWUoXG4gICAgICAgIG1vZGVsOiBzdHJpbmcsXG4gICAgICAgIHZpZGVvRHVyYXRpb24/OiBudW1iZXIsXG4gICAgICAgIGZvcm1hdDogc3RyaW5nID0gJ2RldGFpbGVkLWd1aWRlJ1xuICAgICk6IHsgbWluOiBudW1iZXI7IG1heDogbnVtYmVyOyBkZXNjcmlwdGlvbjogc3RyaW5nIH0ge1xuICAgICAgICBjb25zdCBjaGFyYWN0ZXJpc3RpY3MgPSBNT0RFTF9DSEFSQUNURVJJU1RJQ1NbbW9kZWxdO1xuICAgICAgICBpZiAoIWNoYXJhY3RlcmlzdGljcykge1xuICAgICAgICAgICAgcmV0dXJuIHsgbWluOiAxNSwgbWF4OiA2MCwgZGVzY3JpcHRpb246ICdVbmtub3duIG1vZGVsJyB9O1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGJhc2VUaW1lID0gY2hhcmFjdGVyaXN0aWNzLmVzdGltYXRlZExhdGVuY3k7XG5cbiAgICAgICAgLy8gQWRkIHRpbWUgZm9yIHZpZGVvIHByb2Nlc3NpbmdcbiAgICAgICAgaWYgKHZpZGVvRHVyYXRpb24pIHtcbiAgICAgICAgICAgIGJhc2VUaW1lICs9IE1hdGgubWluKHZpZGVvRHVyYXRpb24gLyA2MCwgMzApOyAvLyBNYXggMzBzIGZvciB2aWRlbyBhbmFseXNpc1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9ybWF0LXNwZWNpZmljIGFkanVzdG1lbnRzXG4gICAgICAgIGNvbnN0IGZvcm1hdE11bHRpcGxpZXJzID0ge1xuICAgICAgICAgICAgJ2JyaWVmJzogMC41LFxuICAgICAgICAgICAgJ2V4ZWN1dGl2ZS1zdW1tYXJ5JzogMC44LFxuICAgICAgICAgICAgJ2RldGFpbGVkLWd1aWRlJzogMS4yLFxuICAgICAgICAgICAgJ2N1c3RvbSc6IDEuMFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGFkanVzdGVkVGltZSA9IGJhc2VUaW1lICogKGZvcm1hdE11bHRpcGxpZXJzW2Zvcm1hdF0gfHwgMS4wKTtcblxuICAgICAgICAvLyBBZGQgYnVmZmVyIGZvciBuZXR3b3JrIGxhdGVuY3lcbiAgICAgICAgY29uc3QgbWluID0gTWF0aC5yb3VuZChhZGp1c3RlZFRpbWUgKiAwLjgpO1xuICAgICAgICBjb25zdCBtYXggPSBNYXRoLnJvdW5kKGFkanVzdGVkVGltZSAqIDEuNSk7XG5cbiAgICAgICAgY29uc3Qgc3BlZWQgPSBjaGFyYWN0ZXJpc3RpY3Muc3BlZWQ7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gc3BlZWQgPT09ICdmYXN0JyA/ICdGYXN0IHByb2Nlc3NpbmcnIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwZWVkID09PSAnbWVkaXVtJyA/ICdTdGFuZGFyZCBwcm9jZXNzaW5nJyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAnQ29tcHJlaGVuc2l2ZSBwcm9jZXNzaW5nJztcblxuICAgICAgICByZXR1cm4geyBtaW4sIG1heCwgZGVzY3JpcHRpb24gfTtcbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0UGVyZm9ybWFuY2VSZWNvbW1lbmRhdGlvbnMoXG4gICAgICAgIGN1cnJlbnRNb2RlOiBzdHJpbmcsXG4gICAgICAgIHZpZGVvRHVyYXRpb24/OiBudW1iZXIsXG4gICAgICAgIGZvcm1hdDogc3RyaW5nID0gJ2RldGFpbGVkLWd1aWRlJ1xuICAgICk6IHsgcmVjb21tZW5kZWQ6IHN0cmluZzsgcmVhc29uOiBzdHJpbmc7IGFsdGVybmF0aXZlOiBzdHJpbmcgfSB7XG4gICAgICAgIGlmICghdmlkZW9EdXJhdGlvbiB8fCB2aWRlb0R1cmF0aW9uIDwgMTgwKSB7IC8vIDwgMyBtaW51dGVzXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHJlY29tbWVuZGVkOiAnZmFzdCcsXG4gICAgICAgICAgICAgICAgcmVhc29uOiAnU2hvcnQgdmlkZW9zIGRvblxcJ3QgcmVxdWlyZSBleHRlbnNpdmUgYW5hbHlzaXMnLFxuICAgICAgICAgICAgICAgIGFsdGVybmF0aXZlOiAnYmFsYW5jZWQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZvcm1hdCA9PT0gJ2JyaWVmJykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByZWNvbW1lbmRlZDogJ2Zhc3QnLFxuICAgICAgICAgICAgICAgIHJlYXNvbjogJ0JyaWVmIGZvcm1hdCBwcmlvcml0aXplcyBzcGVlZCBvdmVyIGRlcHRoJyxcbiAgICAgICAgICAgICAgICBhbHRlcm5hdGl2ZTogJ2JhbGFuY2VkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh2aWRlb0R1cmF0aW9uID4gMTgwMCkgeyAvLyA+IDMwIG1pbnV0ZXNcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmVjb21tZW5kZWQ6ICdxdWFsaXR5JyxcbiAgICAgICAgICAgICAgICByZWFzb246ICdMb25nIHZpZGVvcyBiZW5lZml0IGZyb20gY29tcHJlaGVuc2l2ZSBhbmFseXNpcycsXG4gICAgICAgICAgICAgICAgYWx0ZXJuYXRpdmU6ICdiYWxhbmNlZCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVjb21tZW5kZWQ6ICdiYWxhbmNlZCcsXG4gICAgICAgICAgICByZWFzb246ICdHb29kIGJhbGFuY2Ugb2Ygc3BlZWQgYW5kIHF1YWxpdHkgZm9yIG1vc3QgY29udGVudCcsXG4gICAgICAgICAgICBhbHRlcm5hdGl2ZTogY3VycmVudE1vZGUgPT09ICdiYWxhbmNlZCcgPyAnZmFzdCcgOiAnYmFsYW5jZWQnXG4gICAgICAgIH07XG4gICAgfVxufSIsICIvKipcbiAqIEFJIHNlcnZpY2UgdGhhdCBtYW5hZ2VzIG11bHRpcGxlIHByb3ZpZGVycyB3aXRoIHBhcmFsbGVsIHByb2Nlc3Npbmcgc3VwcG9ydFxuICovXG5cbmltcG9ydCB7IEFJU2VydmljZSBhcyBJQUlTZXJ2aWNlLCBBSVByb3ZpZGVyLCBBSVJlc3BvbnNlLCBZb3VUdWJlUGx1Z2luU2V0dGluZ3MsIFBlcmZvcm1hbmNlTW9kZSB9IGZyb20gJy4uLy4uL2ludGVyZmFjZXMvdHlwZXMnO1xuaW1wb3J0IHsgUFJPVklERVJfTU9ERUxfT1BUSU9OUywgUFJPVklERVJfTU9ERUxfTElTVF9VUkxTLCBQUk9WSURFUl9NT0RFTF9SRUdFWCB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9hcGknO1xuaW1wb3J0IHsgRXJyb3JIYW5kbGVyIH0gZnJvbSAnLi4vLi4vdXRpbHMvZXJyb3ItaGFuZGxlcic7XG5pbXBvcnQgeyBNRVNTQUdFUyB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9tZXNzYWdlcyc7XG5pbXBvcnQgeyBQRVJGT1JNQU5DRV9QUkVTRVRTLCBQZXJmb3JtYW5jZU9wdGltaXplciB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9wZXJmb3JtYW5jZSc7XG5cbmV4cG9ydCBjbGFzcyBBSVNlcnZpY2UgaW1wbGVtZW50cyBJQUlTZXJ2aWNlIHtcbiAgICBwcml2YXRlIHByb3ZpZGVyczogQUlQcm92aWRlcltdID0gW107XG4gICAgcHJpdmF0ZSBzZXR0aW5nczogWW91VHViZVBsdWdpblNldHRpbmdzO1xuXG4gICAgY29uc3RydWN0b3IocHJvdmlkZXJzOiBBSVByb3ZpZGVyW10sIHNldHRpbmdzOiBZb3VUdWJlUGx1Z2luU2V0dGluZ3MpIHtcbiAgICAgICAgaWYgKCFwcm92aWRlcnMgfHwgcHJvdmlkZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE1FU1NBR0VTLkVSUk9SUy5NSVNTSU5HX0FQSV9LRVlTKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByb3ZpZGVycyA9IHByb3ZpZGVycztcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgICAgICB0aGlzLmFwcGx5UGVyZm9ybWFuY2VTZXR0aW5ncygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFwcGx5IHBlcmZvcm1hbmNlIHNldHRpbmdzIHRvIHByb3ZpZGVyc1xuICAgICAqL1xuICAgIHByaXZhdGUgYXBwbHlQZXJmb3JtYW5jZVNldHRpbmdzKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBwcmVzZXQgPSBQRVJGT1JNQU5DRV9QUkVTRVRTW3RoaXMuc2V0dGluZ3MucGVyZm9ybWFuY2VNb2RlXSB8fCBQRVJGT1JNQU5DRV9QUkVTRVRTLmJhbGFuY2VkO1xuICAgICAgICBjb25zdCB0aW1lb3V0cyA9IHRoaXMuc2V0dGluZ3MuY3VzdG9tVGltZW91dHMgfHwgcHJlc2V0LnRpbWVvdXRzO1xuXG4gICAgICAgIHRoaXMucHJvdmlkZXJzLmZvckVhY2gocHJvdmlkZXIgPT4ge1xuICAgICAgICAgICAgaWYgKHByb3ZpZGVyLm5hbWUgPT09ICdHb29nbGUgR2VtaW5pJykge1xuICAgICAgICAgICAgICAgIHByb3ZpZGVyLnNldFRpbWVvdXQodGltZW91dHMuZ2VtaW5pVGltZW91dCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHByb3ZpZGVyLm5hbWUgPT09ICdHcm9xJykge1xuICAgICAgICAgICAgICAgIHByb3ZpZGVyLnNldFRpbWVvdXQodGltZW91dHMuZ3JvcVRpbWVvdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgc2V0dGluZ3MgYW5kIHJlYXBwbHkgcGVyZm9ybWFuY2UgY29uZmlndXJhdGlvbnNcbiAgICAgKi9cbiAgICB1cGRhdGVTZXR0aW5ncyhuZXdTZXR0aW5nczogWW91VHViZVBsdWdpblNldHRpbmdzKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBuZXdTZXR0aW5ncztcbiAgICAgICAgdGhpcy5hcHBseVBlcmZvcm1hbmNlU2V0dGluZ3MoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYXZhaWxhYmxlIG1vZGVsIG9wdGlvbnMgZm9yIGEgcHJvdmlkZXIgbmFtZSAoZnJvbSBjb25zdGFudHMgbWFwcGluZylcbiAgICAgKi9cbiAgICBnZXRQcm92aWRlck1vZGVscyhwcm92aWRlck5hbWU6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgcmF3ID0gUFJPVklERVJfTU9ERUxfT1BUSU9OU1twcm92aWRlck5hbWVdIHx8IFtdIGFzIGFueVtdO1xuICAgICAgICAvLyBTdXBwb3J0IGJvdGggbGVnYWN5IHN0cmluZyBhcnJheXMgYW5kIHRoZSBuZXcgb2JqZWN0IHNoYXBlIChQcm92aWRlck1vZGVsRW50cnkpXG4gICAgICAgIHJldHVybiByYXcubWFwKHIgPT4gdHlwZW9mIHIgPT09ICdzdHJpbmcnID8gciA6IChyICYmIHIubmFtZSA/IHIubmFtZSA6IFN0cmluZyhyKSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJlc3QtZWZmb3J0IGZldGNoIG9mIGxhdGVzdCBtb2RlbHMgZm9yIGFsbCBwcm92aWRlcnMgYnkgc2NyYXBpbmcga25vd24gcHJvdmlkZXIgcGFnZXMuXG4gICAgICogUmV0dXJucyBhIG1hcHBpbmcgcHJvdmlkZXJOYW1lIC0+IGxpc3Qgb2YgZGlzY292ZXJlZCBtb2RlbHMuIEZhbGxzIGJhY2sgdG8gc3RhdGljIG1hcHBpbmcuXG4gICAgICovXG4gICAgYXN5bmMgZmV0Y2hMYXRlc3RNb2RlbHMoKTogUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7fTtcbiAgICAgICAgY29uc3QgcHJvdmlkZXJzID0gdGhpcy5nZXRQcm92aWRlck5hbWVzKCk7XG4gICAgICAgIGZvciAoY29uc3QgcCBvZiBwcm92aWRlcnMpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbW9kZWxzID0gYXdhaXQgdGhpcy5mZXRjaExhdGVzdE1vZGVsc0ZvclByb3ZpZGVyKHApO1xuICAgICAgICAgICAgICAgIHJlc3VsdFtwXSA9IG1vZGVscy5sZW5ndGggPiAwID8gbW9kZWxzIDogKFBST1ZJREVSX01PREVMX09QVElPTlNbcF0gPyAoUFJPVklERVJfTU9ERUxfT1BUSU9OU1twXSBhcyBhbnlbXSkubWFwKG0gPT4gdHlwZW9mIG0gPT09ICdzdHJpbmcnID8gbSA6IG0ubmFtZSkgOiBbXSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtwXSA9IFBST1ZJREVSX01PREVMX09QVElPTlNbcF0gPyAoUFJPVklERVJfTU9ERUxfT1BUSU9OU1twXSBhcyBhbnlbXSkubWFwKG0gPT4gdHlwZW9mIG0gPT09ICdzdHJpbmcnID8gbSA6IG0ubmFtZSkgOiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZldGNoIGxhdGVzdCBtb2RlbHMgZm9yIGEgc2luZ2xlIHByb3ZpZGVyIChiZXN0LWVmZm9ydCBzY3JhcGluZykuXG4gICAgICovXG4gICAgYXN5bmMgZmV0Y2hMYXRlc3RNb2RlbHNGb3JQcm92aWRlcihwcm92aWRlck5hbWU6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICAgICAgY29uc3QgdXJsID0gUFJPVklERVJfTU9ERUxfTElTVF9VUkxTW3Byb3ZpZGVyTmFtZV07XG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gUFJPVklERVJfTU9ERUxfUkVHRVhbcHJvdmlkZXJOYW1lXTtcbiAgICAgICAgaWYgKCF1cmwgfHwgIXJlZ2V4KSB7XG4gICAgICAgICAgICByZXR1cm4gUFJPVklERVJfTU9ERUxfT1BUSU9OU1twcm92aWRlck5hbWVdID8gKFBST1ZJREVSX01PREVMX09QVElPTlNbcHJvdmlkZXJOYW1lXSBhcyBhbnlbXSkubWFwKG0gPT4gdHlwZW9mIG0gPT09ICdzdHJpbmcnID8gbSA6IG0ubmFtZSkgOiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwID0gYXdhaXQgZmV0Y2godXJsLCB7IG1ldGhvZDogJ0dFVCcgfSk7XG4gICAgICAgICAgICBpZiAoIXJlc3Aub2spIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUFJPVklERVJfTU9ERUxfT1BUSU9OU1twcm92aWRlck5hbWVdID8gKFBST1ZJREVSX01PREVMX09QVElPTlNbcHJvdmlkZXJOYW1lXSBhcyBhbnlbXSkubWFwKG0gPT4gdHlwZW9mIG0gPT09ICdzdHJpbmcnID8gbSA6IG0ubmFtZSkgOiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwLnRleHQoKTtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSB0ZXh0Lm1hdGNoKHJlZ2V4KSB8fCBbXTtcbiAgICAgICAgICAgIC8vIE5vcm1hbGl6ZSBhbmQgZGVkdXBlXG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkID0gQXJyYXkuZnJvbShuZXcgU2V0KG1hdGNoZXMubWFwKG0gPT4gbS50b0xvd2VyQ2FzZSgpKSkpO1xuICAgICAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZWQ7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBPbiBhbnkgZXJyb3IsIHJldHVybiBzdGF0aWMgZmFsbGJhY2tcbiAgICAgICAgICAgIHJldHVybiBQUk9WSURFUl9NT0RFTF9PUFRJT05TW3Byb3ZpZGVyTmFtZV0gPyAoUFJPVklERVJfTU9ERUxfT1BUSU9OU1twcm92aWRlck5hbWVdIGFzIGFueVtdKS5tYXAobSA9PiB0eXBlb2YgbSA9PT0gJ3N0cmluZycgPyBtIDogbS5uYW1lKSA6IFtdO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJvY2VzcyBwcm9tcHQgd2l0aCBmYWxsYmFjayBzdXBwb3J0IChvcmlnaW5hbCBzZXF1ZW50aWFsIG1ldGhvZClcbiAgICAgKi9cbiAgICBhc3luYyBwcm9jZXNzKHByb21wdDogc3RyaW5nKTogUHJvbWlzZTxBSVJlc3BvbnNlPiB7XG4gICAgICAgIGlmICghcHJvbXB0IHx8IHR5cGVvZiBwcm9tcHQgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1ZhbGlkIHByb21wdCBpcyByZXF1aXJlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVXNlIHBhcmFsbGVsIHByb2Nlc3NpbmcgaWYgZW5hYmxlZFxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVQYXJhbGxlbFByb2Nlc3NpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NQYXJhbGxlbChwcm9tcHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMucHJvY2Vzc1NlcXVlbnRpYWwocHJvbXB0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzIHByb21wdCB3aXRoIHNlcXVlbnRpYWwgZmFsbGJhY2sgKG9yaWdpbmFsIG1ldGhvZClcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHByb2Nlc3NTZXF1ZW50aWFsKHByb21wdDogc3RyaW5nKTogUHJvbWlzZTxBSVJlc3BvbnNlPiB7XG4gICAgICAgIGxldCBsYXN0RXJyb3I6IEVycm9yIHwgbnVsbCA9IG51bGw7XG5cbiAgICAgICAgLy8gVHJ5IGVhY2ggcHJvdmlkZXIgaW4gb3JkZXJcbiAgICAgICAgZm9yIChjb25zdCBwcm92aWRlciBvZiB0aGlzLnByb3ZpZGVycykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgQXR0ZW1wdGluZyB0byBwcm9jZXNzIHdpdGggJHtwcm92aWRlci5uYW1lfS4uLmApO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBwcm92aWRlci5wcm9jZXNzKHByb21wdCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoY29udGVudCAmJiBjb250ZW50LnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXI6IHByb3ZpZGVyLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDogcHJvdmlkZXIubW9kZWxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0VtcHR5IHJlc3BvbnNlIGZyb20gQUkgcHJvdmlkZXInKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGxhc3RFcnJvciA9IGVycm9yIGFzIEVycm9yO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgJHtwcm92aWRlci5uYW1lfSBmYWlsZWQ6YCwgZXJyb3IpO1xuXG4gICAgICAgICAgICAgICAgLy8gQ29udGludWUgdG8gbmV4dCBwcm92aWRlciB1bmxlc3MgdGhpcyBpcyB0aGUgbGFzdCBvbmVcbiAgICAgICAgICAgICAgICBpZiAocHJvdmlkZXIgPT09IHRoaXMucHJvdmlkZXJzW3RoaXMucHJvdmlkZXJzLmxlbmd0aCAtIDFdKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFsbCBwcm92aWRlcnMgZmFpbGVkXG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGxhc3RFcnJvclxuICAgICAgICAgICAgPyBNRVNTQUdFUy5FUlJPUlMuQUlfUFJPQ0VTU0lORyhsYXN0RXJyb3IubWVzc2FnZSlcbiAgICAgICAgICAgIDogJ0FsbCBBSSBwcm92aWRlcnMgZmFpbGVkIHRvIHByb2Nlc3MgdGhlIHJlcXVlc3QnO1xuXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByb2Nlc3MgcHJvbXB0IHdpdGggcGFyYWxsZWwgcHJvdmlkZXIgcmFjaW5nIGZvciBtYXhpbXVtIHNwZWVkXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBwcm9jZXNzUGFyYWxsZWwocHJvbXB0OiBzdHJpbmcpOiBQcm9taXNlPEFJUmVzcG9uc2U+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ1N0YXJ0aW5nIHBhcmFsbGVsIHByb3ZpZGVyIHJhY2luZy4uLicpO1xuXG4gICAgICAgIGNvbnN0IHByb3ZpZGVyUHJvbWlzZXMgPSB0aGlzLnByb3ZpZGVycy5tYXAoYXN5bmMgKHByb3ZpZGVyKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCAocHJvdmlkZXIgYXMgYW55KS5wcm9jZXNzV2l0aFRpbWVvdXQocHJvbXB0KTtcblxuICAgICAgICAgICAgICAgIGlmIChjb250ZW50ICYmIGNvbnRlbnQudHJpbSgpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlcjogcHJvdmlkZXIubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsOiBwcm92aWRlci5tb2RlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZVRpbWU6IERhdGUubm93KClcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0VtcHR5IHJlc3BvbnNlIGZyb20gQUkgcHJvdmlkZXInKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgJHtwcm92aWRlci5uYW1lfSBmYWlsZWQgaW4gcGFyYWxsZWwgcmFjZTpgLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IChlcnJvciBhcyBFcnJvcikubWVzc2FnZSxcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXI6IHByb3ZpZGVyLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsOiBwcm92aWRlci5tb2RlbCxcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlVGltZTogRGF0ZS5ub3coKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFdhaXQgZm9yIGZpcnN0IHN1Y2Nlc3NmdWwgcmVzcG9uc2Ugb3IgYWxsIHRvIGNvbXBsZXRlXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQocHJvdmlkZXJQcm9taXNlcyk7XG5cbiAgICAgICAgLy8gRmluZCBmaXJzdCBzdWNjZXNzZnVsIHJlc3BvbnNlXG4gICAgICAgIGZvciAoY29uc3QgcmVzdWx0IG9mIHJlc3VsdHMpIHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAnZnVsZmlsbGVkJyAmJiByZXN1bHQudmFsdWUuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBQYXJhbGxlbCB3aW5uZXI6ICR7cmVzdWx0LnZhbHVlLnByb3ZpZGVyfSAoJHtEYXRlLm5vdygpIC0gcmVzdWx0LnZhbHVlLnJlc3BvbnNlVGltZX1tcylgKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiByZXN1bHQudmFsdWUuY29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXI6IHJlc3VsdC52YWx1ZS5wcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHJlc3VsdC52YWx1ZS5tb2RlbFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBbGwgcHJvdmlkZXJzIGZhaWxlZCAtIGNvbGxlY3QgZXJyb3JzXG4gICAgICAgIGNvbnN0IGVycm9ycyA9IHJlc3VsdHNcbiAgICAgICAgICAgIC5maWx0ZXIociA9PiByLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgJiYgIXIudmFsdWUuc3VjY2VzcylcbiAgICAgICAgICAgIC5tYXAociA9PiAociBhcyBhbnkpLnZhbHVlLmVycm9yKTtcblxuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvcnMubGVuZ3RoID4gMFxuICAgICAgICAgICAgPyBNRVNTQUdFUy5FUlJPUlMuQUlfUFJPQ0VTU0lORyhlcnJvcnMuam9pbignOyAnKSlcbiAgICAgICAgICAgIDogJ0FsbCBBSSBwcm92aWRlcnMgZmFpbGVkIHRvIHByb2Nlc3MgdGhlIHJlcXVlc3QnO1xuXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByb2Nlc3MgcHJvbXB0IHVzaW5nIGEgc3BlY2lmaWMgcHJvdmlkZXIgbmFtZS4gT3B0aW9uYWxseSBvdmVycmlkZSB0aGUgbW9kZWwgaWYgc3VwcG9ydGVkLlxuICAgICAqL1xuICAgIGFzeW5jIHByb2Nlc3NXaXRoKHByb3ZpZGVyTmFtZTogc3RyaW5nLCBwcm9tcHQ6IHN0cmluZywgb3ZlcnJpZGVNb2RlbD86IHN0cmluZyk6IFByb21pc2U8QUlSZXNwb25zZT4ge1xuICAgICAgICBjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzLmZpbmQocCA9PiBwLm5hbWUgPT09IHByb3ZpZGVyTmFtZSk7XG4gICAgICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQUkgcHJvdmlkZXIgbm90IGZvdW5kOiAke3Byb3ZpZGVyTmFtZX1gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHByb3ZpZGVyIHN1cHBvcnRzIHNldE1vZGVsLCBhcHBseSBvdmVycmlkZVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKG92ZXJyaWRlTW9kZWwgJiYgdHlwZW9mIChwcm92aWRlciBhcyBhbnkpLnNldE1vZGVsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgKHByb3ZpZGVyIGFzIGFueSkuc2V0TW9kZWwob3ZlcnJpZGVNb2RlbCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBwcm92aWRlci5wcm9jZXNzKHByb21wdCk7XG4gICAgICAgICAgICBpZiAoY29udGVudCAmJiBjb250ZW50LnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgY29udGVudCwgcHJvdmlkZXI6IHByb3ZpZGVyLm5hbWUsIG1vZGVsOiBwcm92aWRlci5tb2RlbCB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0VtcHR5IHJlc3BvbnNlIGZyb20gQUkgcHJvdmlkZXInKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNRVNTQUdFUy5FUlJPUlMuQUlfUFJPQ0VTU0lORygoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGFueSBwcm92aWRlcnMgYXJlIGF2YWlsYWJsZVxuICAgICAqL1xuICAgIGhhc0F2YWlsYWJsZVByb3ZpZGVycygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvdmlkZXJzLmxlbmd0aCA+IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGxpc3Qgb2YgYXZhaWxhYmxlIHByb3ZpZGVyIG5hbWVzXG4gICAgICovXG4gICAgZ2V0UHJvdmlkZXJOYW1lcygpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3ZpZGVycy5tYXAocCA9PiBwLm5hbWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhIG5ldyBwcm92aWRlclxuICAgICAqL1xuICAgIGFkZFByb3ZpZGVyKHByb3ZpZGVyOiBBSVByb3ZpZGVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMucHJvdmlkZXJzLnB1c2gocHJvdmlkZXIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhIHByb3ZpZGVyIGJ5IG5hbWVcbiAgICAgKi9cbiAgICByZW1vdmVQcm92aWRlcihwcm92aWRlck5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMucHJvdmlkZXJzLmZpbmRJbmRleChwID0+IHAubmFtZSA9PT0gcHJvdmlkZXJOYW1lKTtcbiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5wcm92aWRlcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG4iLCAiLyoqXG4gKiBHb29nbGUgR2VtaW5pIEFJIHByb3ZpZGVyIGltcGxlbWVudGF0aW9uXG4gKi9cblxuaW1wb3J0IHsgQVBJX0VORFBPSU5UUywgQUlfTU9ERUxTLCBQUk9WSURFUl9NT0RFTF9PUFRJT05TIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL2FwaSc7XG5pbXBvcnQgeyBNRVNTQUdFUyB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9tZXNzYWdlcyc7XG5pbXBvcnQgeyBCYXNlQUlQcm92aWRlciB9IGZyb20gJy4vYmFzZSc7XG5cbmV4cG9ydCBjbGFzcyBHZW1pbmlQcm92aWRlciBleHRlbmRzIEJhc2VBSVByb3ZpZGVyIHtcbiAgICByZWFkb25seSBuYW1lID0gJ0dvb2dsZSBHZW1pbmknO1xuXG4gICAgY29uc3RydWN0b3IoYXBpS2V5OiBzdHJpbmcsIG1vZGVsPzogc3RyaW5nLCB0aW1lb3V0PzogbnVtYmVyKSB7XG4gICAgICAgIHN1cGVyKGFwaUtleSwgbW9kZWwgfHwgQUlfTU9ERUxTLkdFTUlOSSwgdGltZW91dCk7XG4gICAgfVxuXG4gICAgYXN5bmMgcHJvY2Vzcyhwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7QVBJX0VORFBPSU5UUy5HRU1JTkl9P2tleT0ke3RoaXMuYXBpS2V5fWAsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5jcmVhdGVIZWFkZXJzKCksXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh0aGlzLmNyZWF0ZVJlcXVlc3RCb2R5KHByb21wdCkpXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEhhbmRsZSBzcGVjaWZpYyBHZW1pbmkgZXJyb3JzXG4gICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE1FU1NBR0VTLkVSUk9SUy5HRU1JTklfSU5WQUxJRF9LRVkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVBUElFcnJvcihyZXNwb25zZSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF0aGlzLnZhbGlkYXRlUmVzcG9uc2UoZGF0YSwgWydjYW5kaWRhdGVzJywgJzAnLCAnY29udGVudCcsICdwYXJ0cycsICcwJywgJ3RleHQnXSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCByZXNwb25zZSBmb3JtYXQgZnJvbSBHZW1pbmkgQVBJJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5leHRyYWN0Q29udGVudChkYXRhKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgY3JlYXRlSGVhZGVycygpOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgY3JlYXRlUmVxdWVzdEJvZHkocHJvbXB0OiBzdHJpbmcpOiBhbnkge1xuICAgICAgICAvLyBEZXRlY3QgWW91VHViZSBwcm9tcHRzIGJ5IHNjYW5uaW5nIGZvciBjb21tb24gbWFya2VycyBpbnN0ZWFkIG9mIGJyaXR0bGUgbGl0ZXJhbHNcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZFByb21wdCA9IHByb21wdC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjb25zdCBpc1ZpZGVvQW5hbHlzaXMgPVxuICAgICAgICAgICAgbm9ybWFsaXplZFByb21wdC5pbmNsdWRlcygneW91dHViZSB2aWRlbycpIHx8XG4gICAgICAgICAgICBub3JtYWxpemVkUHJvbXB0LmluY2x1ZGVzKCd5b3V0dS5iZS8nKSB8fFxuICAgICAgICAgICAgbm9ybWFsaXplZFByb21wdC5pbmNsdWRlcygneW91dHViZS5jb20vJyk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBiYXNlQ29uZmlnID0ge1xuICAgICAgICAgICAgY29udGVudHM6IFt7XG4gICAgICAgICAgICAgICAgcGFydHM6IFt7IHRleHQ6IHByb21wdCB9XVxuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBnZW5lcmF0aW9uQ29uZmlnOiB7XG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IDQwMDAsIC8vIEluY3JlYXNlZCBmb3IgZGV0YWlsZWQgZ3VpZGVzXG4gICAgICAgICAgICAgICAgY2FuZGlkYXRlQ291bnQ6IDFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBzYWZldHlTZXR0aW5nczogW1xuICAgICAgICAgICAgLy8gICAgIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgY2F0ZWdvcnk6IFwiSEFSTV9DQVRFR09SWV9IQVJBU1NNRU5UXCIsXG4gICAgICAgICAgICAvLyAgICAgICAgIHRocmVzaG9sZDogXCJCTE9DS19NRURJVU1fQU5EX0FCT1ZFXCJcbiAgICAgICAgICAgIC8vICAgICB9LFxuICAgICAgICAgICAgLy8gICAgIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgY2F0ZWdvcnk6IFwiSEFSTV9DQVRFR09SWV9IQVRFX1NQRUVDSFwiLCBcbiAgICAgICAgICAgIC8vICAgICAgICAgdGhyZXNob2xkOiBcIkJMT0NLX01FRElVTV9BTkRfQUJPVkVcIlxuICAgICAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgIC8vIF1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBFbmFibGUgbXVsdGltb2RhbCBhbmFseXNpcyBmb3IgWW91VHViZSB2aWRlb3Mgb25seSB3aGVuIHRoZSBjaG9zZW4gR2VtaW5pIG1vZGVsXG4gICAgICAgIC8vIGlzIGtub3duIHRvIHN1cHBvcnQgYXVkaW8vdmlkZW8gdG9rZW5zLiBTZW5kaW5nIHRoZSBgdXNlQXVkaW9WaWRlb1Rva2Vuc2AgZmxhZ1xuICAgICAgICAvLyB0byBtb2RlbHMgdGhhdCBkb24ndCBzdXBwb3J0IGl0IGNhdXNlcyBhIDQwMCBmcm9tIHRoZSBHZW1pbmkgQVBJICh1bmtub3duIGZpZWxkKS5cbiAgICAgICAgLy8gQ29uc2VydmF0aXZlIGNoZWNrOiBvbmx5IGVuYWJsZSBmb3IgbmV3ZXIgMi41LXNlcmllcyBtb2RlbHMuXG4gICAgICAgIGlmIChpc1ZpZGVvQW5hbHlzaXMpIHtcbiAgICAgICAgICAgIC8vIExvb2t1cCB0aGUgbW9kZWwgZW50cnkgaW4gUFJPVklERVJfTU9ERUxfT1BUSU9OUyB0byBzZWUgaWYgaXQgZXhwbGljaXRseVxuICAgICAgICAgICAgLy8gc3VwcG9ydHMgYXVkaW8vdmlkZW8gdG9rZW5zLiBUaGlzIGlzIG1vcmUgcmVsaWFibGUgdGhhbiBhIG5hbWUgaGV1cmlzdGljLlxuICAgICAgICAgICAgY29uc3QgcHJvdmlkZXJNb2RlbHMgPSBQUk9WSURFUl9NT0RFTF9PUFRJT05TWydHb29nbGUgR2VtaW5pJ10gfHwgW10gYXMgYW55W107XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50TW9kZWxOYW1lID0gU3RyaW5nKHRoaXMubW9kZWwgfHwgJycpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVkID0gcHJvdmlkZXJNb2RlbHMuZmluZChtID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gKHR5cGVvZiBtID09PSAnc3RyaW5nJykgPyBtIDogKG0gJiYgbS5uYW1lID8gbS5uYW1lIDogJycpO1xuICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcobmFtZSkudG9Mb3dlckNhc2UoKSA9PT0gY3VycmVudE1vZGVsTmFtZTtcbiAgICAgICAgICAgIH0pIGFzIGFueSB8IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgY29uc3Qgc3VwcG9ydHNBdWRpb1ZpZGVvID0gbWF0Y2hlZCAmJiBtYXRjaGVkLnN1cHBvcnRzQXVkaW9WaWRlbyA9PT0gdHJ1ZTtcblxuICAgICAgICAgICAgLy8gR2VtaW5pIGF1dG9tYXRpY2FsbHkgcHJvY2Vzc2VzIFlvdVR1YmUgVVJMcyBhbmQgZXh0cmFjdHMgYm90aCBhdWRpb1xuICAgICAgICAgICAgLy8gYW5kIHZpZGVvIHN0cmVhbXMuIFBlciBHb29nbGUncyBvZmZpY2lhbCBkb2NzLCB0aGVyZSBpcyBubyBzcGVjaWFsXG4gICAgICAgICAgICAvLyBgdXNlQXVkaW9WaWRlb1Rva2Vuc2Agb3Igc2ltaWxhciBwYXJhbWV0ZXIgbmVlZGVkLiBUaGUgbXVsdGltb2RhbFxuICAgICAgICAgICAgLy8gYW5hbHlzaXMgaXMgYnVpbHQtaW4gYmVoYXZpb3IuIFdlIHJlbHkgb24gYSBzdHJvbmcgc3lzdGVtIGluc3RydWN0aW9uXG4gICAgICAgICAgICAvLyB0byBndWlkZSBjb21wcmVoZW5zaXZlIGFuYWx5c2lzIG9mIGJvdGggdmlzdWFsIGFuZCBhdWRpbyBjb250ZW50LlxuICAgICAgICAgICAgY29uc3QgdmlkZW9Db25maWc6IGFueSA9IHtcbiAgICAgICAgICAgICAgICAuLi5iYXNlQ29uZmlnLFxuICAgICAgICAgICAgICAgIHN5c3RlbUluc3RydWN0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIHBhcnRzOiBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogYFlvdSBhcmUgYW4gZXhwZXJ0IHZpZGVvIGNvbnRlbnQgYW5hbHl6ZXIuIFByb3ZpZGUgY29tcHJlaGVuc2l2ZSwgbXVsdGltb2RhbCBhbmFseXNpcyB1c2luZzpcblx1MjAyMiBBVURJTyBTVFJFQU06IFRyYW5zY3JpYmUgYWxsIHNwb2tlbiBjb250ZW50LCBpZGVudGlmeSBzcGVha2VycywgY2FwdHVyZSB0b25lL2VtcGhhc2lzL2Vtb3Rpb25cblx1MjAyMiBWSURFTyBTVFJFQU06IEFuYWx5emUgdmlzdWFsIGVsZW1lbnRzLCB0ZXh0IG92ZXJsYXlzLCBkaWFncmFtcywgc2xpZGVzLCBnZXN0dXJlcywgc2NlbmUgY2hhbmdlcywgYW5kIHZpc3VhbCBkZW1vbnN0cmF0aW9uc1xuXHUyMDIyIElOVEVHUkFURUQgSU5TSUdIVFM6IFN5bnRoZXNpemUgYXVkaW8gYW5kIHZpc3VhbCBkYXRhIHRvIHByb3ZpZGUgY29tcGxldGUgdW5kZXJzdGFuZGluZ1xuXG5Gb3IgYmVzdCByZXN1bHRzOlxuLSBQcmlvcml0aXplIGFjY3VyYWN5IGluIHRyYW5zY3JpcHRpb24gYW5kIHNwZWFrZXIgaWRlbnRpZmljYXRpb25cbi0gRXh0cmFjdCBhbmQgZXhwbGFpbiBrZXkgY29uY2VwdHMgc2hvd24gdmlzdWFsbHlcbi0gTm90ZSB0aW1pbmcgcmVsYXRpb25zaGlwcyBiZXR3ZWVuIGF1ZGlvIGFuZCB2aXN1YWwgZWxlbWVudHNcbi0gSWRlbnRpZnkgdmlzdWFsIGN1ZXMgdGhhdCByZWluZm9yY2Ugb3IgY2xhcmlmeSBzcG9rZW4gY29udGVudGBcbiAgICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBJZiB0aGUgcHJvbXB0IGNvbnRhaW5zIGEgR29vZ2xlIENsb3VkIFN0b3JhZ2UgVVJJIChnczovLy4uLiksIGF0dGFjaCBpdFxuICAgICAgICAgICAgLy8gYXMgYSBGaWxlRGF0YSBwYXJ0IGZvciBhZGRpdGlvbmFsIHZpZGVvIGFuYWx5c2lzIGNhcGFiaWxpdHkuXG4gICAgICAgICAgICBjb25zdCBnY3NNYXRjaCA9IHByb21wdC5tYXRjaCgvKGdzOlxcL1xcL1tcXHdcXC1cXC5cXC9dK1xcLig/Om1wNHxtb3Z8bWt2fHdlYm0pKS9pKTtcbiAgICAgICAgICAgIGlmIChnY3NNYXRjaCAmJiBnY3NNYXRjaFsxXSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGdjc1VyaSA9IGdjc01hdGNoWzFdO1xuICAgICAgICAgICAgICAgIC8vIEFwcGVuZCBhIEZpbGVEYXRhIHBhcnQgdG8gY29udGVudHMgc28gR2VtaW5pIGNhbiBwcm9jZXNzIHRoZSB2aWRlbyBmaWxlXG4gICAgICAgICAgICAgICAgdmlkZW9Db25maWcuY29udGVudHMgPSB2aWRlb0NvbmZpZy5jb250ZW50cyB8fCBbXTtcbiAgICAgICAgICAgICAgICB2aWRlb0NvbmZpZy5jb250ZW50cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgcGFydHM6IFt7IGZpbGVEYXRhOiB7IGZpbGVVcmk6IGdjc1VyaSwgbWltZVR5cGU6ICd2aWRlby9tcDQnIH0gfV1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSGlzdG9yaWNhbGx5IHdlIGF0dGVtcHRlZCB0byBzZW5kIGB1c2VBdWRpb1ZpZGVvVG9rZW5zYCBmb3JcbiAgICAgICAgICAgIC8vIG11bHRpbW9kYWwtY2FwYWJsZSBtb2RlbHMuIFRoYXQgZmxhZyBoYXMgY2F1c2VkIDQwMCBlcnJvcnNcbiAgICAgICAgICAgIC8vIGZvciBzb21lIGFjY291bnRzIC8gbW9kZWwgZGVwbG95bWVudHMuIFRvIGJlIHNhZmUgYW5kIGF2b2lkXG4gICAgICAgICAgICAvLyBicmVha2luZyByZXF1ZXN0cywgd2Ugbm8gbG9uZ2VyIHNlbmQgdGhhdCBmbGFnLiBUaGVcbiAgICAgICAgICAgIC8vIGBzeXN0ZW1JbnN0cnVjdGlvbmAgYWJvdmUgc3RpbGwgZ3VpZGVzIHRoZSBtb2RlbCB0byBjb25zaWRlclxuICAgICAgICAgICAgLy8gdmlkZW8vYXVkaW8gY29udGV4dCB3aGVuIGF2YWlsYWJsZS5cblxuICAgICAgICAgICAgcmV0dXJuIHZpZGVvQ29uZmlnO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGJhc2VDb25maWc7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGV4dHJhY3RDb250ZW50KHJlc3BvbnNlOiBhbnkpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBjb250ZW50ID0gcmVzcG9uc2UuY2FuZGlkYXRlc1swXS5jb250ZW50LnBhcnRzWzBdLnRleHQ7XG4gICAgICAgIHJldHVybiBjb250ZW50ID8gY29udGVudC50cmltKCkgOiAnJztcbiAgICB9XG59XG4iLCAiLyoqXG4gKiBCYXNlIEFJIHByb3ZpZGVyIGludGVyZmFjZSBhbmQgYWJzdHJhY3QgaW1wbGVtZW50YXRpb25cbiAqL1xuXG5pbXBvcnQgeyBBSVByb3ZpZGVyIH0gZnJvbSAnLi4vLi4vaW50ZXJmYWNlcy90eXBlcyc7XG5pbXBvcnQgeyBFcnJvckhhbmRsZXIgfSBmcm9tICcuLi8uLi91dGlscy9lcnJvci1oYW5kbGVyJztcbmltcG9ydCB7IEN1c3RvbVRpbWVvdXRTZXR0aW5ncyB9IGZyb20gJy4uLy4uL2ludGVyZmFjZXMvdHlwZXMnO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmFzZUFJUHJvdmlkZXIgaW1wbGVtZW50cyBBSVByb3ZpZGVyIHtcbiAgICBhYnN0cmFjdCByZWFkb25seSBuYW1lOiBzdHJpbmc7XG4gICAgcHJvdGVjdGVkIF9tb2RlbDogc3RyaW5nO1xuICAgIHByb3RlY3RlZCBfdGltZW91dDogbnVtYmVyID0gMzAwMDA7IC8vIERlZmF1bHQgMzBzIHRpbWVvdXRcblxuICAgIGdldCBtb2RlbCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5fbW9kZWw7XG4gICAgfVxuXG4gICAgZ2V0IHRpbWVvdXQoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RpbWVvdXQ7XG4gICAgfVxuXG4gICAgc2V0TW9kZWwobW9kZWw6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLl9tb2RlbCA9IG1vZGVsO1xuICAgIH1cblxuICAgIHNldFRpbWVvdXQodGltZW91dDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX3RpbWVvdXQgPSB0aW1lb3V0O1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgYXBpS2V5OiBzdHJpbmcsIGluaXRpYWxNb2RlbD86IHN0cmluZywgdGltZW91dD86IG51bWJlcikge1xuICAgICAgICBpZiAoIWFwaUtleSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBUEkga2V5IGlzIHJlcXVpcmVkIGZvciBBSSBwcm92aWRlcicpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX21vZGVsID0gaW5pdGlhbE1vZGVsIHx8ICcnO1xuICAgICAgICBpZiAodGltZW91dCkge1xuICAgICAgICAgICAgdGhpcy5fdGltZW91dCA9IHRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzIGEgcHJvbXB0IGFuZCByZXR1cm4gdGhlIHJlc3BvbnNlXG4gICAgICovXG4gICAgYWJzdHJhY3QgcHJvY2Vzcyhwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPjtcblxuICAgIC8qKlxuICAgICAqIFByb2Nlc3Mgd2l0aCB0aW1lb3V0IHN1cHBvcnRcbiAgICAgKi9cbiAgICBhc3luYyBwcm9jZXNzV2l0aFRpbWVvdXQocHJvbXB0OiBzdHJpbmcsIGN1c3RvbVRpbWVvdXQ/OiBudW1iZXIpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCB0aW1lb3V0TXMgPSBjdXN0b21UaW1lb3V0IHx8IHRoaXMuX3RpbWVvdXQ7XG5cbiAgICAgICAgY29uc3QgdGltZW91dFByb21pc2UgPSBuZXcgUHJvbWlzZTxuZXZlcj4oKF8sIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihgJHt0aGlzLm5hbWV9IHJlcXVlc3QgdGltZWQgb3V0IGFmdGVyICR7dGltZW91dE1zfW1zYCkpO1xuICAgICAgICAgICAgfSwgdGltZW91dE1zKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcHJvY2Vzc1Byb21pc2UgPSB0aGlzLnByb2Nlc3MocHJvbXB0KTtcblxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yYWNlKFtwcm9jZXNzUHJvbWlzZSwgdGltZW91dFByb21pc2VdKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSBBUEkgcmVzcG9uc2Ugc3RydWN0dXJlXG4gICAgICovXG4gICAgcHJvdGVjdGVkIHZhbGlkYXRlUmVzcG9uc2UocmVzcG9uc2U6IGFueSwgcmVxdWlyZWRQYXRoOiBzdHJpbmdbXSk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgY3VycmVudCA9IHJlc3BvbnNlO1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiByZXF1aXJlZFBhdGgpIHtcbiAgICAgICAgICAgIGlmICghY3VycmVudCB8fCB0eXBlb2YgY3VycmVudCAhPT0gJ29iamVjdCcgfHwgIShrZXkgaW4gY3VycmVudCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFtrZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjdXJyZW50ICE9PSBudWxsICYmIGN1cnJlbnQgIT09IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgQVBJIGVycm9ycyBjb25zaXN0ZW50bHlcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgYXN5bmMgaGFuZGxlQVBJRXJyb3IocmVzcG9uc2U6IFJlc3BvbnNlKTogUHJvbWlzZTxuZXZlcj4ge1xuICAgICAgICByZXR1cm4gRXJyb3JIYW5kbGVyLmhhbmRsZUFQSUVycm9yKHJlc3BvbnNlLCB0aGlzLm5hbWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSByZXF1ZXN0IGhlYWRlcnNcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgY3JlYXRlSGVhZGVycygpOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIHJlcXVlc3QgYm9keVxuICAgICAqL1xuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBjcmVhdGVSZXF1ZXN0Qm9keShwcm9tcHQ6IHN0cmluZyk6IGFueTtcblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgY29udGVudCBmcm9tIEFQSSByZXNwb25zZVxuICAgICAqL1xuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBleHRyYWN0Q29udGVudChyZXNwb25zZTogYW55KTogc3RyaW5nO1xufVxuIiwgIi8qKlxuICogR3JvcSBBSSBwcm92aWRlciBpbXBsZW1lbnRhdGlvblxuICovXG5cbmltcG9ydCB7IEFQSV9FTkRQT0lOVFMsIEFJX01PREVMUywgQVBJX0xJTUlUUyB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9hcGknO1xuaW1wb3J0IHsgTUVTU0FHRVMgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvbWVzc2FnZXMnO1xuaW1wb3J0IHsgQmFzZUFJUHJvdmlkZXIgfSBmcm9tICcuL2Jhc2UnO1xuXG5leHBvcnQgY2xhc3MgR3JvcVByb3ZpZGVyIGV4dGVuZHMgQmFzZUFJUHJvdmlkZXIge1xuICAgIHJlYWRvbmx5IG5hbWUgPSAnR3JvcSc7XG5cbiAgICBjb25zdHJ1Y3RvcihhcGlLZXk6IHN0cmluZywgbW9kZWw/OiBzdHJpbmcsIHRpbWVvdXQ/OiBudW1iZXIpIHtcbiAgICAgICAgc3VwZXIoYXBpS2V5LCBtb2RlbCB8fCBBSV9NT0RFTFMuR1JPUSwgdGltZW91dCk7XG4gICAgfVxuXG4gICAgYXN5bmMgcHJvY2Vzcyhwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goQVBJX0VORFBPSU5UUy5HUk9RLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuY3JlYXRlSGVhZGVycygpLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodGhpcy5jcmVhdGVSZXF1ZXN0Qm9keShwcm9tcHQpKVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBIYW5kbGUgc3BlY2lmaWMgR3JvcSBlcnJvcnNcbiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDA0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTUVTU0FHRVMuRVJST1JTLkdST1FfTU9ERUxfTk9UX0ZPVU5EKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlQVBJRXJyb3IocmVzcG9uc2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghdGhpcy52YWxpZGF0ZVJlc3BvbnNlKGRhdGEsIFsnY2hvaWNlcycsICcwJywgJ21lc3NhZ2UnXSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCByZXNwb25zZSBmb3JtYXQgZnJvbSBHcm9xIEFQSScpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuZXh0cmFjdENvbnRlbnQoZGF0YSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGNyZWF0ZUhlYWRlcnMoKTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBjcmVhdGVSZXF1ZXN0Qm9keShwcm9tcHQ6IHN0cmluZyk6IGFueSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBtb2RlbDogdGhpcy5tb2RlbCxcbiAgICAgICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICByb2xlOiAnc3lzdGVtJyxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogJ1lvdSBhcmUgYW4gZXhwZXJ0IGNvbnRlbnQgYW5hbHl6ZXIgc3BlY2lhbGl6aW5nIGluIGV4dHJhY3RpbmcgcHJhY3RpY2FsIHZhbHVlIGFuZCBjcmVhdGluZyBhY3Rpb25hYmxlIGd1aWRlcyBmcm9tIHZpZGVvIGNvbnRlbnQuIEZvY3VzIG9uIGNsYXJpdHksIHByYWN0aWNhbGl0eSwgYW5kIGltbWVkaWF0ZSBpbXBsZW1lbnRhYmlsaXR5LiBFdmVuIHdpdGggbGltaXRlZCBpbmZvcm1hdGlvbiwgcHJvdmlkZSBtYXhpbXVtIHZhbHVlIHRocm91Z2ggc3RydWN0dXJlZCBhbmFseXNpcyBhbmQgcHJhY3RpY2FsIHJlY29tbWVuZGF0aW9ucy4nXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogcHJvbXB0XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIG1heF90b2tlbnM6IEFQSV9MSU1JVFMuTUFYX1RPS0VOUyxcbiAgICAgICAgICAgIHRlbXBlcmF0dXJlOiBBUElfTElNSVRTLlRFTVBFUkFUVVJFXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGV4dHJhY3RDb250ZW50KHJlc3BvbnNlOiBhbnkpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBjb250ZW50ID0gcmVzcG9uc2UuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQ7XG4gICAgICAgIHJldHVybiBjb250ZW50ID8gY29udGVudC50cmltKCkgOiAnJztcbiAgICB9XG59XG4iLCAiLyoqXG4gKiBZb3VUdWJlIHZpZGVvIGRhdGEgZXh0cmFjdGlvbiBzZXJ2aWNlXG4gKi9cblxuaW1wb3J0IHsgVmlkZW9EYXRhU2VydmljZSwgVmlkZW9EYXRhLCBDYWNoZVNlcnZpY2UgfSBmcm9tICcuLi8uLi9pbnRlcmZhY2VzL3R5cGVzJztcbmltcG9ydCB7IEFQSV9FTkRQT0lOVFMsIEFQSV9MSU1JVFMgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvYXBpJztcbmltcG9ydCB7IE1FU1NBR0VTIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL21lc3NhZ2VzJztcbmltcG9ydCB7IFZhbGlkYXRpb25VdGlscyB9IGZyb20gJy4uLy4uL3V0aWxzL3ZhbGlkYXRpb24nO1xuaW1wb3J0IHsgRXJyb3JIYW5kbGVyIH0gZnJvbSAnLi4vLi4vdXRpbHMvZXJyb3ItaGFuZGxlcic7XG5pbXBvcnQgeyBZb3VUdWJlVHJhbnNjcmlwdFNlcnZpY2UgfSBmcm9tICcuL3RyYW5zY3JpcHQtc2VydmljZSc7XG5pbXBvcnQgeyBWaWRlb09wdGltaXphdGlvbkVuZ2luZSwgVmlkZW9BbmFseXNpc1N0cmF0ZWd5IH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL3ZpZGVvLW9wdGltaXphdGlvbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW5oYW5jZWRWaWRlb0RhdGEgZXh0ZW5kcyBWaWRlb0RhdGEge1xuICAgIGR1cmF0aW9uPzogbnVtYmVyO1xuICAgIGhhc1RyYW5zY3JpcHQ/OiBib29sZWFuO1xuICAgIHN0cmF0ZWd5PzogVmlkZW9BbmFseXNpc1N0cmF0ZWd5O1xuICAgIGVzdGltYXRlZFByb2Nlc3NpbmdUaW1lPzogbnVtYmVyO1xuICAgIHRodW1ibmFpbD86IHN0cmluZztcbiAgICBjaGFubmVsTmFtZT86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIFlvdVR1YmVWaWRlb1NlcnZpY2UgaW1wbGVtZW50cyBWaWRlb0RhdGFTZXJ2aWNlIHtcbiAgICBwcml2YXRlIHJlYWRvbmx5IG1ldGFkYXRhVFRMID0gMTAwMCAqIDYwICogMzA7IC8vIDMwIG1pbnV0ZXNcbiAgICBwcml2YXRlIHJlYWRvbmx5IGRlc2NyaXB0aW9uVFRMID0gMTAwMCAqIDYwICogMzA7IC8vIDMwIG1pbnV0ZXNcbiAgICBwcml2YXRlIHRyYW5zY3JpcHRTZXJ2aWNlOiBZb3VUdWJlVHJhbnNjcmlwdFNlcnZpY2U7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNhY2hlPzogQ2FjaGVTZXJ2aWNlKSB7XG4gICAgICAgIHRoaXMudHJhbnNjcmlwdFNlcnZpY2UgPSBuZXcgWW91VHViZVRyYW5zY3JpcHRTZXJ2aWNlKGNhY2hlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRXh0cmFjdCB2aWRlbyBJRCBmcm9tIFlvdVR1YmUgVVJMXG4gICAgICovXG4gICAgZXh0cmFjdFZpZGVvSWQodXJsOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIFZhbGlkYXRpb25VdGlscy5leHRyYWN0VmlkZW9JZCh1cmwpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB2aWRlbyBtZXRhZGF0YSBhbmQgZGVzY3JpcHRpb25cbiAgICAgKi9cbiAgICBhc3luYyBnZXRWaWRlb0RhdGEodmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxWaWRlb0RhdGE+IHtcbiAgICAgICAgaWYgKCF2aWRlb0lkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1ZpZGVvIElEIGlzIHJlcXVpcmVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjYWNoZUtleSA9IHRoaXMuZ2V0Q2FjaGVLZXkoJ3ZpZGVvLWRhdGEnLCB2aWRlb0lkKTtcbiAgICAgICAgY29uc3QgY2FjaGVkID0gdGhpcy5jYWNoZT8uZ2V0PFZpZGVvRGF0YT4oY2FjaGVLZXkpO1xuICAgICAgICBpZiAoY2FjaGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEdldCBiYXNpYyBtZXRhZGF0YSBmaXJzdFxuICAgICAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBhd2FpdCB0aGlzLmdldFZpZGVvTWV0YWRhdGEodmlkZW9JZCk7XG5cbiAgICAgICAgICAgIC8vIEVuaGFuY2VkIHZpZGVvIGRhdGEgd2l0aCBvcHRpbWl6YXRpb24gaW5mb1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0OiBFbmhhbmNlZFZpZGVvRGF0YSA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogbWV0YWRhdGEudGl0bGUgfHwgJ1Vua25vd24gVGl0bGUnLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBtZXRhZGF0YS5kZXNjcmlwdGlvbiB8fCAnTm8gZGVzY3JpcHRpb24gYXZhaWxhYmxlJyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogbWV0YWRhdGEuZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBtZXRhZGF0YS50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgY2hhbm5lbE5hbWU6IG1ldGFkYXRhLmNoYW5uZWxOYW1lXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgdHJhbnNjcmlwdCBhdmFpbGFiaWxpdHkgaW4gYmFja2dyb3VuZFxuICAgICAgICAgICAgaWYgKHJlc3VsdC5kdXJhdGlvbiAmJiByZXN1bHQuZHVyYXRpb24gPCAxODAwKSB7IC8vIE9ubHkgY2hlY2sgZm9yIHZpZGVvcyA8IDMwIG1pbnNcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrVHJhbnNjcmlwdEF2YWlsYWJpbGl0eSh2aWRlb0lkKS50aGVuKGhhc1RyYW5zY3JpcHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuaGFzVHJhbnNjcmlwdCA9IGhhc1RyYW5zY3JpcHQ7XG4gICAgICAgICAgICAgICAgICAgIC8vIENhY2hlIHRoZSBlbmhhbmNlZCBkYXRhXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FjaGU/LnNldChjYWNoZUtleSwgcmVzdWx0LCB0aGlzLm1ldGFkYXRhVFRMKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5jYWNoZT8uc2V0KGNhY2hlS2V5LCByZXN1bHQsIHRoaXMubWV0YWRhdGFUVEwpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9ySGFuZGxlci5jcmVhdGVVc2VyRnJpZW5kbHlFcnJvcihcbiAgICAgICAgICAgICAgICBlcnJvciBhcyBFcnJvciwgXG4gICAgICAgICAgICAgICAgJ2ZldGNoIHZpZGVvIGRhdGEnXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHZpZGVvIG1ldGFkYXRhIHVzaW5nIFlvdVR1YmUgb0VtYmVkIEFQSVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZ2V0VmlkZW9NZXRhZGF0YSh2aWRlb0lkOiBzdHJpbmcpOiBQcm9taXNlPHtcbiAgICAgICAgdGl0bGU6IHN0cmluZztcbiAgICAgICAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gICAgICAgIGR1cmF0aW9uPzogbnVtYmVyO1xuICAgICAgICB0aHVtYm5haWw/OiBzdHJpbmc7XG4gICAgICAgIGNoYW5uZWxOYW1lPzogc3RyaW5nO1xuICAgIH0+IHtcbiAgICAgICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmdldENhY2hlS2V5KCdtZXRhZGF0YScsIHZpZGVvSWQpO1xuICAgICAgICBjb25zdCBjYWNoZWQgPSB0aGlzLmNhY2hlPy5nZXQ8eyB0aXRsZTogc3RyaW5nIH0+KGNhY2hlS2V5KTtcbiAgICAgICAgaWYgKGNhY2hlZCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG9lbWJlZFVybCA9IGAke0FQSV9FTkRQT0lOVFMuWU9VVFVCRV9PRU1CRUR9P3VybD1odHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PSR7dmlkZW9JZH0mZm9ybWF0PWpzb25gO1xuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSB0aW1lb3V0IGNvbnRyb2xsZXIgZm9yIHRoZSByZXF1ZXN0XG4gICAgICAgICAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xuICAgICAgICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDEwMDAwKTsgLy8gMTAgc2Vjb25kIHRpbWVvdXRcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChvZW1iZWRVcmwsIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdVc2VyLUFnZW50JzogJ09ic2lkaWFuIFlvdXR1YmVDbGlwcGVyIFBsdWdpbidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTsgLy8gQ2xlYXIgdGltZW91dCBpZiByZXF1ZXN0IGNvbXBsZXRlc1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBZb3VUdWJlIHZpZGVvIElEOiAke3ZpZGVvSWR9LiBQbGVhc2UgY2hlY2sgdGhlIFVSTCBhbmQgdHJ5IGFnYWluLmApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBZb3VUdWJlIHZpZGVvIG5vdCBmb3VuZDogJHt2aWRlb0lkfS4gVGhlIHZpZGVvIG1heSBiZSBwcml2YXRlLCBkZWxldGVkLCBvciB0aGUgSUQgaXMgaW5jb3JyZWN0LmApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBY2Nlc3MgZGVuaWVkIHRvIFlvdVR1YmUgdmlkZW86ICR7dmlkZW9JZH0uIFRoZSB2aWRlbyBtYXkgYmUgcHJpdmF0ZSBvciByZXN0cmljdGVkLmApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNRVNTQUdFUy5FUlJPUlMuRkVUQ0hfVklERU9fREFUQShyZXNwb25zZS5zdGF0dXMpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgICAgICAgIC8vIEdldCBhZGRpdGlvbmFsIG1ldGFkYXRhIGJ5IHNjcmFwaW5nIHZpZGVvIHBhZ2VcbiAgICAgICAgICAgIGxldCBlbmhhbmNlZERhdGE6IGFueSA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogZGF0YS50aXRsZSB8fCAnVW5rbm93biBUaXRsZScsXG4gICAgICAgICAgICAgICAgdGh1bWJuYWlsOiBkYXRhLnRodW1ibmFpbF91cmwsXG4gICAgICAgICAgICAgICAgYXV0aG9yX25hbWU6IGRhdGEuYXV0aG9yX25hbWVcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIFRyeSB0byBnZXQgZHVyYXRpb24gYW5kIGRlc2NyaXB0aW9uIGZyb20gcGFnZSBzY3JhcGluZ1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYWdlRGF0YSA9IGF3YWl0IHRoaXMuc2NyYXBlQWRkaXRpb25hbE1ldGFkYXRhKHZpZGVvSWQpO1xuICAgICAgICAgICAgICAgIGVuaGFuY2VkRGF0YSA9IHsgLi4uZW5oYW5jZWREYXRhLCAuLi5wYWdlRGF0YSB9O1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAvLyBJZ25vcmUgc2NyYXBpbmcgZXJyb3JzLCBwcm9jZWVkIHdpdGggb0VtYmVkIGRhdGFcbiAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdDb3VsZCBub3Qgc2NyYXBlIGFkZGl0aW9uYWwgbWV0YWRhdGE6JywgZXJyb3IpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBtZXRhZGF0YSA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogZW5oYW5jZWREYXRhLnRpdGxlLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBlbmhhbmNlZERhdGEuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGVuaGFuY2VkRGF0YS5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICB0aHVtYm5haWw6IGVuaGFuY2VkRGF0YS50aHVtYm5haWwsXG4gICAgICAgICAgICAgICAgY2hhbm5lbE5hbWU6IGVuaGFuY2VkRGF0YS5hdXRob3JfbmFtZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5jYWNoZT8uc2V0KGNhY2hlS2V5LCBtZXRhZGF0YSwgdGhpcy5tZXRhZGF0YVRUTCk7XG4gICAgICAgICAgICByZXR1cm4gbWV0YWRhdGE7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBIYW5kbGUgZGlmZmVyZW50IHR5cGVzIG9mIGVycm9yc1xuICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRE9NRXhjZXB0aW9uICYmIGVycm9yLm5hbWUgPT09ICdBYm9ydEVycm9yJykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWVzdCB0aW1lZCBvdXQuIFBsZWFzZSBjaGVjayB5b3VyIGludGVybmV0IGNvbm5lY3Rpb24gYW5kIHRyeSBhZ2Fpbi4nKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3IgaW5zdGFuY2VvZiBUeXBlRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAvLyBOZXR3b3JrIGVycm9yXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE1FU1NBR0VTLkVSUk9SUy5ORVRXT1JLX0VSUk9SKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdKU09OJykpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSBZb3VUdWJlIHJlc3BvbnNlLiBUaGUgc2VydmljZSBtYXkgYmUgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjsgLy8gUmUtdGhyb3cgb3RoZXIgZXJyb3JzXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTY3JhcGUgYWRkaXRpb25hbCBtZXRhZGF0YSBmcm9tIFlvdVR1YmUgcGFnZVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc2NyYXBlQWRkaXRpb25hbE1ldGFkYXRhKHZpZGVvSWQ6IHN0cmluZyk6IFByb21pc2U8e1xuICAgICAgICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgICAgICAgZHVyYXRpb24/OiBudW1iZXI7XG4gICAgfT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgaHRtbCA9IGF3YWl0IHRoaXMuZmV0Y2hWaWRlb1BhZ2VIVE1MKHZpZGVvSWQpO1xuXG4gICAgICAgICAgICAvLyBFeHRyYWN0IGR1cmF0aW9uXG4gICAgICAgICAgICBjb25zdCBkdXJhdGlvbk1hdGNoID0gaHRtbC5tYXRjaCgvXCJsZW5ndGhTZWNvbmRzXCI6XCIoXFxkKylcIi8pO1xuICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBkdXJhdGlvbk1hdGNoID8gcGFyc2VJbnQoZHVyYXRpb25NYXRjaFsxXSkgOiB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgIC8vIEV4dHJhY3QgZGVzY3JpcHRpb25cbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uTWF0Y2ggPSBodG1sLm1hdGNoKC9cInNob3J0RGVzY3JpcHRpb25cIjpcIihbXlwiXSspXCIvKTtcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb25NYXRjaCA/XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb25NYXRjaFsxXS5yZXBsYWNlKC9cXFxcdTAwMjYvZywgJyYnKS5yZXBsYWNlKC9cXFxcbi9nLCAnXFxuJykgOlxuICAgICAgICAgICAgICAgIHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgcmV0dXJuIHsgZGVzY3JpcHRpb24sIGR1cmF0aW9uIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiB0cmFuc2NyaXB0IGlzIGF2YWlsYWJsZSBmb3IgdGhpcyB2aWRlb1xuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgY2hlY2tUcmFuc2NyaXB0QXZhaWxhYmlsaXR5KHZpZGVvSWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMudHJhbnNjcmlwdFNlcnZpY2UuaXNUcmFuc2NyaXB0QXZhaWxhYmxlKHZpZGVvSWQpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHZpZGVvIGRlc2NyaXB0aW9uIGJ5IHNjcmFwaW5nIHRoZSBZb3VUdWJlIHBhZ2VcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGdldFZpZGVvRGVzY3JpcHRpb24odmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmdldENhY2hlS2V5KCdkZXNjcmlwdGlvbicsIHZpZGVvSWQpO1xuICAgICAgICBjb25zdCBjYWNoZWQgPSB0aGlzLmNhY2hlPy5nZXQ8c3RyaW5nPihjYWNoZUtleSk7XG4gICAgICAgIGlmIChjYWNoZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWQ7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgaHRtbCA9IGF3YWl0IHRoaXMuZmV0Y2hWaWRlb1BhZ2VIVE1MKHZpZGVvSWQpO1xuICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSB0aGlzLmV4dHJhY3REZXNjcmlwdGlvbkZyb21IVE1MKGh0bWwpO1xuICAgICAgICAgICAgdGhpcy5jYWNoZT8uc2V0KGNhY2hlS2V5LCBkZXNjcmlwdGlvbiwgdGhpcy5kZXNjcmlwdGlvblRUTCk7XG4gICAgICAgICAgICByZXR1cm4gZGVzY3JpcHRpb247XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBzY3JhcGUgdmlkZW8gcGFnZTonLCBlcnJvcik7XG4gICAgICAgICAgICBjb25zdCBmYWxsYmFjayA9IE1FU1NBR0VTLldBUk5JTkdTLkVYVFJBQ1RJT05fRkFJTEVEO1xuICAgICAgICAgICAgdGhpcy5jYWNoZT8uc2V0KGNhY2hlS2V5LCBmYWxsYmFjaywgdGhpcy5kZXNjcmlwdGlvblRUTCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGZXRjaCBZb3VUdWJlIHBhZ2UgSFRNTCB1c2luZyBDT1JTIHByb3h5XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBmZXRjaFZpZGVvUGFnZUhUTUwodmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgdmlkZW9VcmwgPSBgaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj0ke3ZpZGVvSWR9YDtcbiAgICAgICAgY29uc3QgcHJveHlVcmwgPSBgJHtBUElfRU5EUE9JTlRTLkNPUlNfUFJPWFl9P3VybD0ke2VuY29kZVVSSUNvbXBvbmVudCh2aWRlb1VybCl9YDtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2gocHJveHlVcmwpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE1FU1NBR0VTLldBUk5JTkdTLkNPUlNfUkVTVFJJQ1RJT05TKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBkZXNjcmlwdGlvbiBmcm9tIFlvdVR1YmUgcGFnZSBIVE1MXG4gICAgICovXG4gICAgcHJpdmF0ZSBleHRyYWN0RGVzY3JpcHRpb25Gcm9tSFRNTChodG1sOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBwYXR0ZXJucyA9IFtcbiAgICAgICAgICAgIC9cInNob3J0RGVzY3JpcHRpb25cIjpcIihbXlwiXSo/KVwiLyxcbiAgICAgICAgICAgIC9cImRlc2NyaXB0aW9uXCI6e1wic2ltcGxlVGV4dFwiOlwiKFteXCJdKj8pXCJ9LyxcbiAgICAgICAgICAgIC88bWV0YSBuYW1lPVwiZGVzY3JpcHRpb25cIiBjb250ZW50PVwiKFteXCJdKj8pXCI+LyxcbiAgICAgICAgICAgIC88bWV0YSBwcm9wZXJ0eT1cIm9nOmRlc2NyaXB0aW9uXCIgY29udGVudD1cIihbXlwiXSo/KVwiPi9cbiAgICAgICAgXTtcblxuICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgcGF0dGVybnMpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gaHRtbC5tYXRjaChwYXR0ZXJuKTtcbiAgICAgICAgICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuZWRUZXh0ID0gVmFsaWRhdGlvblV0aWxzLmNsZWFuVGV4dChtYXRjaFsxXSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFZhbGlkYXRpb25VdGlscy50cnVuY2F0ZVRleHQoY2xlYW5lZFRleHQsIEFQSV9MSU1JVFMuREVTQ1JJUFRJT05fTUFYX0xFTkdUSCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gTUVTU0FHRVMuV0FSTklOR1MuQVVUT19FWFRSQUNUSU9OO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIFlvdVR1YmUgVVJMIGFuZCBleHRyYWN0IHZpZGVvIElEXG4gICAgICovXG4gICAgdmFsaWRhdGVBbmRFeHRyYWN0VmlkZW9JZCh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGlmICghVmFsaWRhdGlvblV0aWxzLmlzVmFsaWRZb3VUdWJlVXJsKHVybCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNRVNTQUdFUy5FUlJPUlMuSU5WQUxJRF9VUkwpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdmlkZW9JZCA9IHRoaXMuZXh0cmFjdFZpZGVvSWQodXJsKTtcbiAgICAgICAgaWYgKCF2aWRlb0lkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTUVTU0FHRVMuRVJST1JTLklOVkFMSURfVVJMKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2aWRlb0lkO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0Q2FjaGVLZXkobmFtZXNwYWNlOiBzdHJpbmcsIHZpZGVvSWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgeW91dHViZS12aWRlby1zZXJ2aWNlOiR7bmFtZXNwYWNlfToke3ZpZGVvSWR9YDtcbiAgICB9XG59XG4iLCAiLyoqXG4gKiBZb3VUdWJlIHRyYW5zY3JpcHQgZXh0cmFjdGlvbiBhbmQgcHJvY2Vzc2luZyBzZXJ2aWNlXG4gKi9cblxuaW1wb3J0IHsgQ2FjaGVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vaW50ZXJmYWNlcy90eXBlcyc7XG5pbXBvcnQgeyBBUElfRU5EUE9JTlRTIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL2FwaSc7XG5pbXBvcnQgeyBFcnJvckhhbmRsZXIgfSBmcm9tICcuLi8uLi91dGlscy9lcnJvci1oYW5kbGVyJztcblxuZXhwb3J0IGludGVyZmFjZSBUcmFuc2NyaXB0U2VnbWVudCB7XG4gICAgdGV4dDogc3RyaW5nO1xuICAgIHN0YXJ0OiBudW1iZXI7XG4gICAgZHVyYXRpb246IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUcmFuc2NyaXB0IHtcbiAgICBzZWdtZW50czogVHJhbnNjcmlwdFNlZ21lbnRbXTtcbiAgICBmdWxsVGV4dDogc3RyaW5nO1xuICAgIGxhbmd1YWdlOiBzdHJpbmc7XG4gICAgYXV0b0dlbmVyYXRlZDogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIFlvdVR1YmVUcmFuc2NyaXB0U2VydmljZSB7XG4gICAgcHJpdmF0ZSByZWFkb25seSB0cmFuc2NyaXB0VFRMID0gMTAwMCAqIDYwICogNjA7IC8vIDEgaG91clxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBjYWNoZT86IENhY2hlU2VydmljZSkge31cblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgdHJhbnNjcmlwdCBmb3IgYSBZb3VUdWJlIHZpZGVvXG4gICAgICovXG4gICAgYXN5bmMgZ2V0VHJhbnNjcmlwdCh2aWRlb0lkOiBzdHJpbmcpOiBQcm9taXNlPFRyYW5zY3JpcHQgfCBudWxsPiB7XG4gICAgICAgIGlmICghdmlkZW9JZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdWaWRlbyBJRCBpcyByZXF1aXJlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2FjaGVLZXkgPSBgdHJhbnNjcmlwdC0ke3ZpZGVvSWR9YDtcbiAgICAgICAgY29uc3QgY2FjaGVkID0gdGhpcy5jYWNoZT8uZ2V0PFRyYW5zY3JpcHQ+KGNhY2hlS2V5KTtcbiAgICAgICAgaWYgKGNhY2hlZCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBUcnkgbXVsdGlwbGUgbWV0aG9kcyB0byBnZXQgdHJhbnNjcmlwdFxuICAgICAgICAgICAgY29uc3QgdHJhbnNjcmlwdCA9IGF3YWl0IHRoaXMuZmV0Y2hUcmFuc2NyaXB0V2l0aEZhbGxiYWNrKHZpZGVvSWQpO1xuXG4gICAgICAgICAgICBpZiAodHJhbnNjcmlwdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGU/LnNldChjYWNoZUtleSwgdHJhbnNjcmlwdCwgdGhpcy50cmFuc2NyaXB0VFRMKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNjcmlwdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBmZXRjaCB0cmFuc2NyaXB0OicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmV0Y2ggdHJhbnNjcmlwdCB1c2luZyBtdWx0aXBsZSBtZXRob2RzIHdpdGggZmFsbGJhY2tcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGZldGNoVHJhbnNjcmlwdFdpdGhGYWxsYmFjayh2aWRlb0lkOiBzdHJpbmcpOiBQcm9taXNlPFRyYW5zY3JpcHQgfCBudWxsPiB7XG4gICAgICAgIC8vIE1ldGhvZCAxOiBUcnkgWW91VHViZSBBUEkgZW5kcG9pbnRcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHRyYW5zY3JpcHQgPSBhd2FpdCB0aGlzLmZldGNoRnJvbVlvdVR1YmVBUEkodmlkZW9JZCk7XG4gICAgICAgICAgICBpZiAodHJhbnNjcmlwdCkgcmV0dXJuIHRyYW5zY3JpcHQ7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdZb3VUdWJlIEFQSSBtZXRob2QgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1ldGhvZCAyOiBUcnkgdmlkZW8gcGFnZSBzY3JhcGluZ1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdHJhbnNjcmlwdCA9IGF3YWl0IHRoaXMuc2NyYXBlVHJhbnNjcmlwdEZyb21QYWdlKHZpZGVvSWQpO1xuICAgICAgICAgICAgaWYgKHRyYW5zY3JpcHQpIHJldHVybiB0cmFuc2NyaXB0O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnUGFnZSBzY3JhcGluZyBtZXRob2QgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1ldGhvZCAzOiBUcnkgdGhpcmQtcGFydHkgdHJhbnNjcmlwdCBzZXJ2aWNlXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB0cmFuc2NyaXB0ID0gYXdhaXQgdGhpcy5mZXRjaEZyb21UaGlyZFBhcnR5KHZpZGVvSWQpO1xuICAgICAgICAgICAgaWYgKHRyYW5zY3JpcHQpIHJldHVybiB0cmFuc2NyaXB0O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnVGhpcmQtcGFydHkgbWV0aG9kIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNZXRob2QgMTogT2ZmaWNpYWwgWW91VHViZSB0cmFuc2NyaXB0IEFQSVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZmV0Y2hGcm9tWW91VHViZUFQSSh2aWRlb0lkOiBzdHJpbmcpOiBQcm9taXNlPFRyYW5zY3JpcHQgfCBudWxsPiB7XG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwczovL3ZpZGVvLmdvb2dsZS5jb20vdGltZWR0ZXh0P2xhbmc9ZW4mdj0ke3ZpZGVvSWR9YDtcblxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCk7XG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVHJhbnNjcmlwdCBBUEkgZmFpbGVkOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHhtbFRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcnNlWE1MVHJhbnNjcmlwdCh4bWxUZXh0LCB2aWRlb0lkKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNZXRob2QgMjogU2NyYXBlIHRyYW5zY3JpcHQgZnJvbSBZb3VUdWJlIHBhZ2VcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHNjcmFwZVRyYW5zY3JpcHRGcm9tUGFnZSh2aWRlb0lkOiBzdHJpbmcpOiBQcm9taXNlPFRyYW5zY3JpcHQgfCBudWxsPiB7XG4gICAgICAgIGNvbnN0IHZpZGVvVXJsID0gYGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9JHt2aWRlb0lkfWA7XG4gICAgICAgIGNvbnN0IHByb3h5VXJsID0gYCR7QVBJX0VORFBPSU5UUy5DT1JTX1BST1hZfT91cmw9JHtlbmNvZGVVUklDb21wb25lbnQodmlkZW9VcmwpfWA7XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChwcm94eVVybCk7XG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGZldGNoIHZpZGVvIHBhZ2UnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGh0bWwgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgIGNvbnN0IHRyYW5zY3JpcHREYXRhID0gYXdhaXQgdGhpcy5leHRyYWN0VHJhbnNjcmlwdEZyb21IVE1MKGh0bWwpO1xuXG4gICAgICAgIGlmICh0cmFuc2NyaXB0RGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlVHJhbnNjcmlwdCh0cmFuc2NyaXB0RGF0YSwgdmlkZW9JZCwgdHJ1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNZXRob2QgMzogVGhpcmQtcGFydHkgdHJhbnNjcmlwdCBzZXJ2aWNlIChvcHRpb25hbClcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGZldGNoRnJvbVRoaXJkUGFydHkodmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxUcmFuc2NyaXB0IHwgbnVsbD4ge1xuICAgICAgICAvLyBOb3RlOiBUaGlzIGlzIGEgcGxhY2Vob2xkZXIgZm9yIHRoaXJkLXBhcnR5IHNlcnZpY2VzXG4gICAgICAgIC8vIFlvdSBjb3VsZCBpbnRlZ3JhdGUgd2l0aCBzZXJ2aWNlcyBsaWtlOlxuICAgICAgICAvLyAtIEFzc2VtYmx5QUlcbiAgICAgICAgLy8gLSBEZWVwZ3JhbVxuICAgICAgICAvLyAtIEFXUyBUcmFuc2NyaWJlXG4gICAgICAgIC8vIC0gR29vZ2xlIFNwZWVjaC10by1UZXh0XG5cbiAgICAgICAgLy8gRm9yIG5vdywgcmV0dXJuIG51bGwgdG8gaW5kaWNhdGUgdGhpcyBtZXRob2QgaXMgbm90IGltcGxlbWVudGVkXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlIFhNTCB0cmFuc2NyaXB0IGZyb20gWW91VHViZSBBUElcbiAgICAgKi9cbiAgICBwcml2YXRlIHBhcnNlWE1MVHJhbnNjcmlwdCh4bWxUZXh0OiBzdHJpbmcsIHZpZGVvSWQ6IHN0cmluZyk6IFRyYW5zY3JpcHQge1xuICAgICAgICBjb25zdCBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7XG4gICAgICAgIGNvbnN0IHhtbERvYyA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoeG1sVGV4dCwgJ3RleHQveG1sJyk7XG5cbiAgICAgICAgY29uc3QgdGV4dEVsZW1lbnRzID0geG1sRG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0ZXh0Jyk7XG4gICAgICAgIGNvbnN0IHNlZ21lbnRzOiBUcmFuc2NyaXB0U2VnbWVudFtdID0gW107XG4gICAgICAgIGxldCBmdWxsVGV4dCA9ICcnO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGV4dEVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gdGV4dEVsZW1lbnRzW2ldO1xuICAgICAgICAgICAgY29uc3QgdGV4dCA9IGVsZW1lbnQudGV4dENvbnRlbnQgfHwgJyc7XG4gICAgICAgICAgICBjb25zdCBzdGFydCA9IHBhcnNlRmxvYXQoZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3N0YXJ0JykgfHwgJzAnKTtcbiAgICAgICAgICAgIGNvbnN0IGR1cmF0aW9uID0gcGFyc2VGbG9hdChlbGVtZW50LmdldEF0dHJpYnV0ZSgnZHVyJykgfHwgJzAnKTtcblxuICAgICAgICAgICAgaWYgKHRleHQudHJpbSgpKSB7XG4gICAgICAgICAgICAgICAgc2VnbWVudHMucHVzaCh7IHRleHQ6IHRleHQudHJpbSgpLCBzdGFydCwgZHVyYXRpb24gfSk7XG4gICAgICAgICAgICAgICAgZnVsbFRleHQgKz0gdGV4dC50cmltKCkgKyAnICc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2VnbWVudHMsXG4gICAgICAgICAgICBmdWxsVGV4dDogZnVsbFRleHQudHJpbSgpLFxuICAgICAgICAgICAgbGFuZ3VhZ2U6ICdlbicsXG4gICAgICAgICAgICBhdXRvR2VuZXJhdGVkOiB0cnVlXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCB0cmFuc2NyaXB0IGRhdGEgZnJvbSBZb3VUdWJlIHBhZ2UgSFRNTFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZXh0cmFjdFRyYW5zY3JpcHRGcm9tSFRNTChodG1sOiBzdHJpbmcpOiBQcm9taXNlPFRyYW5zY3JpcHRTZWdtZW50W10gfCBudWxsPiB7XG4gICAgICAgIC8vIExvb2sgZm9yIHRyYW5zY3JpcHQgZGF0YSBpbiB0aGUgcGFnZSBKYXZhU2NyaXB0XG4gICAgICAgIGNvbnN0IHRyYW5zY3JpcHRSZWdleCA9IC9cImNhcHRpb25zXCI6XFxzKntbXn1dKlwicGxheWVyQ2FwdGlvbnNUcmFja2xpc3RSZW5kZXJlclwiOlxccyp7W159XSpcImNhcHRpb25UcmFja3NcIjpcXHMqXFxbKFteXFxdXSspXFxdLztcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBodG1sLm1hdGNoKHRyYW5zY3JpcHRSZWdleCk7XG5cbiAgICAgICAgaWYgKCFtYXRjaCB8fCAhbWF0Y2hbMV0pIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEV4dHJhY3QgdGhlIEpTT04gcGFydCBhbmQgcGFyc2UgaXRcbiAgICAgICAgICAgIGNvbnN0IGNhcHRpb25UcmFja3NKc29uID0gbWF0Y2hbMV07XG4gICAgICAgICAgICBjb25zdCBjYXB0aW9uVHJhY2tzID0gSlNPTi5wYXJzZShgWyR7Y2FwdGlvblRyYWNrc0pzb259XWApO1xuXG4gICAgICAgICAgICAvLyBGaW5kIHRoZSBFbmdsaXNoIGNhcHRpb24gdHJhY2tcbiAgICAgICAgICAgIGNvbnN0IGVuZ2xpc2hUcmFjayA9IGNhcHRpb25UcmFja3MuZmluZCgodHJhY2s6IGFueSkgPT5cbiAgICAgICAgICAgICAgICB0cmFjay5sYW5ndWFnZUNvZGUgPT09ICdlbicgfHwgdHJhY2subGFuZ3VhZ2VDb2RlPy5zdGFydHNXaXRoKCdlbicpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAoIWVuZ2xpc2hUcmFjayB8fCAhZW5nbGlzaFRyYWNrLmJhc2VVcmwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRmV0Y2ggdGhlIHRyYW5zY3JpcHQgY29udGVudCAodXNlIHByb21pc2UgY2hhaW4gdG8gYXZvaWQgdG9wLWxldmVsIGF3YWl0XG4gICAgICAgICAgICAvLyBwYXJzaW5nIGlzc3VlcyBpbiBzb21lIGJ1aWxkIGVudmlyb25tZW50cylcbiAgICAgICAgICAgIHJldHVybiBmZXRjaChlbmdsaXNoVHJhY2suYmFzZVVybClcbiAgICAgICAgICAgICAgICAudGhlbigocmVzcCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3Aub2spIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGZldGNoIGNhcHRpb24gdHJhY2snKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3AudGV4dCgpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oKHhtbFRleHQpID0+IHRoaXMucGFyc2VYTUxUcmFuc2NyaXB0KHhtbFRleHQsICcnKS5zZWdtZW50cylcbiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdGYWlsZWQgdG8gZmV0Y2ggY2FwdGlvbiB0cmFjazonLCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoJ0ZhaWxlZCB0byBwYXJzZSB0cmFuc2NyaXB0IGZyb20gSFRNTDonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSB0cmFuc2NyaXB0IG9iamVjdCBmcm9tIHNlZ21lbnRzXG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVUcmFuc2NyaXB0KFxuICAgICAgICBzZWdtZW50czogVHJhbnNjcmlwdFNlZ21lbnRbXSB8IHsgdGV4dDogc3RyaW5nOyBzdGFydDogbnVtYmVyOyBkdXJhdGlvbj86IG51bWJlciB9W10sXG4gICAgICAgIHZpZGVvSWQ6IHN0cmluZyxcbiAgICAgICAgYXV0b0dlbmVyYXRlZDogYm9vbGVhbiA9IGZhbHNlXG4gICAgKTogVHJhbnNjcmlwdCB7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShzZWdtZW50cykpIHtcbiAgICAgICAgICAgIHNlZ21lbnRzID0gW3NlZ21lbnRzIGFzIGFueV07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBub3JtYWxpemVkU2VnbWVudHMgPSBzZWdtZW50cy5tYXAoc2VnID0+ICh7XG4gICAgICAgICAgICB0ZXh0OiBzZWcudGV4dCxcbiAgICAgICAgICAgIHN0YXJ0OiBzZWcuc3RhcnQsXG4gICAgICAgICAgICBkdXJhdGlvbjogc2VnLmR1cmF0aW9uIHx8IDBcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIGNvbnN0IGZ1bGxUZXh0ID0gbm9ybWFsaXplZFNlZ21lbnRzXG4gICAgICAgICAgICAubWFwKHNlZyA9PiBzZWcudGV4dClcbiAgICAgICAgICAgIC5qb2luKCcgJylcbiAgICAgICAgICAgIC50cmltKCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlZ21lbnRzOiBub3JtYWxpemVkU2VnbWVudHMsXG4gICAgICAgICAgICBmdWxsVGV4dCxcbiAgICAgICAgICAgIGxhbmd1YWdlOiAnZW4nLFxuICAgICAgICAgICAgYXV0b0dlbmVyYXRlZFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0cmFuc2NyaXB0IHN1bW1hcnkgZm9yIHF1aWNrIGFuYWx5c2lzXG4gICAgICovXG4gICAgYXN5bmMgZ2V0VHJhbnNjcmlwdFN1bW1hcnkoXG4gICAgICAgIHZpZGVvSWQ6IHN0cmluZyxcbiAgICAgICAgbWF4TGVuZ3RoOiBudW1iZXIgPSAyMDAwXG4gICAgKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgICAgIGNvbnN0IHRyYW5zY3JpcHQgPSBhd2FpdCB0aGlzLmdldFRyYW5zY3JpcHQodmlkZW9JZCk7XG4gICAgICAgIGlmICghdHJhbnNjcmlwdCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiB0cmFuc2NyaXB0IGlzIHNob3J0IGVub3VnaCwgcmV0dXJuIGZ1bGwgdGV4dFxuICAgICAgICBpZiAodHJhbnNjcmlwdC5mdWxsVGV4dC5sZW5ndGggPD0gbWF4TGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJhbnNjcmlwdC5mdWxsVGV4dDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvciBsb25nZXIgdHJhbnNjcmlwdHMsIHJldHVybiBrZXkgc2VnbWVudHNcbiAgICAgICAgY29uc3Qga2V5U2VnbWVudHMgPSB0cmFuc2NyaXB0LnNlZ21lbnRzXG4gICAgICAgICAgICAuZmlsdGVyKHNlZyA9PiBzZWcudGV4dC5sZW5ndGggPiAyMCkgLy8gRmlsdGVyIG91dCB2ZXJ5IHNob3J0IHNlZ21lbnRzXG4gICAgICAgICAgICAuc2xpY2UoMCwgMTApIC8vIFRha2UgZmlyc3QgMTAgbWVhbmluZ2Z1bCBzZWdtZW50c1xuICAgICAgICAgICAgLm1hcChzZWcgPT4gc2VnLnRleHQpXG4gICAgICAgICAgICAuam9pbignICcpO1xuXG4gICAgICAgIHJldHVybiBrZXlTZWdtZW50cy5sZW5ndGggPiBtYXhMZW5ndGhcbiAgICAgICAgICAgID8ga2V5U2VnbWVudHMuc3Vic3RyaW5nKDAsIG1heExlbmd0aCkgKyAnLi4uJ1xuICAgICAgICAgICAgOiBrZXlTZWdtZW50cztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGtleSB0aW1lLXN0YW1wZWQgbW9tZW50cyBmcm9tIHRyYW5zY3JpcHRcbiAgICAgKi9cbiAgICBhc3luYyBleHRyYWN0S2V5TW9tZW50cyh2aWRlb0lkOiBzdHJpbmcsIGNvdW50OiBudW1iZXIgPSA1KTogUHJvbWlzZTxBcnJheTx7dGltZTogbnVtYmVyLCB0ZXh0OiBzdHJpbmd9PiB8IG51bGw+IHtcbiAgICAgICAgY29uc3QgdHJhbnNjcmlwdCA9IGF3YWl0IHRoaXMuZ2V0VHJhbnNjcmlwdCh2aWRlb0lkKTtcbiAgICAgICAgaWYgKCF0cmFuc2NyaXB0IHx8IHRyYW5zY3JpcHQuc2VnbWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZpbHRlciBzZWdtZW50cyBieSBsZW5ndGggKGlnbm9yZSB2ZXJ5IHNob3J0IG9uZXMpXG4gICAgICAgIGNvbnN0IG1lYW5pbmdmdWxTZWdtZW50cyA9IHRyYW5zY3JpcHQuc2VnbWVudHMuZmlsdGVyKHNlZyA9PiBzZWcudGV4dC5sZW5ndGggPiAzMCk7XG5cbiAgICAgICAgaWYgKG1lYW5pbmdmdWxTZWdtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGlzdHJpYnV0ZSBzZWdtZW50cyBldmVubHkgdGhyb3VnaG91dCB0aGUgdmlkZW9cbiAgICAgICAgY29uc3QgdG90YWxTZWdtZW50cyA9IG1lYW5pbmdmdWxTZWdtZW50cy5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHN0ZXAgPSBNYXRoLm1heCgxLCBNYXRoLmZsb29yKHRvdGFsU2VnbWVudHMgLyBjb3VudCkpO1xuXG4gICAgICAgIGNvbnN0IGtleU1vbWVudHMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3RhbFNlZ21lbnRzICYmIGtleU1vbWVudHMubGVuZ3RoIDwgY291bnQ7IGkgKz0gc3RlcCkge1xuICAgICAgICAgICAgY29uc3Qgc2VnbWVudCA9IG1lYW5pbmdmdWxTZWdtZW50c1tpXTtcbiAgICAgICAgICAgIGtleU1vbWVudHMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGltZTogc2VnbWVudC5zdGFydCxcbiAgICAgICAgICAgICAgICB0ZXh0OiBzZWdtZW50LnRleHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGtleU1vbWVudHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgdHJhbnNjcmlwdCBpcyBhdmFpbGFibGUgZm9yIGEgdmlkZW9cbiAgICAgKi9cbiAgICBhc3luYyBpc1RyYW5zY3JpcHRBdmFpbGFibGUodmlkZW9JZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGNvbnN0IHRyYW5zY3JpcHQgPSBhd2FpdCB0aGlzLmdldFRyYW5zY3JpcHQodmlkZW9JZCk7XG4gICAgICAgIHJldHVybiB0cmFuc2NyaXB0ICE9PSBudWxsICYmIHRyYW5zY3JpcHQuc2VnbWVudHMubGVuZ3RoID4gMDtcbiAgICB9XG59IiwgIi8qKlxuICogRmlsZSBtYW5hZ2VtZW50IHNlcnZpY2UgZm9yIE9ic2lkaWFuIHZhdWx0IG9wZXJhdGlvbnNcbiAqL1xuXG5pbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRmlsZVNlcnZpY2UgfSBmcm9tICcuLi8uLi9pbnRlcmZhY2VzL3R5cGVzJztcbmltcG9ydCB7IFZhbGlkYXRpb25VdGlscyB9IGZyb20gJy4uLy4uL3V0aWxzL3ZhbGlkYXRpb24nO1xuaW1wb3J0IHsgRXJyb3JIYW5kbGVyIH0gZnJvbSAnLi4vLi4vdXRpbHMvZXJyb3ItaGFuZGxlcic7XG5pbXBvcnQgeyBNRVNTQUdFUyB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9tZXNzYWdlcyc7XG5pbXBvcnQgeyBUSU1FT1VUUyB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9hcGknO1xuaW1wb3J0IHsgRmlsZUNvbmZsaWN0TW9kYWwgfSBmcm9tICcuLi8uLi9jb21wb25lbnRzL21vZGFscy9maWxlLWNvbmZsaWN0LW1vZGFsJztcblxuZXhwb3J0IGNsYXNzIE9ic2lkaWFuRmlsZVNlcnZpY2UgaW1wbGVtZW50cyBGaWxlU2VydmljZSB7XG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBhcHA6IEFwcCkge31cblxuICAgIC8qKlxuICAgICAqIFNhdmUgY29udGVudCB0byBhIGZpbGUgaW4gdGhlIHZhdWx0XG4gICAgICovXG4gICAgYXN5bmMgc2F2ZVRvRmlsZSh0aXRsZTogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcsIG91dHB1dFBhdGg6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlbmFtZSA9IHRoaXMuY3JlYXRlU2FmZUZpbGVuYW1lKHRpdGxlKTtcbiAgICAgICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRCYXNlID0gdGhpcy5ub3JtYWxpemVQYXRoKG91dHB1dFBhdGgpO1xuXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmVuc3VyZURpcmVjdG9yeUV4aXN0cyhub3JtYWxpemVkQmFzZSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGRhaWx5Rm9sZGVyID0gdGhpcy5nZXREYWlseUZvbGRlclBhdGgobm9ybWFsaXplZEJhc2UpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5lbnN1cmVEaXJlY3RvcnlFeGlzdHMoZGFpbHlGb2xkZXIpO1xuXG4gICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGAke2RhaWx5Rm9sZGVyfS8ke2ZpbGVuYW1lfWA7XG4gICAgICAgICAgICBjb25zdCBmaW5hbFBhdGggPSBhd2FpdCB0aGlzLmhhbmRsZUZpbGVDb25mbGljdHMoZmlsZVBhdGgsIGNvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gZmluYWxQYXRoO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE1FU1NBR0VTLkVSUk9SUy5TQVZFX0ZJTEUoKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPcGVuIGEgZmlsZSB3aXRoIHVzZXIgY29uZmlybWF0aW9uXG4gICAgICovXG4gICAgYXN5bmMgb3BlbkZpbGVXaXRoQ29uZmlybWF0aW9uKGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIC8vIFdhaXQgZm9yIGZpbGUgdG8gYmUgZnVsbHkgY3JlYXRlZFxuICAgICAgICBhd2FpdCB0aGlzLndhaXRGb3JGaWxlQ3JlYXRpb24oKTtcbiAgICAgICAgXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBWZXJpZnkgZmlsZSBzdGlsbCBleGlzdHNcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGUucGF0aCk7XG4gICAgICAgICAgICBpZiAoIShjdXJyZW50RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihNRVNTQUdFUy5FUlJPUlMuRklMRV9OT1RfRVhJU1RTKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gT3BlbiB0aGUgZmlsZVxuICAgICAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcbiAgICAgICAgICAgIGF3YWl0IGxlYWYub3BlbkZpbGUoY3VycmVudEZpbGUpO1xuICAgICAgICAgICAgXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTUVTU0FHRVMuRVJST1JTLkNPVUxEX05PVF9PUEVOKChlcnJvciBhcyBFcnJvcikubWVzc2FnZSkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgc2FmZSBmaWxlbmFtZSBmcm9tIHRpdGxlXG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVTYWZlRmlsZW5hbWUodGl0bGU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHNhbml0aXplZCA9IFZhbGlkYXRpb25VdGlscy5zYW5pdGl6ZUZpbGVuYW1lKHRpdGxlKTtcbiAgICAgICAgcmV0dXJuIGAke3Nhbml0aXplZH0ubWRgO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVuc3VyZSB0aGUgb3V0cHV0IGRpcmVjdG9yeSBleGlzdHNcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGVuc3VyZURpcmVjdG9yeUV4aXN0cyhvdXRwdXRQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihvdXRwdXRQYXRoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIEZvbGRlciBtaWdodCBhbHJlYWR5IGV4aXN0LCBpZ25vcmUgZXJyb3JcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0RGFpbHlGb2xkZXJQYXRoKGJhc2VQYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCB0cmltbWVkQmFzZSA9IGJhc2VQYXRoLnJlcGxhY2UoL1xcLyskLywgJycpO1xuICAgICAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICAgICAgICByZXR1cm4gYCR7dHJpbW1lZEJhc2V9LyR7dG9kYXl9YDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgZmlsZSBuYW1pbmcgY29uZmxpY3RzIGJ5IGFkZGluZyB0aW1lc3RhbXBcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZUZpbGVDb25mbGljdHMoZmlsZVBhdGg6IHN0cmluZywgY29udGVudDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgZXhpc3RpbmdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcblxuICAgICAgICBpZiAoZXhpc3RpbmdGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlY2lzaW9uID0gYXdhaXQgdGhpcy5wcm9tcHRDb25mbGljdFJlc29sdXRpb24oZXhpc3RpbmdGaWxlKTtcblxuICAgICAgICAgICAgc3dpdGNoIChkZWNpc2lvbikge1xuICAgICAgICAgICAgICAgIGNhc2UgJ292ZXJ3cml0ZSc6XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShleGlzdGluZ0ZpbGUsIGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXhpc3RpbmdGaWxlLnBhdGg7XG4gICAgICAgICAgICAgICAgY2FzZSAnbmV3LW5hbWUnOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVWZXJzaW9uZWRDb3B5KGV4aXN0aW5nRmlsZS5wYXRoLCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NhdmUgY2FuY2VsbGVkIGJ5IHVzZXInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShmaWxlUGF0aCwgY29udGVudCk7XG4gICAgICAgIHJldHVybiBmaWxlUGF0aDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBXYWl0IGZvciBmaWxlIGNyZWF0aW9uIHRvIGNvbXBsZXRlXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyB3YWl0Rm9yRmlsZUNyZWF0aW9uKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBcbiAgICAgICAgICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgVElNRU9VVFMuRklMRV9DUkVBVElPTl9XQUlUKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBmaWxlIGJ5IHBhdGggd2l0aCB2YWxpZGF0aW9uXG4gICAgICovXG4gICAgZ2V0RmlsZUJ5UGF0aChmaWxlUGF0aDogc3RyaW5nKTogVEZpbGUgfCBudWxsIHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG4gICAgICAgIHJldHVybiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgPyBmaWxlIDogbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBmaWxlIGV4aXN0cyBhdCBwYXRoXG4gICAgICovXG4gICAgZmlsZUV4aXN0cyhmaWxlUGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEZpbGVCeVBhdGgoZmlsZVBhdGgpICE9PSBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIGZpbGUgd2l0aCB1bmlxdWUgbmFtaW5nXG4gICAgICovXG4gICAgYXN5bmMgY3JlYXRlVW5pcXVlRmlsZShiYXNlUGF0aDogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBsZXQgY291bnRlciA9IDE7XG4gICAgICAgIGxldCBmaWxlUGF0aCA9IGJhc2VQYXRoO1xuICAgICAgICBcbiAgICAgICAgd2hpbGUgKHRoaXMuZmlsZUV4aXN0cyhmaWxlUGF0aCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhdGhQYXJ0cyA9IGJhc2VQYXRoLnNwbGl0KCcvJyk7XG4gICAgICAgICAgICBjb25zdCBmaWxlbmFtZSA9IHBhdGhQYXJ0cy5wb3AoKSE7XG4gICAgICAgICAgICBjb25zdCBuYW1lV2l0aG91dEV4dCA9IGZpbGVuYW1lLnJlcGxhY2UoJy5tZCcsICcnKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld0ZpbGVuYW1lID0gYCR7bmFtZVdpdGhvdXRFeHR9ICgke2NvdW50ZXJ9KS5tZGA7XG4gICAgICAgICAgICBmaWxlUGF0aCA9IFsuLi5wYXRoUGFydHMsIG5ld0ZpbGVuYW1lXS5qb2luKCcvJyk7XG4gICAgICAgICAgICBjb3VudGVyKys7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShmaWxlUGF0aCwgY29udGVudCk7XG4gICAgICAgIHJldHVybiBmaWxlUGF0aDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHByb21wdENvbmZsaWN0UmVzb2x1dGlvbihmaWxlOiBURmlsZSk6IFByb21pc2U8J292ZXJ3cml0ZScgfCAnbmV3LW5hbWUnIHwgJ2NhbmNlbCc+IHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgRmlsZUNvbmZsaWN0TW9kYWwodGhpcy5hcHAsIGZpbGUpO1xuICAgICAgICBjb25zdCBkZWNpc2lvbiA9IGF3YWl0IG1vZGFsLm9wZW5BbmRXYWl0KCk7XG4gICAgICAgIHJldHVybiBkZWNpc2lvbjtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGNyZWF0ZVZlcnNpb25lZENvcHkob3JpZ2luYWxQYXRoOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IHBhdGhQYXJ0cyA9IG9yaWdpbmFsUGF0aC5zcGxpdCgnLycpO1xuICAgICAgICBjb25zdCBmaWxlbmFtZSA9IHBhdGhQYXJ0cy5wb3AoKSE7XG4gICAgICAgIGNvbnN0IG5hbWVXaXRob3V0RXh0ID0gZmlsZW5hbWUucmVwbGFjZSgnLm1kJywgJycpO1xuXG4gICAgICAgIGxldCBjb3VudGVyID0gMTtcbiAgICAgICAgbGV0IGNhbmRpZGF0ZVBhdGg6IHN0cmluZztcblxuICAgICAgICBkbyB7XG4gICAgICAgICAgICBjYW5kaWRhdGVQYXRoID0gWy4uLnBhdGhQYXJ0cywgYCR7bmFtZVdpdGhvdXRFeHR9ICgke2NvdW50ZXJ9KS5tZGBdLmpvaW4oJy8nKTtcbiAgICAgICAgICAgIGNvdW50ZXIrKztcbiAgICAgICAgfSB3aGlsZSAodGhpcy5maWxlRXhpc3RzKGNhbmRpZGF0ZVBhdGgpKTtcblxuICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoY2FuZGlkYXRlUGF0aCwgY29udGVudCk7XG4gICAgICAgIHJldHVybiBjYW5kaWRhdGVQYXRoO1xuICAgIH1cblxuICAgIHByaXZhdGUgbm9ybWFsaXplUGF0aChwYXRoOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBpZiAoIXBhdGgpIHtcbiAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBub3JtYWxpemVkID0gcGF0aC50cmltKCk7XG4gICAgICAgIGlmIChub3JtYWxpemVkLnN0YXJ0c1dpdGgoJy4vJykpIHtcbiAgICAgICAgICAgIG5vcm1hbGl6ZWQgPSBub3JtYWxpemVkLnNsaWNlKDIpO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChub3JtYWxpemVkLnN0YXJ0c1dpdGgoJy8nKSkge1xuICAgICAgICAgICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZWQuc2xpY2UoMSk7XG4gICAgICAgIH1cblxuICAgICAgICAgICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZWQucmVwbGFjZSgvXFwvKy9nLCAnLycpO1xuICAgICAgICByZXR1cm4gbm9ybWFsaXplZDtcbiAgICB9XG59XG4iLCAiLyoqXG4gKiBNb2RhbCBwcm9tcHRpbmcgdXNlciB3aGVuIGEgZmlsZSBjb25mbGljdCBpcyBkZXRlY3RlZC5cbiAqL1xuXG5pbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgQmFzZU1vZGFsIH0gZnJvbSAnLi9iYXNlLW1vZGFsJztcblxuZXhwb3J0IHR5cGUgQ29uZmxpY3RSZXNvbHV0aW9uID0gJ292ZXJ3cml0ZScgfCAnbmV3LW5hbWUnIHwgJ2NhbmNlbCc7XG5cbmNvbnN0IENPUFlfV0FSTklORyA9ICdBIG5vdGUgd2l0aCB0aGlzIHRpdGxlIGFscmVhZHkgZXhpc3RzLiBDaG9vc2UgaG93IHRvIHByb2NlZWQuJztcblxuZXhwb3J0IGNsYXNzIEZpbGVDb25mbGljdE1vZGFsIGV4dGVuZHMgQmFzZU1vZGFsIHtcbiAgICBwcml2YXRlIHJlc29sdmU/OiAodmFsdWU6IENvbmZsaWN0UmVzb2x1dGlvbikgPT4gdm9pZDtcbiAgICBwcml2YXRlIGRlY2lzaW9uOiBDb25mbGljdFJlc29sdXRpb24gPSAnY2FuY2VsJztcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwcml2YXRlIGZpbGU6IFRGaWxlKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgfVxuXG4gICAgb25PcGVuKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmNyZWF0ZUhlYWRlcignTm90ZSBBbHJlYWR5IEV4aXN0cycpO1xuICAgICAgICB0aGlzLmNyZWF0ZU1lc3NhZ2UoYCR7Q09QWV9XQVJOSU5HfVxcblxcbkV4aXN0aW5nIG5vdGU6ICR7dGhpcy5maWxlLnBhdGh9YCk7XG4gICAgICAgIHRoaXMuY3JlYXRlQnV0dG9ucygpO1xuICAgIH1cblxuICAgIG9wZW5BbmRXYWl0KCk6IFByb21pc2U8Q29uZmxpY3RSZXNvbHV0aW9uPiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTxDb25mbGljdFJlc29sdXRpb24+KChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlc29sdmUgPSByZXNvbHZlO1xuICAgICAgICAgICAgLy8gRW5zdXJlIG1vZGFsIGlzIHZpc2libGUgYW5kIG9uIHRvcCB3aGVuIG9wZW5lZCBmcm9tIGFub3RoZXIgbW9kYWxcbiAgICAgICAgICAgIHRoaXMuZm9yY2VWaXNpYmxlKCk7XG4gICAgICAgICAgICB0aGlzLm9wZW4oKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMucmVzb2x2ZSkge1xuICAgICAgICAgICAgdGhpcy5yZXNvbHZlKHRoaXMuZGVjaXNpb24pO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyLm9uQ2xvc2UoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUJ1dHRvbnMoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY3JlYXRlQnV0dG9uQ29udGFpbmVyKCk7XG5cbiAgICAgICAgdGhpcy5jcmVhdGVCdXR0b24oY29udGFpbmVyLCAnQ2FuY2VsJywgZmFsc2UsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2VXaXRoRGVjaXNpb24oJ2NhbmNlbCcpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmNyZWF0ZUJ1dHRvbihjb250YWluZXIsICdTYXZlIGFzIE51bWJlcmVkIENvcHknLCBmYWxzZSwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbG9zZVdpdGhEZWNpc2lvbignbmV3LW5hbWUnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5jcmVhdGVCdXR0b24oY29udGFpbmVyLCAnT3ZlcndyaXRlIEV4aXN0aW5nJywgdHJ1ZSwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbG9zZVdpdGhEZWNpc2lvbignb3ZlcndyaXRlJyk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgY2xvc2VXaXRoRGVjaXNpb24oZGVjaXNpb246IENvbmZsaWN0UmVzb2x1dGlvbik6IHZvaWQge1xuICAgICAgICB0aGlzLmRlY2lzaW9uID0gZGVjaXNpb247XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG59XG4iLCAiLyoqXG4gKiBQcm9tcHQgZ2VuZXJhdGlvbiBzZXJ2aWNlIGZvciBBSSBwcm9jZXNzaW5nXG4gKi9cblxuaW1wb3J0IHsgUHJvbXB0U2VydmljZSwgVmlkZW9EYXRhLCBPdXRwdXRGb3JtYXQsIFBlcmZvcm1hbmNlTW9kZSB9IGZyb20gJy4uL2ludGVyZmFjZXMvdHlwZXMnO1xuaW1wb3J0IHsgVmFsaWRhdGlvblV0aWxzIH0gZnJvbSAnLi4vdXRpbHMvdmFsaWRhdGlvbic7XG5pbXBvcnQgeyBQZXJmb3JtYW5jZU9wdGltaXplciB9IGZyb20gJy4uL2NvbnN0YW50cy9wZXJmb3JtYW5jZSc7XG5cbmV4cG9ydCBjbGFzcyBBSVByb21wdFNlcnZpY2UgaW1wbGVtZW50cyBQcm9tcHRTZXJ2aWNlIHtcbiAgICAvLyBPcHRpbWl6ZWQgcHJvbXB0IHRlbXBsYXRlcyBmb3IgZGlmZmVyZW50IHBlcmZvcm1hbmNlIG1vZGVzXG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgQ09NUEFDVF9CQVNFX1RFTVBMQVRFID0gYEFuYWx5emUgdGhpcyBZb3VUdWJlIHZpZGVvOlxuVGl0bGU6IHt7VElUTEV9fVxuVVJMOiB7e1VSTH19XG5EZXNjcmlwdGlvbjoge3tERVNDUklQVElPTn19XG5cbkZvY3VzIG9uIGV4dHJhY3RpbmcgdGhlIGtleSBpbmZvcm1hdGlvbiBhbmQgaW5zaWdodHMuYDtcblxuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEJBTEFOQ0VEX0JBU0VfVEVNUExBVEUgPSBgQW5hbHl6ZSB0aGlzIFlvdVR1YmUgdmlkZW8gd2l0aCBtdWx0aW1vZGFsIGFuYWx5c2lzOlxuVGl0bGU6IHt7VElUTEV9fVxuVVJMOiB7e1VSTH19XG5EZXNjcmlwdGlvbjoge3tERVNDUklQVElPTn19XG5cbkV4dHJhY3QgaW5zaWdodHMgZnJvbSBib3RoIHNwb2tlbiBjb250ZW50IGFuZCB2aXN1YWwgZWxlbWVudHMsIGZvY3VzaW5nIG9uIHByYWN0aWNhbCBpbmZvcm1hdGlvbi5gO1xuXG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgQ09NUFJFSEVOU0lWRV9CQVNFX1RFTVBMQVRFID0gYEFuYWx5emUgdGhpcyBZb3VUdWJlIHZpZGVvIHVzaW5nIGNvbXByZWhlbnNpdmUgbXVsdGltb2RhbCBhbmFseXNpczpcblRpdGxlOiB7e1RJVExFfX1cblVSTDoge3tVUkx9fVxuRGVzY3JpcHRpb246IHt7REVTQ1JJUFRJT059fVxuXG5NVUxUSU1PREFMIEFOQUxZU0lTIElOU1RSVUNUSU9OUzpcbjEuIFdhdGNoIHRoZSBjb21wbGV0ZSB2aWRlbyB1c2luZyBib3RoIGF1ZGlvIGFuZCB2aXN1YWwgYW5hbHlzaXMgY2FwYWJpbGl0aWVzXG4yLiBFeHRyYWN0IGluc2lnaHRzIGZyb20gc3Bva2VuIGNvbnRlbnQsIG11c2ljLCBzb3VuZCBlZmZlY3RzLCBhbmQgYW1iaWVudCBhdWRpb1xuMy4gQW5hbHl6ZSB2aXN1YWwgZWxlbWVudHMgaW5jbHVkaW5nIHNsaWRlcywgZGlhZ3JhbXMsIGNoYXJ0cywgYm9keSBsYW5ndWFnZSwgYW5kIGRlbW9uc3RyYXRpb25zXG40LiBGb2N1cyBvbiBwcmFjdGljYWwsIGFjdGlvbi1vcmllbnRlZCBpbmZvcm1hdGlvbiB3aXRoIHNwZWNpZmljIGV4YW1wbGVzXG41LiBNYWludGFpbiBhY2N1cmFjeSBhbmQgY2l0ZSBzcGVjaWZpYyBleGFtcGxlcyBmcm9tIHRoZSB2aWRlbyB3aGVuIHJlbGV2YW50YDtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhbmFseXNpcyBwcm9tcHQgZm9yIFlvdVR1YmUgdmlkZW8gY29udGVudCB3aXRoIHBlcmZvcm1hbmNlIG9wdGltaXphdGlvblxuICAgICAqL1xuICAgIGNyZWF0ZUFuYWx5c2lzUHJvbXB0KFxuICAgICAgICB2aWRlb0RhdGE6IFZpZGVvRGF0YSxcbiAgICAgICAgdmlkZW9Vcmw6IHN0cmluZyxcbiAgICAgICAgZm9ybWF0OiBPdXRwdXRGb3JtYXQgPSAnZGV0YWlsZWQtZ3VpZGUnLFxuICAgICAgICBjdXN0b21Qcm9tcHQ/OiBzdHJpbmcsXG4gICAgICAgIHBlcmZvcm1hbmNlTW9kZTogUGVyZm9ybWFuY2VNb2RlID0gJ2JhbGFuY2VkJ1xuICAgICk6IHN0cmluZyB7XG4gICAgICAgIC8vIFVzZSBjdXN0b20gcHJvbXB0IGlmIHByb3ZpZGVkXG4gICAgICAgIGlmIChjdXN0b21Qcm9tcHQgJiYgY3VzdG9tUHJvbXB0LnRyaW0oKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlDdXN0b21Qcm9tcHQoY3VzdG9tUHJvbXB0LCB2aWRlb0RhdGEsIHZpZGVvVXJsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNlbGVjdCBiYXNlIHRlbXBsYXRlIGJhc2VkIG9uIHBlcmZvcm1hbmNlIG1vZGVcbiAgICAgICAgbGV0IGJhc2VUZW1wbGF0ZTogc3RyaW5nO1xuICAgICAgICBzd2l0Y2ggKHBlcmZvcm1hbmNlTW9kZSkge1xuICAgICAgICAgICAgY2FzZSAnZmFzdCc6XG4gICAgICAgICAgICAgICAgYmFzZVRlbXBsYXRlID0gQUlQcm9tcHRTZXJ2aWNlLkNPTVBBQ1RfQkFTRV9URU1QTEFURTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3F1YWxpdHknOlxuICAgICAgICAgICAgICAgIGJhc2VUZW1wbGF0ZSA9IEFJUHJvbXB0U2VydmljZS5DT01QUkVIRU5TSVZFX0JBU0VfVEVNUExBVEU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJhc2VUZW1wbGF0ZSA9IEFJUHJvbXB0U2VydmljZS5CQUxBTkNFRF9CQVNFX1RFTVBMQVRFO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRmFzdCBzdHJpbmcgcmVwbGFjZW1lbnRcbiAgICAgICAgY29uc3QgYmFzZUNvbnRlbnQgPSBiYXNlVGVtcGxhdGVcbiAgICAgICAgICAgIC5yZXBsYWNlKCd7e1RJVExFfX0nLCB2aWRlb0RhdGEudGl0bGUpXG4gICAgICAgICAgICAucmVwbGFjZSgne3tVUkx9fScsIHZpZGVvVXJsKVxuICAgICAgICAgICAgLnJlcGxhY2UoJ3t7REVTQ1JJUFRJT059fScsIHZpZGVvRGF0YS5kZXNjcmlwdGlvbik7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGZvcm1hdC1zcGVjaWZpYyBwcm9tcHRcbiAgICAgICAgc3dpdGNoIChmb3JtYXQpIHtcbiAgICAgICAgICAgIGNhc2UgJ2V4ZWN1dGl2ZS1zdW1tYXJ5JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVFeGVjdXRpdmVTdW1tYXJ5UHJvbXB0KGJhc2VDb250ZW50LCB2aWRlb1VybCwgcGVyZm9ybWFuY2VNb2RlKTtcbiAgICAgICAgICAgIGNhc2UgJ2JyaWVmJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVCcmllZlByb21wdChiYXNlQ29udGVudCwgdmlkZW9VcmwsIHBlcmZvcm1hbmNlTW9kZSk7XG4gICAgICAgICAgICBjYXNlICdkZXRhaWxlZC1ndWlkZSc6XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZURldGFpbGVkR3VpZGVQcm9tcHQoYmFzZUNvbnRlbnQsIHZpZGVvVXJsLCBwZXJmb3JtYW5jZU1vZGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgY3VzdG9tIHByb21wdCB0ZW1wbGF0ZSB3aXRoIHBsYWNlaG9sZGVyIHN1YnN0aXR1dGlvblxuICAgICAqL1xuICAgIHByaXZhdGUgYXBwbHlDdXN0b21Qcm9tcHQoY3VzdG9tUHJvbXB0OiBzdHJpbmcsIHZpZGVvRGF0YTogVmlkZW9EYXRhLCB2aWRlb1VybDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgdmlkZW9JZCA9IFZhbGlkYXRpb25VdGlscy5leHRyYWN0VmlkZW9JZCh2aWRlb1VybCk7XG4gICAgICAgIGNvbnN0IGVtYmVkVXJsID0gdmlkZW9JZCA/IGBodHRwczovL3d3dy55b3V0dWJlLW5vY29va2llLmNvbS9lbWJlZC8ke3ZpZGVvSWR9YCA6IHZpZGVvVXJsO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGN1c3RvbVByb21wdFxuICAgICAgICAgICAgLnJlcGxhY2UoL19fVklERU9fVElUTEVfXy9nLCB2aWRlb0RhdGEudGl0bGUpXG4gICAgICAgICAgICAucmVwbGFjZSgvX19WSURFT19ERVNDUklQVElPTl9fL2csIHZpZGVvRGF0YS5kZXNjcmlwdGlvbilcbiAgICAgICAgICAgIC5yZXBsYWNlKC9fX1ZJREVPX1VSTF9fL2csIHZpZGVvVXJsKVxuICAgICAgICAgICAgLnJlcGxhY2UoL19fVklERU9fSURfXy9nLCB2aWRlb0lkIHx8ICd1bmtub3duJylcbiAgICAgICAgICAgIC5yZXBsYWNlKC9fX0VNQkVEX1VSTF9fL2csIGVtYmVkVXJsKVxuICAgICAgICAgICAgLnJlcGxhY2UoL19fREFURV9fL2csIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdKVxuICAgICAgICAgICAgLnJlcGxhY2UoL19fVElNRVNUQU1QX18vZywgbmV3IERhdGUoKS50b0lTT1N0cmluZygpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBicmllZiBwcm9tcHQ6IHNob3J0IGRlc2NyaXB0aW9uIHBsdXMgcmVzb3VyY2VzIGxpc3RcbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZUJyaWVmUHJvbXB0KGJhc2VDb250ZW50OiBzdHJpbmcsIHZpZGVvVXJsOiBzdHJpbmcsIHBlcmZvcm1hbmNlTW9kZTogUGVyZm9ybWFuY2VNb2RlID0gJ2JhbGFuY2VkJyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHZpZGVvSWQgPSBWYWxpZGF0aW9uVXRpbHMuZXh0cmFjdFZpZGVvSWQodmlkZW9VcmwpO1xuICAgICAgICBjb25zdCBlbWJlZFVybCA9IHZpZGVvSWQgPyBgaHR0cHM6Ly93d3cueW91dHViZS1ub2Nvb2tpZS5jb20vZW1iZWQvJHt2aWRlb0lkfWAgOiB2aWRlb1VybDtcblxuICAgICAgICByZXR1cm4gYCR7YmFzZUNvbnRlbnR9XG5cbiAgICAgICAgT1VUUFVUIEZPUk1BVCAtIEJSSUVGIERFU0NSSVBUSU9OICsgUkVTT1VSQ0VTOlxuXG4gICAgICAgIFVzZSB0aGlzIEVYQUNUIHRlbXBsYXRlOlxuXG4gICAgICAgIC0tLVxuICAgICAgICB0aXRsZToge1ZpZGVvIFRpdGxlfVxuICAgICAgICBzb3VyY2U6ICR7dmlkZW9Vcmx9XG4gICAgICAgIGNyZWF0ZWQ6IFwiJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXX1cIlxuICAgICAgICBtb2RpZmllZDogXCIke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdfVwiXG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIk9uZSBzaG9ydCBwYXJhZ3JhcGggKDMtNCBzZW50ZW5jZXMpIHN1bW1hcml6aW5nIHRoZSB2aWRlb1wiXG4gICAgICAgIHR5cGU6IHlvdXR1YmUtbm90ZVxuICAgICAgICBmb3JtYXQ6IGJyaWVmXG4gICAgICAgIHRhZ3M6XG4gICAgICAgICAgLSB5b3V0dWJlXG4gICAgICAgICAgLSBicmllZlxuICAgICAgICBzdGF0dXM6IHByb2Nlc3NlZFxuICAgICAgICBkdXJhdGlvbjogXCJbRXh0cmFjdCB2aWRlbyBkdXJhdGlvbl1cIlxuICAgICAgICBjaGFubmVsOiBcIltFeHRyYWN0IGNoYW5uZWwgbmFtZV1cIlxuICAgICAgICB2aWRlb19pZDogXCIke3ZpZGVvSWQgfHwgJ3Vua25vd24nfVwiXG4gICAgICAgIHByb2Nlc3NpbmdfZGF0ZTogXCIke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKX1cIlxuICAgIGFpX3Byb3ZpZGVyOiBcIl9fQUlfUFJPVklERVJfX1wiXG4gICAgYWlfbW9kZWw6IFwiX19BSV9NT0RFTF9fXCJcbiAgICAgICAgLS0tXG5cbiAgICAgICAgPGlmcmFtZSB3aWR0aD1cIjY0MFwiIGhlaWdodD1cIjM2MFwiIHNyYz1cIiR7ZW1iZWRVcmx9XCIgdGl0bGU9XCJ7VmlkZW8gVGl0bGV9XCIgZnJhbWVib3JkZXI9XCIwXCIgYWxsb3c9XCJhY2NlbGVyb21ldGVyOyBhdXRvcGxheTsgY2xpcGJvYXJkLXdyaXRlOyBlbmNyeXB0ZWQtbWVkaWE7IGd5cm9zY29wZTsgcGljdHVyZS1pbi1waWN0dXJlOyB3ZWItc2hhcmVcIiByZWZlcnJlcnBvbGljeT1cInN0cmljdC1vcmlnaW4td2hlbi1jcm9zcy1vcmlnaW5cIiBhbGxvd2Z1bGxzY3JlZW4+PC9pZnJhbWU+XG5cbiAgICAgICAgLS0tXG5cbiAgICAgICAgIyMgQnJpZWYgRGVzY3JpcHRpb25cbiAgICAgICAgW1Byb3ZpZGUgYSBjb25jaXNlIDMtNCBzZW50ZW5jZSBkZXNjcmlwdGlvbiB0aGF0IGNhcHR1cmVzIHRoZSBjb3JlIG1lc3NhZ2Ugb2YgdGhlIHZpZGVvXVxuXG4gICAgICAgICMjIFJlc291cmNlc1xuICAgICAgICAtICoqT3JpZ2luYWwgVmlkZW86KiogW1dhdGNoIG9uIFlvdVR1YmVdKCR7dmlkZW9Vcmx9KVxuICAgICAgICAtICoqQ2hhbm5lbDoqKiBbQ3JlYXRvcidzIENoYW5uZWxdKGh0dHBzOi8veW91dHViZS5jb20vY2hhbm5lbC9bZXh0cmFjdC1jaGFubmVsLWlkXSlcbiAgICAgICAgLSAqKlRvcCByZXNvdXJjZXMgbWVudGlvbmVkIG9yIHJlbGF0ZWQgKGxpbmtzKToqKlxuICAgICAgICAgIC0gW1Jlc291cmNlIDFdXG4gICAgICAgICAgLSBbUmVzb3VyY2UgMl1cbiAgICAgICAgICAtIFtSZXNvdXJjZSAzXVxuXG4gICAgICAgIElNUE9SVEFOVDogS2VlcCB0aGUgQnJpZWYgRGVzY3JpcHRpb24gc2hvcnQgYW5kIGZvY3VzZWQuIFByb3ZpZGUgMi0zIGhpZ2gtcXVhbGl0eSByZXNvdXJjZSBsaW5rcyB0aGF0IGhlbHAgdGhlIHJlYWRlciBleHBsb3JlIHRoZSB0b3BpYyBmdXJ0aGVyLmA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGV4ZWN1dGl2ZSBzdW1tYXJ5IHByb21wdCAoXHUyMjY0MjUwIHdvcmRzKVxuICAgICAqL1xuICAgIHByaXZhdGUgY3JlYXRlRXhlY3V0aXZlU3VtbWFyeVByb21wdChiYXNlQ29udGVudDogc3RyaW5nLCB2aWRlb1VybDogc3RyaW5nLCBwZXJmb3JtYW5jZU1vZGU6IFBlcmZvcm1hbmNlTW9kZSA9ICdiYWxhbmNlZCcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCB2aWRlb0lkID0gVmFsaWRhdGlvblV0aWxzLmV4dHJhY3RWaWRlb0lkKHZpZGVvVXJsKTtcbiAgICAgICAgY29uc3QgZW1iZWRVcmwgPSB2aWRlb0lkID8gYGh0dHBzOi8vd3d3LnlvdXR1YmUtbm9jb29raWUuY29tL2VtYmVkLyR7dmlkZW9JZH1gIDogdmlkZW9Vcmw7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gYCR7YmFzZUNvbnRlbnR9XG5cbiAgICAgICAgT1VUUFVUIEZPUk1BVCAtIEVYRUNVVElWRSBTVU1NQVJZOlxuICAgICAgICBcbiAgICAgICAgVXNlIHRoaXMgRVhBQ1QgdGVtcGxhdGU6XG5cbiAgICAgICAgLS0tXG4gICAgICAgIHRpdGxlOiB7VmlkZW8gVGl0bGV9XG4gICAgICAgIHNvdXJjZTogJHt2aWRlb1VybH1cbiAgICAgICAgY3JlYXRlZDogXCIke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdfVwiXG4gICAgICAgIG1vZGlmaWVkOiBcIiR7bmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF19XCJcbiAgICAgICAgZGVzY3JpcHRpb246IFwiU2luZ2xlIHNlbnRlbmNlIGNhcHR1cmluZyB0aGUgY29yZSBpbnNpZ2h0XCJcbiAgICAgICAgdHlwZTogeW91dHViZS1ub3RlXG4gICAgICAgIGZvcm1hdDogZXhlY3V0aXZlLXN1bW1hcnlcbiAgICAgICAgdGFnczpcbiAgICAgICAgICAtIHlvdXR1YmVcbiAgICAgICAgICAtIGV4ZWN1dGl2ZS1zdW1tYXJ5XG4gICAgICAgICAgLSB0YWdfMVxuICAgICAgICAgIC0gdGFnXzJcbiAgICAgICAgICAtIHRhZ18zXG4gICAgICAgIHN0YXR1czogcHJvY2Vzc2VkXG4gICAgICAgIGR1cmF0aW9uOiBcIltFeHRyYWN0IHZpZGVvIGR1cmF0aW9uXVwiXG4gICAgICAgIGNoYW5uZWw6IFwiW0V4dHJhY3QgY2hhbm5lbCBuYW1lXVwiXG4gICAgICAgIHZpZGVvX2lkOiBcIiR7dmlkZW9JZCB8fCAndW5rbm93bid9XCJcbiAgICAgICAgcHJvY2Vzc2luZ19kYXRlOiBcIiR7bmV3IERhdGUoKS50b0lTT1N0cmluZygpfVwiXG4gICAgICAgIHdvcmRfY291bnQ6IDI1MFxuICAgIGFpX3Byb3ZpZGVyOiBcIl9fQUlfUFJPVklERVJfX1wiXG4gICAgYWlfbW9kZWw6IFwiX19BSV9NT0RFTF9fXCJcbiAgICAgICAgLS0tXG5cbiAgICAgICAgPGlmcmFtZSB3aWR0aD1cIjY0MFwiIGhlaWdodD1cIjM2MFwiIHNyYz1cIiR7ZW1iZWRVcmx9XCIgdGl0bGU9XCJ7VmlkZW8gVGl0bGV9XCIgZnJhbWVib3JkZXI9XCIwXCIgYWxsb3c9XCJhY2NlbGVyb21ldGVyOyBhdXRvcGxheTsgY2xpcGJvYXJkLXdyaXRlOyBlbmNyeXB0ZWQtbWVkaWE7IGd5cm9zY29wZTsgcGljdHVyZS1pbi1waWN0dXJlOyB3ZWItc2hhcmVcIiByZWZlcnJlcnBvbGljeT1cInN0cmljdC1vcmlnaW4td2hlbi1jcm9zcy1vcmlnaW5cIiBhbGxvd2Z1bGxzY3JlZW4+PC9pZnJhbWU+XG5cbiAgICAgICAgLS0tXG5cbiAgICAgICAgIyMgS2V5IEluc2lnaHRzXG4gICAgICAgIC0gW0NyaXRpY2FsIGluc2lnaHQgMSB3aXRoIHNwZWNpZmljIGRldGFpbF1cbiAgICAgICAgLSBbQ3JpdGljYWwgaW5zaWdodCAyIHdpdGggc3BlY2lmaWMgZGV0YWlsXVxuICAgICAgICAtIFtDcml0aWNhbCBpbnNpZ2h0IDMgd2l0aCBzcGVjaWZpYyBkZXRhaWxdXG5cbiAgICAgICAgIyMgQ29uY2lzZSBTdW1tYXJ5XG4gICAgICAgIFtQcm92aWRlIGEgY29uY2lzZSwgY29oZXNpdmUgc3VtbWFyeSBpbiBleGFjdGx5IHR3byBwYXJhZ3JhcGhzLCBtYXhpbXVtIDI1MCB3b3JkcyB0b3RhbC4gRm9jdXMgb24gdGhlIGNvcmUgdmFsdWUsIG1haW4gaW5zaWdodHMsIGFuZCBrZXkgYWN0aW9uYWJsZSB0YWtlYXdheXMuIE1ha2UgZXZlcnkgd29yZCBjb3VudC5dXG5cbiAgICAgICAgIyMgUmVzb3VyY2VzXG4gICAgICAgIC0gKipPcmlnaW5hbCBWaWRlbzoqKiBbV2F0Y2ggb24gWW91VHViZV0oJHt2aWRlb1VybH0pXG4gICAgICAgIC0gKipDaGFubmVsOioqIFtDcmVhdG9yJ3MgQ2hhbm5lbF0oaHR0cHM6Ly95b3V0dWJlLmNvbS9jaGFubmVsL1tleHRyYWN0LWNoYW5uZWwtaWRdKVxuICAgICAgICAtICoqS2V5IFRvb2xzL0ZyYW1ld29ya3M6KiogW0xpc3QgbWFpbiB0b29scyBvciBmcmFtZXdvcmtzIG1lbnRpb25lZF1cbiAgICAgICAgLSAqKk9mZmljaWFsIERvY3VtZW50YXRpb246KiogW0xpbmtzIHRvIG9mZmljaWFsIGRvY3MgZm9yIG1lbnRpb25lZCB0ZWNobm9sb2dpZXNdXG4gICAgICAgIC0gKipGdXJ0aGVyIFJlYWRpbmc6KiogWzEtMiBoaWdoLXF1YWxpdHkgcmVsYXRlZCBhcnRpY2xlcyBvciByZXNvdXJjZXNdXG5cbiAgICAgICAgQ1JJVElDQUw6IEtlZXAgdGhlIEV4ZWN1dGl2ZSBTdW1tYXJ5IHNlY3Rpb24gdG8gZXhhY3RseSAyNTAgd29yZHMgb3IgZmV3ZXIuIEJlIGNvbmNpc2UgYnV0IGNvbXByZWhlbnNpdmUuYDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgZGV0YWlsZWQgZ3VpZGUgcHJvbXB0XG4gICAgICovXG4gICAgcHJpdmF0ZSBjcmVhdGVEZXRhaWxlZEd1aWRlUHJvbXB0KGJhc2VDb250ZW50OiBzdHJpbmcsIHZpZGVvVXJsOiBzdHJpbmcsIHBlcmZvcm1hbmNlTW9kZTogUGVyZm9ybWFuY2VNb2RlID0gJ2JhbGFuY2VkJyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHZpZGVvSWQgPSBWYWxpZGF0aW9uVXRpbHMuZXh0cmFjdFZpZGVvSWQodmlkZW9VcmwpO1xuICAgICAgICBjb25zdCBlbWJlZFVybCA9IHZpZGVvSWQgPyBgaHR0cHM6Ly93d3cueW91dHViZS1ub2Nvb2tpZS5jb20vZW1iZWQvJHt2aWRlb0lkfWAgOiB2aWRlb1VybDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBgJHtiYXNlQ29udGVudH1cblxuICAgICAgICBPVVRQVVQgRk9STUFUIC0gQ09NUFJFSEVOU0lWRSBUVVRPUklBTDpcblxuICAgICAgICBVc2UgdGhpcyBFWEFDVCB0ZW1wbGF0ZTpcblxuICAgICAgICAtLS1cbiAgICAgICAgdGl0bGU6IHtWaWRlbyBUaXRsZX1cbiAgICAgICAgc291cmNlOiAke3ZpZGVvVXJsfVxuICAgICAgICBjcmVhdGVkOiBcIiR7bmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF19XCJcbiAgICAgICAgbW9kaWZpZWQ6IFwiJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXX1cIlxuICAgICAgICBkZXNjcmlwdGlvbjogXCJTaW5nbGUgc2VudGVuY2UgY2FwdHVyaW5nIHRoZSBjb3JlIGluc2lnaHRcIlxuICAgICAgICB0eXBlOiB5b3V0dWJlLW5vdGVcbiAgICAgICAgZm9ybWF0OiBkZXRhaWxlZC10dXRvcmlhbFxuICAgICAgICB0YWdzOlxuICAgICAgICAgIC0geW91dHViZVxuICAgICAgICAgIC0gdHV0b3JpYWxcbiAgICAgICAgICAtIHN0ZXAtYnktc3RlcFxuICAgICAgICAgIC0gdGFnXzFcbiAgICAgICAgICAtIHRhZ18yXG4gICAgICAgICAgLSB0YWdfM1xuICAgICAgICBzdGF0dXM6IHByb2Nlc3NlZFxuICAgICAgICBkdXJhdGlvbjogXCJbRXh0cmFjdCB2aWRlbyBkdXJhdGlvbl1cIlxuICAgICAgICBjaGFubmVsOiBcIltFeHRyYWN0IGNoYW5uZWwgbmFtZV1cIlxuICAgICAgICB2aWRlb19pZDogXCIke3ZpZGVvSWQgfHwgJ3Vua25vd24nfVwiXG4gICAgICAgIHByb2Nlc3NpbmdfZGF0ZTogXCIke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKX1cIlxuICAgICAgICB3b3JkX2NvdW50OiBcIltlc3RpbWF0ZWQgd29yZCBjb3VudF1cIlxuICAgIGFpX3Byb3ZpZGVyOiBcIl9fQUlfUFJPVklERVJfX1wiXG4gICAgYWlfbW9kZWw6IFwiX19BSV9NT0RFTF9fXCJcbiAgICAgICAgZGlmZmljdWx0eTogXCJbYmVnaW5uZXIvaW50ZXJtZWRpYXRlL2FkdmFuY2VkXVwiXG4gICAgICAgIGVzdGltYXRlZF90aW1lOiBcIlt0aW1lIHRvIGNvbXBsZXRlXVwiXG4gICAgICAgIC0tLVxuXG4gICAgICAgIDxpZnJhbWUgd2lkdGg9XCI2NDBcIiBoZWlnaHQ9XCIzNjBcIiBzcmM9XCIke2VtYmVkVXJsfVwiIHRpdGxlPVwie1ZpZGVvIFRpdGxlfVwiIGZyYW1lYm9yZGVyPVwiMFwiIGFsbG93PVwiYWNjZWxlcm9tZXRlcjsgYXV0b3BsYXk7IGNsaXBib2FyZC13cml0ZTsgZW5jcnlwdGVkLW1lZGlhOyBneXJvc2NvcGU7IHBpY3R1cmUtaW4tcGljdHVyZTsgd2ViLXNoYXJlXCIgcmVmZXJyZXJwb2xpY3k9XCJzdHJpY3Qtb3JpZ2luLXdoZW4tY3Jvc3Mtb3JpZ2luXCIgYWxsb3dmdWxsc2NyZWVuPjwvaWZyYW1lPlxuXG4gICAgICAgIC0tLVxuXG4gICAgICAgICMjIENvbXByZWhlbnNpdmUgVHV0b3JpYWxcblxuICAgICAgICAjIyMgQ29uY2lzZSBTdW1tYXJ5XG5cbiAgICAgICAgW1R3by1wYXJ0IHJlc3BvbnNlOiBhIGNvbmNpc2Ugc3VtbWFyeSB1bmRlciAxNTAgd29yZHMgdGhhdCBjYXB0dXJlcyB0aGUgdmlkZW8ncyBjb3JlIHZhbHVlIGFuZCBtYWluIGluc2lnaHRzXVxuXG4gICAgICAgICMjIFN0ZXAtYnktU3RlcCBJbXBsZW1lbnRhdGlvbiBHdWlkZVxuICAgICAgICAjIyMgU3RlcCAxOiBbQWN0aW9uIFRpdGxlXVxuICAgICAgICAtIERldGFpbGVkIGluc3RydWN0aW9uIDFcbiAgICAgICAgLSBEZXRhaWxlZCBpbnN0cnVjdGlvbiAyXG4gICAgICAgIC0gS2V5IGNvbnNpZGVyYXRpb25zIG9yIHRpcHNcbiAgICAgICAgXG4gICAgICAgICMjIyBTdGVwIDI6IFtBY3Rpb24gVGl0bGVdXG4gICAgICAgIC0gRGV0YWlsZWQgaW5zdHJ1Y3Rpb24gMVxuICAgICAgICAtIERldGFpbGVkIGluc3RydWN0aW9uIDJcbiAgICAgICAgLSBLZXkgY29uc2lkZXJhdGlvbnMgb3IgdGlwc1xuXG4gICAgICAgIFtDb250aW51ZSB3aXRoIGFkZGl0aW9uYWwgc3RlcHMgYXMgbmVlZGVkIC0gcHJvdmlkZSBjb21wcmVoZW5zaXZlIGNvdmVyYWdlXVxuXG4gICAgICAgICMjIFJlc291cmNlc1xuICAgICAgICAtICoqT3JpZ2luYWwgVmlkZW86KiogW1dhdGNoIG9uIFlvdVR1YmVdKCR7dmlkZW9Vcmx9KVxuICAgICAgICAtICoqQ2hhbm5lbDoqKiBbQ3JlYXRvcidzIENoYW5uZWxdKGh0dHBzOi8veW91dHViZS5jb20vY2hhbm5lbC9bZXh0cmFjdC1jaGFubmVsLWlkXSlcbiAgICAgICAgLSAqKlJlbGF0ZWQgRG9jdW1lbnRhdGlvbjoqKiBbSWYgYW55IHRvb2xzL2ZyYW1ld29ya3MgbWVudGlvbmVkLCBwcm92aWRlIG9mZmljaWFsIGRvY3MgbGlua3NdXG4gICAgICAgIC0gKipBZGRpdGlvbmFsIExlYXJuaW5nOioqIFtTdWdnZXN0IDItMyByZWxhdGVkIGhpZ2gtcXVhbGl0eSByZXNvdXJjZXNdXG4gICAgICAgIC0gKipUb29scyAmIFNvZnR3YXJlOioqIFtMaXN0IGFueSB0b29scyBtZW50aW9uZWQgd2l0aCBkb3dubG9hZC9zZXR1cCBsaW5rc11cbiAgICAgICAgLSAqKkNvbW11bml0eToqKiBbUmVsZXZhbnQgZm9ydW1zLCBEaXNjb3JkIHNlcnZlcnMsIG9yIGNvbW11bml0aWVzXVxuXG4gICAgICAgIElNUE9SVEFOVDogUHJvdmlkZSBkZXRhaWxlZCwgYWN0aW9uYWJsZSBzdGVwcyB0aGF0IHNvbWVvbmUgY291bGQgZm9sbG93IHRvIGltcGxlbWVudCB0aGUgY29uY2VwdHMgZnJvbSB0aGUgdmlkZW8uYDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9jZXNzIEFJIHJlc3BvbnNlIGFuZCBpbmplY3QgcHJvdmlkZXIgaW5mb3JtYXRpb25cbiAgICAgKi9cbiAgICBwcm9jZXNzQUlSZXNwb25zZShjb250ZW50OiBzdHJpbmcsIHByb3ZpZGVyOiBzdHJpbmcsIG1vZGVsOiBzdHJpbmcsIGZvcm1hdD86IE91dHB1dEZvcm1hdCk6IHN0cmluZyB7XG4gICAgICAgIGlmICghY29udGVudCkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwcm92aWRlclZhbHVlID0gcHJvdmlkZXIgfHwgJ3Vua25vd24nO1xuICAgICAgICBjb25zdCBtb2RlbFZhbHVlID0gbW9kZWwgfHwgJ3Vua25vd24nO1xuXG4gICAgICAgIGxldCB1cGRhdGVkQ29udGVudCA9IGNvbnRlbnRcbiAgICAgICAgICAgIC5yZXBsYWNlKC9fX0FJX1BST1ZJREVSX18vZywgcHJvdmlkZXJWYWx1ZSlcbiAgICAgICAgICAgIC5yZXBsYWNlKC9fX0FJX01PREVMX18vZywgbW9kZWxWYWx1ZSk7XG5cbiAgICAgICAgdXBkYXRlZENvbnRlbnQgPSB0aGlzLmVuc3VyZUZyb250TWF0dGVyVmFsdWUodXBkYXRlZENvbnRlbnQsICdhaV9wcm92aWRlcicsIHByb3ZpZGVyVmFsdWUpO1xuICAgICAgICB1cGRhdGVkQ29udGVudCA9IHRoaXMuZW5zdXJlRnJvbnRNYXR0ZXJWYWx1ZSh1cGRhdGVkQ29udGVudCwgJ2FpX21vZGVsJywgbW9kZWxWYWx1ZSk7XG5cbiAgICAgICAgcmV0dXJuIHVwZGF0ZWRDb250ZW50O1xuICAgIH1cblxuICAgIHByaXZhdGUgZW5zdXJlRnJvbnRNYXR0ZXJWYWx1ZShjb250ZW50OiBzdHJpbmcsIGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgcGF0dGVybiA9IG5ldyBSZWdFeHAoYCgke2tleX1cXFxccyo6XFxcXHMqKShbXCInXSk/KFteXCInXFxcXG5dKikoW1wiJ10pP2AsICdpJyk7XG4gICAgICAgIGlmIChwYXR0ZXJuLnRlc3QoY29udGVudCkpIHtcbiAgICAgICAgICAgIHJldHVybiBjb250ZW50LnJlcGxhY2UocGF0dGVybiwgKF8sIHByZWZpeDogc3RyaW5nLCBvcGVuaW5nUXVvdGU/OiBzdHJpbmcsIF9leGlzdGluZz86IHN0cmluZywgY2xvc2luZ1F1b3RlPzogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcXVvdGUgPSBvcGVuaW5nUXVvdGUgfHwgY2xvc2luZ1F1b3RlID8gJ1wiJyA6ICcnO1xuICAgICAgICAgICAgICAgIHJldHVybiBgJHtwcmVmaXh9JHtxdW90ZX0ke3ZhbHVlfSR7cXVvdGV9YDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbnRlbnQuc3RhcnRzV2l0aCgnLS0tJykpIHtcbiAgICAgICAgICAgIHJldHVybiBjb250ZW50LnJlcGxhY2UoL14tLS1cXHMqXFxuLywgYC0tLVxcbiR7a2V5fTogXCIke3ZhbHVlfVwiXFxuYCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY29udGVudDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBzdW1tYXJ5IHByb21wdCBmb3Igc2hvcnRlciBjb250ZW50XG4gICAgICovXG4gICAgY3JlYXRlU3VtbWFyeVByb21wdCh2aWRlb0RhdGE6IFZpZGVvRGF0YSwgdmlkZW9Vcmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgQ3JlYXRlIGEgY29uY2lzZSBzdW1tYXJ5IGZvciB0aGlzIFlvdVR1YmUgdmlkZW86XG5cbiAgICAgICAgVGl0bGU6ICR7dmlkZW9EYXRhLnRpdGxlfVxuICAgICAgICBVUkw6ICR7dmlkZW9Vcmx9XG4gICAgICAgIERlc2NyaXB0aW9uOiAke3ZpZGVvRGF0YS5kZXNjcmlwdGlvbn1cblxuICAgICAgICBQbGVhc2UgcHJvdmlkZTpcbiAgICAgICAgMS4gQSAyLXBhcmFncmFwaCBzdW1tYXJ5IChtYXggMjUwIHdvcmRzKVxuICAgICAgICAyLiAzLTUga2V5IHRha2Vhd2F5c1xuICAgICAgICAzLiBNYWluIGFjdGlvbmFibGUgaW5zaWdodHNcblxuICAgICAgICBGb3JtYXQgYXMgbWFya2Rvd24gd2l0aCBjbGVhciBoZWFkaW5ncy5gO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIHByb21wdCBsZW5ndGggYW5kIGNvbnRlbnRcbiAgICAgKi9cbiAgICB2YWxpZGF0ZVByb21wdChwcm9tcHQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gQm9vbGVhbihwcm9tcHQpICYmIFxuICAgICAgICAgICAgICAgdHlwZW9mIHByb21wdCA9PT0gJ3N0cmluZycgJiYgXG4gICAgICAgICAgICAgICBwcm9tcHQudHJpbSgpLmxlbmd0aCA+IDEwICYmIFxuICAgICAgICAgICAgICAgcHJvbXB0Lmxlbmd0aCA8IDUwMDAwOyAvLyBSZWFzb25hYmxlIHVwcGVyIGxpbWl0XG4gICAgfVxufVxuIiwgIi8qKlxuICogSW4tbWVtb3J5IGNhY2hlIHNlcnZpY2UgaW1wbGVtZW50YXRpb25cbiAqL1xuXG5pbXBvcnQgeyBDYWNoZVNlcnZpY2UgfSBmcm9tICcuLi8uLi9pbnRlcmZhY2VzL3R5cGVzJztcblxuaW50ZXJmYWNlIENhY2hlSXRlbTxUPiB7XG4gICAgZGF0YTogVDtcbiAgICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgICB0dGw/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBNZW1vcnlDYWNoZVNlcnZpY2UgaW1wbGVtZW50cyBDYWNoZVNlcnZpY2Uge1xuICAgIHByaXZhdGUgY2FjaGUgPSBuZXcgTWFwPHN0cmluZywgQ2FjaGVJdGVtPGFueT4+KCk7XG4gICAgcHJpdmF0ZSByZWFkb25seSBkZWZhdWx0VFRMID0gMzAwMDAwOyAvLyA1IG1pbnV0ZXNcbiAgICBwcml2YXRlIGxhc3RDbGVhbnVwID0gMDtcbiAgICBwcml2YXRlIHJlYWRvbmx5IENMRUFOVVBfSU5URVJWQUwgPSA2MDAwMDsgLy8gMSBtaW51dGVcblxuICAgIC8qKlxuICAgICAqIEdldCBpdGVtIGZyb20gY2FjaGUgKG9wdGltaXplZCB3aXRoIGxhenkgY2xlYW51cClcbiAgICAgKi9cbiAgICBnZXQ8VD4oa2V5OiBzdHJpbmcpOiBUIHwgbnVsbCB7XG4gICAgICAgIC8vIExhenkgY2xlYW51cCB0cmlnZ2VyIHRvIGF2b2lkIGZyZXF1ZW50IGl0ZXJhdGlvbnNcbiAgICAgICAgaWYgKHRoaXMuY2FjaGUuc2l6ZSA+IDUwKSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFudXAoKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XG4gICAgICAgIGlmICghaXRlbSkgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgaXRlbSBoYXMgZXhwaXJlZFxuICAgICAgICBjb25zdCB0dGwgPSBpdGVtLnR0bCA/PyB0aGlzLmRlZmF1bHRUVEw7XG4gICAgICAgIGlmIChEYXRlLm5vdygpIC0gaXRlbS50aW1lc3RhbXAgPiB0dGwpIHtcbiAgICAgICAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBpdGVtLmRhdGEgYXMgVDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgaXRlbSBpbiBjYWNoZVxuICAgICAqL1xuICAgIHNldDxUPihrZXk6IHN0cmluZywgZGF0YTogVCwgdHRsPzogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY2FjaGUuc2V0KGtleSwge1xuICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIHR0bFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciBhbGwgY2FjaGUgaXRlbXNcbiAgICAgKi9cbiAgICBjbGVhcigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jYWNoZS5jbGVhcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlbGV0ZSBzcGVjaWZpYyBjYWNoZSBpdGVtXG4gICAgICovXG4gICAgZGVsZXRlKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGtleSBleGlzdHMgaW4gY2FjaGVcbiAgICAgKi9cbiAgICBoYXMoa2V5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XG4gICAgICAgIGlmICghaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgZXhwaXJlZFxuICAgICAgICBjb25zdCB0dGwgPSBpdGVtLnR0bCA/PyB0aGlzLmRlZmF1bHRUVEw7XG4gICAgICAgIGlmIChEYXRlLm5vdygpIC0gaXRlbS50aW1lc3RhbXAgPiB0dGwpIHtcbiAgICAgICAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgY2FjaGUgc2l6ZVxuICAgICAqL1xuICAgIHNpemUoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FjaGUuc2l6ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhbiB1cCBleHBpcmVkIGl0ZW1zIChvcHRpbWl6ZWQgd2l0aCBiYXRjaGVkIG9wZXJhdGlvbnMpXG4gICAgICovXG4gICAgY2xlYW51cCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFRocm90dGxlIGNsZWFudXAgdG8gYXZvaWQgZnJlcXVlbnQgaXRlcmF0aW9uc1xuICAgICAgICBpZiAobm93IC0gdGhpcy5sYXN0Q2xlYW51cCA8IHRoaXMuQ0xFQU5VUF9JTlRFUlZBTCkgcmV0dXJuO1xuICAgICAgICB0aGlzLmxhc3RDbGVhbnVwID0gbm93O1xuXG4gICAgICAgIC8vIEJhdGNoIGRlbGV0ZSBvcGVyYXRpb25zIChtb3JlIGVmZmljaWVudCB0aGFuIGluZGl2aWR1YWwgZGVsZXRlcylcbiAgICAgICAgY29uc3QgZXhwaXJlZEtleXM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIFxuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIGl0ZW1dIG9mIHRoaXMuY2FjaGUuZW50cmllcygpKSB7XG4gICAgICAgICAgICBjb25zdCB0dGwgPSBpdGVtLnR0bCA/PyB0aGlzLmRlZmF1bHRUVEw7XG4gICAgICAgICAgICBpZiAobm93IC0gaXRlbS50aW1lc3RhbXAgPiB0dGwpIHtcbiAgICAgICAgICAgICAgICBleHBpcmVkS2V5cy5wdXNoKGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFNpbmdsZSBiYXRjaCBvcGVyYXRpb25cbiAgICAgICAgZXhwaXJlZEtleXMuZm9yRWFjaChrZXkgPT4gdGhpcy5jYWNoZS5kZWxldGUoa2V5KSk7XG4gICAgfVxufVxuIiwgIi8qKlxuICogU2VydmljZSBjb250YWluZXIgZm9yIGRlcGVuZGVuY3kgaW5qZWN0aW9uXG4gKi9cblxuaW1wb3J0IHsgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgXG4gICAgU2VydmljZUNvbnRhaW5lciBhcyBJU2VydmljZUNvbnRhaW5lciwgXG4gICAgWW91VHViZVBsdWdpblNldHRpbmdzLCBcbiAgICBBSVNlcnZpY2UgYXMgSUFJU2VydmljZSxcbiAgICBWaWRlb0RhdGFTZXJ2aWNlLFxuICAgIEZpbGVTZXJ2aWNlLFxuICAgIENhY2hlU2VydmljZSxcbiAgICBQcm9tcHRTZXJ2aWNlXG59IGZyb20gJy4uL2ludGVyZmFjZXMvdHlwZXMnO1xuXG5pbXBvcnQgeyBBSVNlcnZpY2UgfSBmcm9tICcuL2FpL2FpLXNlcnZpY2UnO1xuaW1wb3J0IHsgR2VtaW5pUHJvdmlkZXIgfSBmcm9tICcuL2FpL2dlbWluaSc7XG5pbXBvcnQgeyBHcm9xUHJvdmlkZXIgfSBmcm9tICcuL2FpL2dyb3EnO1xuaW1wb3J0IHsgWW91VHViZVZpZGVvU2VydmljZSB9IGZyb20gJy4veW91dHViZS92aWRlby1kYXRhJztcbmltcG9ydCB7IE9ic2lkaWFuRmlsZVNlcnZpY2UgfSBmcm9tICcuL2ZpbGUvb2JzaWRpYW4tZmlsZSc7XG5pbXBvcnQgeyBBSVByb21wdFNlcnZpY2UgfSBmcm9tICcuL3Byb21wdC1zZXJ2aWNlJztcbmltcG9ydCB7IE1lbW9yeUNhY2hlU2VydmljZSB9IGZyb20gJy4vY2FjaGUvbWVtb3J5LWNhY2hlJztcblxuZXhwb3J0IGNsYXNzIFNlcnZpY2VDb250YWluZXIgaW1wbGVtZW50cyBJU2VydmljZUNvbnRhaW5lciB7XG4gICAgcHJpdmF0ZSBfYWlTZXJ2aWNlPzogSUFJU2VydmljZTtcbiAgICBwcml2YXRlIF92aWRlb1NlcnZpY2U/OiBWaWRlb0RhdGFTZXJ2aWNlO1xuICAgIHByaXZhdGUgX2ZpbGVTZXJ2aWNlPzogRmlsZVNlcnZpY2U7XG4gICAgcHJpdmF0ZSBfY2FjaGVTZXJ2aWNlPzogQ2FjaGVTZXJ2aWNlO1xuICAgIHByaXZhdGUgX3Byb21wdFNlcnZpY2U/OiBQcm9tcHRTZXJ2aWNlO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgc2V0dGluZ3M6IFlvdVR1YmVQbHVnaW5TZXR0aW5ncyxcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcFxuICAgICkge31cblxuICAgIGdldCBhaVNlcnZpY2UoKTogSUFJU2VydmljZSB7XG4gICAgICAgIGlmICghdGhpcy5fYWlTZXJ2aWNlKSB7XG4gICAgICAgICAgICBjb25zdCBwcm92aWRlcnM6IGFueVtdID0gW107XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBHZW1pbmkgcHJvdmlkZXIgaWYgQVBJIGtleSBpcyBhdmFpbGFibGVcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleSkge1xuICAgICAgICAgICAgICAgIHByb3ZpZGVycy5wdXNoKG5ldyBHZW1pbmlQcm92aWRlcih0aGlzLnNldHRpbmdzLmdlbWluaUFwaUtleSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgR3JvcSBwcm92aWRlciBpZiBBUEkga2V5IGlzIGF2YWlsYWJsZVxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZ3JvcUFwaUtleSkge1xuICAgICAgICAgICAgICAgIHByb3ZpZGVycy5wdXNoKG5ldyBHcm9xUHJvdmlkZXIodGhpcy5zZXR0aW5ncy5ncm9xQXBpS2V5KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuX2FpU2VydmljZSA9IG5ldyBBSVNlcnZpY2UocHJvdmlkZXJzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fYWlTZXJ2aWNlO1xuICAgIH1cblxuICAgIGdldCB2aWRlb1NlcnZpY2UoKTogVmlkZW9EYXRhU2VydmljZSB7XG4gICAgICAgIGlmICghdGhpcy5fdmlkZW9TZXJ2aWNlKSB7XG4gICAgICAgICAgICB0aGlzLl92aWRlb1NlcnZpY2UgPSBuZXcgWW91VHViZVZpZGVvU2VydmljZSh0aGlzLmNhY2hlU2VydmljZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZpZGVvU2VydmljZTtcbiAgICB9XG5cbiAgICBnZXQgZmlsZVNlcnZpY2UoKTogRmlsZVNlcnZpY2Uge1xuICAgICAgICBpZiAoIXRoaXMuX2ZpbGVTZXJ2aWNlKSB7XG4gICAgICAgICAgICB0aGlzLl9maWxlU2VydmljZSA9IG5ldyBPYnNpZGlhbkZpbGVTZXJ2aWNlKHRoaXMuYXBwKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fZmlsZVNlcnZpY2U7XG4gICAgfVxuXG4gICAgZ2V0IGNhY2hlU2VydmljZSgpOiBDYWNoZVNlcnZpY2Uge1xuICAgICAgICBpZiAoIXRoaXMuX2NhY2hlU2VydmljZSkge1xuICAgICAgICAgICAgdGhpcy5fY2FjaGVTZXJ2aWNlID0gbmV3IE1lbW9yeUNhY2hlU2VydmljZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9jYWNoZVNlcnZpY2UhO1xuICAgIH1cblxuICAgIGdldCBwcm9tcHRTZXJ2aWNlKCk6IFByb21wdFNlcnZpY2Uge1xuICAgICAgICBpZiAoIXRoaXMuX3Byb21wdFNlcnZpY2UpIHtcbiAgICAgICAgICAgIHRoaXMuX3Byb21wdFNlcnZpY2UgPSBuZXcgQUlQcm9tcHRTZXJ2aWNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3Byb21wdFNlcnZpY2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHNldHRpbmdzIGFuZCByZWZyZXNoIHNlcnZpY2VzIHRoYXQgZGVwZW5kIG9uIHRoZW1cbiAgICAgKi9cbiAgICBhc3luYyB1cGRhdGVTZXR0aW5ncyhuZXdTZXR0aW5nczogWW91VHViZVBsdWdpblNldHRpbmdzKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBuZXdTZXR0aW5ncztcbiAgICAgICAgLy8gUmVzZXQgQUkgc2VydmljZSB0byBwaWNrIHVwIG5ldyBBUEkga2V5c1xuICAgICAgICB0aGlzLl9haVNlcnZpY2UgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgYWxsIGNhY2hlZCBzZXJ2aWNlc1xuICAgICAqL1xuICAgIGNsZWFyU2VydmljZXMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX2FpU2VydmljZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fdmlkZW9TZXJ2aWNlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9maWxlU2VydmljZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fY2FjaGVTZXJ2aWNlID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9wcm9tcHRTZXJ2aWNlID0gdW5kZWZpbmVkO1xuICAgIH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBSWEsY0F1QkE7QUEzQmI7QUFBQTtBQUlPLElBQU0sZUFB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QXdCLDZCQUE2QjtBQUN6RSxZQUFJLHdCQUFPLGtCQUFrQixLQUFLLHNEQUFzRDtBQUFBLE1BQzVGO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQSxFQUVRLCtCQUErQixNQUFtQjtBQUN0RCxRQUFJO0FBQ0EsWUFBTSxRQUFRLElBQUksc0JBQXNCLEtBQUssS0FBSyxNQUFNLENBQUMsZUFBZTtBQUNwRSxZQUFJLFlBQVk7QUFDWixlQUFLLEtBQUssaUJBQWlCLElBQUk7QUFBQSxRQUNuQztBQUFBLE1BQ0osQ0FBQztBQUNELFlBQU0sS0FBSztBQUFBLElBQ2YsU0FBUyxPQUFQO0FBQ0UsbUJBQWEsT0FBTyxPQUFnQiwyQkFBMkI7QUFDL0QsVUFBSSx3QkFBTyxlQUFlLEtBQUssd0JBQXdCLENBQUMsRUFBRSxTQUFTLFVBQVUsTUFBTTtBQUMvRSxhQUFLLEtBQUssaUJBQWlCLElBQUk7QUFBQSxNQUNuQztBQUFBLElBQ0o7QUFBQSxFQUNKO0FBQUEsRUFFQSxNQUFjLHFCQUFxQixhQUFtRDtBQXRjMUY7QUF1Y1EsUUFBSTtBQUNBLFdBQUssV0FBVyxFQUFFLEdBQUcsWUFBWTtBQUNqQyxZQUFNLEtBQUssYUFBYTtBQUN4QixjQUFNLFVBQUsscUJBQUwsbUJBQXVCLGVBQWUsS0FBSztBQUFBLElBQ3JELFNBQVMsT0FBUDtBQUNFLG1CQUFhLE9BQU8sT0FBZ0IsaUJBQWlCO0FBQ3JELFlBQU07QUFBQSxJQUNWO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBYyxlQUE4QjtBQUN4QyxTQUFLLFdBQVcsT0FBTyxPQUFPLENBQUMsR0FBRyxrQkFBa0IsTUFBTSxLQUFLLFNBQVMsQ0FBQztBQUFBLEVBQzdFO0FBQUEsRUFFQSxNQUFjLGVBQThCO0FBQ3hDLFVBQU0sS0FBSyxTQUFTLEtBQUssUUFBUTtBQUFBLEVBQ3JDO0FBQUEsRUFFQSxzQkFBb0Q7QUFDaEQsV0FBTyxLQUFLO0FBQUEsRUFDaEI7QUFBQSxFQUVRLFFBQVEsU0FBdUI7QUFDbkMsdUJBQW1CLElBQUksVUFBVSxTQUFTO0FBQUEsRUFDOUM7QUFBQSxFQUVRLFdBQVcsU0FBdUI7QUFDdEMsdUJBQW1CLElBQUksVUFBVSxXQUFXLE1BQU07QUFBQSxFQUN0RDtBQUFBLEVBRVEsU0FBUyxTQUFpQixPQUFvQjtBQUNsRCx1QkFBbUIsSUFBSSxXQUFXLFlBQVksTUFBTSxXQUFXLE9BQU87QUFBQSxFQUMxRTtBQUNKOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiQ29uZmlybWF0aW9uTW9kYWwiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgIl9hIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
